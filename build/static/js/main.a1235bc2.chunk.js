(this["webpackJsonpsabad-frontend"]=this["webpackJsonpsabad-frontend"]||[]).push([[0],{129:function(e,t,n){e.exports={buttons:"Completions_buttons__278SL",skipped:"Completions_skipped__1PMvh",completioncard:"Completions_completioncard__1t9j4",completion:"Completions_completion__o7RMd",completion_selected:"Completions_completion_selected__3qnRj",title:"Completions_title__1sVK7",titlespace:"Completions_titlespace__2vePz",itembtns:"Completions_itembtns__1iGrZ"}},140:function(e,t,n){e.exports={treelabels:"Entities_treelabels__1eXl8",item:"Entities_item__3UOdP",lstitem:"Entities_lstitem__2fIoQ",node:"Entities_node__3lZB0",flat:"Entities_flat__1BGpb",hidden:"Entities_hidden__2BWhO",selected:"Entities_selected__2iSLh",list:"Entities_list__1PQ5b","ant-tree-switcher":"Entities_ant-tree-switcher__37tkR"}},141:function(e,t,n){e.exports={list:"Relations_list__1qJFP",item:"Relations_item__2qMzb",selected:"Relations_selected__352to",block:"Relations_block__1iBxL",relationbtn:"Relations_relationbtn__1DE91",header:"Relations_header__2735N",section:"Relations_section__LTPqm",section__blocks:"Relations_section__blocks__3TOMg"}},159:function(e,t,n){e.exports={block:"Entity_block__3XG93",button:"Entity_button__3c64R",labels:"Entity_labels__1voVE",tag:"Entity_tag__1B3eN",statesblk:"Entity_statesblk__2jpJN",row:"Entity_row__3Ii1C",long:"Entity_long__1o1P3"}},161:function(e,t,n){e.exports={"ant-divider-horizontal":"AnnotateApp_ant-divider-horizontal__2eNC-","ant-divider-with-text-center":"AnnotateApp_ant-divider-with-text-center__3a0du","ant-divider-with-text-left":"AnnotateApp_ant-divider-with-text-left__1SPWn","ant-divider-with-text-right":"AnnotateApp_ant-divider-with-text-right__1C-t_","ls-renderall":"AnnotateApp_ls-renderall__vDDxd","ls-fade":"AnnotateApp_ls-fade__2IuDq",fadeInOpacity:"AnnotateApp_fadeInOpacity__UMNCk","htx-highlight":"AnnotateApp_htx-highlight__10FIV","htx-no-label":"AnnotateApp_htx-no-label__3xSy2","htx-highlight-last":"AnnotateApp_htx-highlight-last__3u7TA","htx-yoyo":"AnnotateApp_htx-yoyo__38xJa","ant-list-item-action":"AnnotateApp_ant-list-item-action__1mWoY",segment:"AnnotateApp_segment__3IL5K",editor:"AnnotateApp_editor__AXaZS",editorfs:"AnnotateApp_editorfs__3yzLI",menu:"AnnotateApp_menu__3aPOn",menubsp:"AnnotateApp_menubsp__1FXSv",content:"AnnotateApp_content__3Ruvv",common:"AnnotateApp_common__3Pby4",commonbsp:"AnnotateApp_commonbsp__yKPU_",pins:"AnnotateApp_pins__31eiV",pinsright:"AnnotateApp_pinsright__3Aiyw"}},170:function(e,t,n){e.exports={block:"Styles_block__1NSsm",divider:"Styles_divider__2clc_",button:"Styles_button__1aTsI"}},178:function(e,t,n){e.exports={block:"Dialog_block__2f1HI",block_selected:"Dialog_block_selected__cGeTu",name:"Dialog_name__27hAU",tag:"Dialog_tag__1o6ny",date:"Dialog_date__33g0a"}},205:function(e,t,n){e.exports={"ant-divider-horizontal":"Controls_ant-divider-horizontal__3POBd","ant-divider-with-text-center":"Controls_ant-divider-with-text-center__1hYa2","ant-divider-with-text-left":"Controls_ant-divider-with-text-left__1r-Lg","ant-divider-with-text-right":"Controls_ant-divider-with-text-right__3RoCh","ls-renderall":"Controls_ls-renderall__2Kj-I","ls-fade":"Controls_ls-fade__3obEE",fadeInOpacity:"Controls_fadeInOpacity__KWKby","htx-highlight":"Controls_htx-highlight__FSi_2","htx-no-label":"Controls_htx-no-label__257YF","htx-highlight-last":"Controls_htx-highlight-last__3aDLg","htx-yoyo":"Controls_htx-yoyo__1YbO2",skip:"Controls_skip__3p9E9",task:"Controls_task__2FuYQ",container:"Controls_container__LTeAA",block:"Controls_block__21XER",wrapper:"Controls_wrapper__1Zdbo",rewrite:"Controls_rewrite__bRxtr"}},228:function(e,t,n){e.exports={link:"global_link__Ob-I9"}},236:function(e,t,n){e.exports={"ant-divider-horizontal":"Panel_ant-divider-horizontal__15Mt3","ant-divider-with-text-center":"Panel_ant-divider-with-text-center__2U1CW","ant-divider-with-text-left":"Panel_ant-divider-with-text-left__1GH5P","ant-divider-with-text-right":"Panel_ant-divider-with-text-right__2Lpc0","ls-renderall":"Panel_ls-renderall__3CWt5","ls-fade":"Panel_ls-fade__3W0tw",fadeInOpacity:"Panel_fadeInOpacity__z086F","htx-highlight":"Panel_htx-highlight__1tuyA","htx-no-label":"Panel_htx-no-label__2SJ2M","htx-highlight-last":"Panel_htx-highlight-last__2Cuel","htx-yoyo":"Panel_htx-yoyo__2osrK",container:"Panel_container__3AO29",block__controls:"Panel_block__controls__psq4W",block:"Panel_block__2d3Uq"}},237:function(e,t,n){e.exports={mark:"TextAreaRegion_mark__3ph3F",selected:"TextAreaRegion_selected__3Q440",highlighted:"TextAreaRegion_highlighted__3xJod",relation:"TextAreaRegion_relation__30wW3",delete:"TextAreaRegion_delete__2mF_2",row:"TextAreaRegion_row__2xFM5"}},238:function(e,t,n){e.exports={block:"ImageView_block__3BAO-",divider:"ImageView_divider__1Hcuk",button:"ImageView_button__3H1Aa",container:"ImageView_container__AOBmH",rotated:"ImageView_rotated__2CLwY",filler:"ImageView_filler__c-NII"}},284:function(e,t,n){e.exports={tooltitle:"Tools_tooltitle__2lRz7"}},345:function(e,t,n){e.exports={main:"Hint_main__1Svrz"}},347:function(e,t,n){e.exports={node:"Node_node__38uoJ",minimal:"Node_minimal__3sbyt"}},445:function(e,t,n){e.exports={"ant-divider-horizontal":"Segment_ant-divider-horizontal__fFYLB","ant-divider-with-text-center":"Segment_ant-divider-with-text-center__mspm2","ant-divider-with-text-left":"Segment_ant-divider-with-text-left__Q56jn","ant-divider-with-text-right":"Segment_ant-divider-with-text-right__2WzMV","ls-renderall":"Segment_ls-renderall__1yjaW","ls-fade":"Segment_ls-fade__112CU",fadeInOpacity:"Segment_fadeInOpacity__2TAdJ","htx-highlight":"Segment_htx-highlight__sgrxU","htx-no-label":"Segment_htx-no-label__33-yV","htx-highlight-last":"Segment_htx-highlight-last__2T5Nz","htx-yoyo":"Segment_htx-yoyo__F5J3m",block:"Segment_block__1fyeG"}},446:function(e,t,n){e.exports={badge:"SimpleBadge_badge__QESA-"}},452:function(e,t,n){e.exports={progress:"Waveform_progress__32S1p",wave:"Waveform_wave__1AcCy",menu:"Waveform_menu__2ssfW"}},454:function(e,t,n){e.exports={block:"Text_block__1VM-S"}},488:function(e,t,n){},506:function(e,t,n){},522:function(e,t,n){},523:function(e,t,n){},524:function(e,t,n){},526:function(e,t,n){},562:function(e,t,n){},563:function(e,t,n){},564:function(e,t,n){},565:function(e,t,n){},566:function(e,t,n){},567:function(e,t,n){},568:function(e,t,n){},583:function(e,t){},585:function(e,t){},631:function(e,t,n){},699:function(e,t,n){},705:function(e,t,n){},706:function(e,t,n){},707:function(e,t,n){},709:function(e,t,n){},710:function(e,t,n){e.exports={play:"AudioPlus_play__FZgJl"}},711:function(e,t,n){},713:function(e,t,n){},730:function(e,t,n){},731:function(e,t,n){},732:function(e,t,n){},733:function(e,t,n){"use strict";n.r(t);var o={};n.r(o),n.d(o,"isString",(function(){return On})),n.d(o,"isStringEmpty",(function(){return xn})),n.d(o,"isStringJSON",(function(){return Sn})),n.d(o,"getUrl",(function(){return wn})),n.d(o,"toTimeString",(function(){return _n})),n.d(o,"flatten",(function(){return kn})),n.d(o,"hashCode",(function(){return Cn})),n.d(o,"atobUnicode",(function(){return Nn}));var a={};n.r(a),n.d(a,"hexToRGBA",(function(){return Mn})),n.d(a,"colorToRGBA",(function(){return An})),n.d(a,"convertToRGBA",(function(){return zn})),n.d(a,"stringToColor",(function(){return Pn})),n.d(a,"rgbaChangeAlpha",(function(){return In})),n.d(a,"getScaleGradient",(function(){return Ln}));var r={};n.r(r),n.d(r,"getImageData",(function(){return En})),n.d(r,"calcBorder",(function(){return Dn}));var i={};n.r(i),n.d(i,"reverseCoordinates",(function(){return Wn})),n.d(i,"canvasToBinaryMatrix",(function(){return Un}));var l={};n.r(l),n.d(l,"RLEencode",(function(){return Bn})),n.d(l,"RLEdecode",(function(){return Xn}));var s={};n.r(s),n.d(s,"msToHMS",(function(){return Fn})),n.d(s,"prettyDate",(function(){return Yn})),n.d(s,"currentISODate",(function(){return Vn}));var c={};n.r(c),n.d(c,"toggleLabelsAndScores",(function(){return Qn})),n.d(c,"labelWithCSS",(function(){return eo})),n.d(c,"removeSpans",(function(){return fo})),n.d(c,"mainOffsets",(function(){return po})),n.d(c,"findIdxContainer",(function(){return go})),n.d(c,"toGlobalOffset",(function(){return uo})),n.d(c,"highlightRange",(function(){return so})),n.d(c,"splitBoundaries",(function(){return co})),n.d(c,"normalizeBoundaries",(function(){return lo})),n.d(c,"createClass",(function(){return to}));var d=n(0),u=n.n(d),p=n(43),g=n.n(p),f=(n(488),n(12)),h=n(28),b=n(31),m=n(36),j=n(37),v=n(22),y=n(70),O=n(412),x=n.n(O).a.create({baseURL:"http://185.208.77.203:8000"}),S=u.a.createContext({isAuth:!1,token:"",pk:0,firstName:"",lastName:"",username:"",email:"",password:"",setUserInformation:function(){}}),w=S.Provider,_=(S.Consumer,S),k=u.a.createContext({isLoading:!1,openLoadingHandler:function(){},closeLoadingHandler:function(){},messageDialogIsOpen:!1,messageDialogType:"",messageDialogText:"",openMessageDialogHandler:function(){},closeMessageDialogHandler:function(){},messageSnackbarIsOpen:!1,messageSnackbarType:"",messageSnackbarText:"",openMessageSnackbarHandler:function(){},closeMessageSnackbarHandler:function(){}}),C=k.Provider,N=(k.Consumer,k),T=(n(506),function(e){return e.children}),R=n(261),M=n(833),A=n(841),z=n(831),P=n(848),I=n(823),L=n(847),H=n(803),E=n(804),D=n(805),W=n(806),U=n(418),B=n.n(U),X=n(419),F=n.n(X),Y=n(421),V=n.n(Y),J=n(423),G=n.n(J),K=n(422),q=n.n(K),Z=(n(522),n(2)),$=function(e){return Object(Z.jsx)(R.TextValidator,Object(f.a)({},e))},Q=(n(523),n(416)),ee=n(91),te=n(215),ne=Object(te.a)({key:"muirtl",stylisPlugins:[Q.a]});var oe=function(e){return Object(Z.jsx)(ee.a,{value:ne,children:e.children})},ae=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).emailUsernameHandler=function(e){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{email_username:e.target.value}))},o.passwordHandler=function(e){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{password:e.target.value}))},o.showPasswordHandler=function(){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{showPassword:!o.state.showPassword}))},o.rememberMeHandler=function(e){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{rememberMe:!o.state.rememberMe}))},o.state={email_username:"",password:"",showPassword:!1,rememberMe:!1},o}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("sabadRemeberMe");console.log(e),e&&(console.log("In Comojefsadjflksjd"),console.log(localStorage.getItem("sabadUsername")),this.setState(Object(f.a)(Object(f.a)({},this.state),{},{email_username:localStorage.getItem("sabadUsername"),password:localStorage.getItem("sabadPassword"),rememberMe:!0})))}},{key:"render",value:function(){var e=this;return Object(Z.jsx)(T,{children:Object(Z.jsx)(oe,{children:Object(Z.jsx)(R.ValidatorForm,{className:"validate-form",children:Object(Z.jsxs)(M.a,{container:!0,rowSpacing:0,justifyContent:"space-between",children:[Object(Z.jsx)(M.a,{item:!0,xs:12,children:Object(Z.jsx)($,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email_username",label:"\u0646\u0627\u0645 \u06a9\u0627\u0631\u0628\u0631\u06cc \u06cc\u0627 \u0627\u06cc\u0645\u06cc\u0644",name:"email_username",dir:"rtl",autoComplete:"email_username",value:this.state.email_username,onChange:this.emailUsernameHandler,InputLabelProps:{style:{fontFamily:"IRANSansWeb"}},validators:["required"],errorMessages:["\u0644\u0637\u0641\u0627 \u0646\u0627\u0645 \u06a9\u0627\u0631\u0628\u0631\u06cc \u06cc\u0627 \u0627\u06cc\u0645\u06cc\u0644 \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f"],InputProps:{style:{fontFamily:"IRANSansWeb"},endAdornment:Object(Z.jsx)(L.a,{position:"end",children:Object(Z.jsx)(H.a,{})})}})}),Object(Z.jsx)(M.a,{item:!0,xs:12,children:Object(Z.jsx)($,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"\u0631\u0645\u0632 \u0639\u0628\u0648\u0631",dir:"rtl",type:this.state.showPassword?"text":"password",id:"password",autoComplete:"current-password",value:this.state.password,onChange:this.passwordHandler,InputLabelProps:{style:{fontFamily:"IRANSansWeb"}},validators:["required","minStringLength:6"],errorMessages:["\u0644\u0637\u0641\u0627 \u0631\u0645\u0632 \u0639\u0628\u0648\u0631 \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f","\u0631\u0645\u0632 \u0639\u0628\u0648\u0631 \u0628\u0627\u06cc\u062f \u0628\u06cc\u0634\u062a\u0631 \u0627\u0632 \u06f6 \u062d\u0631\u0641 \u0628\u0627\u0634\u062f"],errorStyle:{style:{color:"red",fontFamily:"IRANSansWeb"}},errorText:{style:{color:"red",fontFamily:"IRANSansWeb"}},InputProps:{style:{fontFamily:"IRANSansWeb"},endAdornment:Object(Z.jsx)(L.a,{position:"end",children:Object(Z.jsx)(A.a,{style:{padding:"1px"},onClick:this.showPasswordHandler,onMouseDown:this.handleMouseDownPassword,children:this.state.showPassword?Object(Z.jsx)(E.a,{}):Object(Z.jsx)(D.a,{})})})}})}),Object(Z.jsxs)(M.a,{item:!0,container:!0,justifyContent:"space-between",children:[Object(Z.jsx)(z.a,{href:"#text-buttons",className:"dark-blue",children:"\u0641\u0631\u0627\u0645\u0648\u0634\u06cc \u0631\u0645\u0632 \u0639\u0628\u0648\u0631\u061f"}),Object(Z.jsx)(P.a,{onChange:this.rememberMeHandler,checked:this.state.rememberMe,control:Object(Z.jsx)(I.a,{defaultChecked:!0,className:"dark-blue"}),label:"\u0645\u0631\u0627 \u0628\u0647 \u062e\u0627\u0637\u0631 \u0628\u0633\u067e\u0627\u0631",labelPlacement:"start",sx:{marginLeft:"-2%"}})]}),Object(Z.jsxs)(M.a,{item:!0,container:!0,justifyContent:"space-between",marginTop:"1vh",children:[Object(Z.jsx)(M.a,{item:!0,xs:5,children:Object(Z.jsx)(z.a,{type:"submit",variant:"contained",className:"login-button",sx:{fontWeight:"bold",backgroundColor:"#3f407d"},onClick:function(){e.props.signinHandler(e.state)},fullWidth:!0,dir:"rtl",endIcon:Object(Z.jsx)(B.a,{fontSize:"large"}),children:"\u0648\u0631\u0648\u062f"})}),Object(Z.jsx)(M.a,{item:!0,xs:5,children:Object(Z.jsx)(z.a,{type:"submit",variant:"outlined",className:"signup-button",sx:{color:"#3f407d",fontWeight:"bold",border:"2px solid",borderColor:"#3f407d","&:hover":{border:"2px solid",borderColor:"#3f407d"}},onClick:this.props.changeSideBarHandler,fullWidth:!0,dir:"rtl",endIcon:Object(Z.jsx)(F.a,{fontSize:"large"}),children:"\u062b\u0628\u062a \u0646\u0627\u0645"})})]}),Object(Z.jsxs)(M.a,{item:!0,container:!0,justifyContent:"center",marginTop:"5vh",children:[Object(Z.jsx)(W.a,{sx:{width:"100%"}}),Object(Z.jsxs)(M.a,{xs:6,item:!0,container:!0,justifyContent:"space-evenly",children:[Object(Z.jsx)(M.a,{item:!0,children:Object(Z.jsx)(A.a,{"aria-label":"google-icon",size:"large",children:Object(Z.jsx)(V.a,{fontSize:"inherit",color:"error"})})}),Object(Z.jsx)(M.a,{item:!0,children:Object(Z.jsx)(A.a,{"aria-label":"linkedin-icon",size:"large",children:Object(Z.jsx)(q.a,{fontSize:"inherit",color:"warning"})})}),Object(Z.jsx)(M.a,{item:!0,children:Object(Z.jsx)(A.a,{"aria-label":"facebook-icon",size:"large",children:Object(Z.jsx)(G.a,{fontSize:"inherit",color:"info"})})})]})]})]})})})})}}]),n}(u.a.Component),re=n(849),ie=n(850),le=(n(524),n.p+"static/media/logo.1eec9938.png"),se=function(e){return Object(Z.jsx)(re.a,{sx:{maxWidth:200},className:"circle-card",children:Object(Z.jsx)(ie.a,{className:"circle-media",component:"img",image:le,alt:"green iguana"})})},ce=n.p+"static/media/illustration_login.c0c19451.png",de=n(73),ue=n.n(de);var pe=function(e){var t=Object(y.f)(),n=Object(d.useState)(!1),o=Object(v.a)(n,2),a=o[0],r=o[1],i=Object(d.useContext)(N),l=Object(d.useContext)(_),s=function(){r(a)},c=function(e){i.openLoadingHandler();var n={username:e.email_username,password:e.password};x.post("/api/auth/login/",n).then((function(n){l.setUserInformation({isAuth:!0,token:n.data.token,pk:n.data.user.pk,firstName:n.data.user.first_name,lastName:n.data.user.last_name,username:n.data.user.username,email:n.data.user.email,password:n.data.user.password}),localStorage.setItem("sabadRemeberMe",e.rememberMe),e.rememberMe?(localStorage.setItem("sabadUsername",e.email_username),localStorage.setItem("sabadPassword",e.password)):(localStorage.removeItem("sabadUsername"),localStorage.removeItem("sabadPassword")),ue.a.set("token","JWT "+n.data.token),ue.a.set("pk",n.data.user.pk),ue.a.set("firstName",n.data.user.first_name),ue.a.set("lastName",n.data.user.last_name),ue.a.set("username",n.data.user.username),ue.a.set("email",n.data.user.email),t.push("/")})).catch((function(e){var t;i.openMessageDialogHandler({messageType:"error",messageText:null===(t=e.response)||void 0===t?void 0:t.data.non_field_errors[0]})})).finally((function(){i.closeLoadingHandler()}))};return Object(Z.jsx)(T,{children:Object(Z.jsxs)("div",{className:"login",children:[Object(Z.jsxs)("div",{className:"sidebar-container  ".concat(a?"sidebar-container--left":"sidebar-container--right"),children:[Object(Z.jsx)("h1",{style:{marginBottom:"5vh"},children:"\u0648\u0631\u0648\u062f \u0628\u0647 \u062d\u0633\u0627\u0628 \u06a9\u0627\u0631\u0628\u0631\u06cc"}),Object(Z.jsx)("img",{src:ce})]}),Object(Z.jsx)("div",{className:"login__welcome-back ".concat(a?"login__welcome-back--active":"login__welcome-back--inactive")}),Object(Z.jsx)("div",{className:"login__hello-container ".concat(a?"login__hello-container--inactive":"login__hello-container--active")}),Object(Z.jsxs)("div",{className:"login__create-container ".concat(a?"login__create-container--active":"login__create-container--inactive"),children:[Object(Z.jsx)(se,{}),Object(Z.jsx)(ae,{signinHandler:c,changeSideBarHandler:s})]}),Object(Z.jsxs)("div",{className:"login__login-container ".concat(a?"login__login-container--inactive":"login__login-container--active"),children:[Object(Z.jsx)(se,{}),Object(Z.jsx)(ae,{signinHandler:c,changeSideBarHandler:s})]})]})})},ge=n(165),fe=n(832),he=n(834),be=n(822),me=n(835),je=n(851),ve=n(298),ye=n(807),Oe=u.a.forwardRef((function(e,t){return Object(Z.jsx)(ye.a,Object(f.a)({direction:"up",ref:t},e))})),xe=(n(526),function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(Z.jsx)(oe,{children:Object(Z.jsx)(fe.a,{sx:{color:"#fff",zIndex:100},open:this.props.isOpen,onClick:this.props.closeDialog,children:Object(Z.jsxs)(he.a,{open:this.props.isOpen,TransitionComponent:Oe,keepMounted:!0,onClose:this.props.closeDialog,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",scroll:"body",maxWidth:"xs",fullWidth:!0,children:[Object(Z.jsx)(be.a,{dir:"rtl",variant:"filled",severity:this.props.messageType,onClose:function(){},children:"\u062e\u0637\u0627"}),Object(Z.jsx)(me.a,{children:Object(Z.jsx)(je.a,{id:"alert-dialog-description",children:Object(Z.jsx)(ve.a,{variant:"body1",sx:{textAlign:"center",fontWeight:"bold"},children:this.props.messageText})})})]})})})}}]),n}(u.a.Component)),Se=xe,we=n(826);n(801);function _e(e){return Object(Z.jsx)(ye.a,Object(f.a)(Object(f.a)({},e),{},{direction:"up"}))}var ke=u.a.forwardRef((function(e,t){return Object(Z.jsx)(be.a,Object(f.a)({elevation:6,ref:t,variant:"filled"},e))})),Ce=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(Z.jsx)(oe,{children:Object(Z.jsx)(we.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},spacing:3,sx:{width:"17%"},open:this.props.isOpen,autoHideDuration:2e3,onClose:this.props.closeHnadler,TransitionComponent:_e,children:Object(Z.jsx)(ke,{dir:"rtl",onClose:this.props.closeHnadler,severity:this.props.messageType,sx:{width:"100%",height:"5vh",display:"flex",justifyContent:"center",alignItems:"center"},children:this.props.messageText})},_e.name)})}}]),n}(u.a.Component),Ne=Ce,Te=n(425),Re=(n(562),function(e){return Object(Z.jsx)(fe.a,{sx:{color:"#fff",zIndex:100},open:e.isLoading,children:Object(Z.jsx)(Te.CircleToBlockLoading,{color:"#1784d9",size:"large"})})}),Me=n(854),Ae=n(853),ze=n(855),Pe=n(829),Ie=n(430),Le=n.n(Ie),He=n(432),Ee=n.n(He),De=n(268),We=n.n(De),Ue=n(431),Be=n.n(Ue),Xe=n(433),Fe=n.n(Xe),Ye=n(836),Ve=n(460),Je=n(852),Ge=n(808),Ke=n(428),qe=n.n(Ke),Ze=n(429),$e=n.n(Ze),Qe=(n(563),function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(Z.jsx)(T,{children:Object(Z.jsxs)(Ve.a,{anchorEl:this.props.anchorEl,open:this.props.open,onClose:this.props.handleClose,onClick:this.props.handleClose,dir:"rtl",PaperProps:{elevation:0,sx:{borderRadius:"10%",width:"20%",overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))",paddingX:"1%",mt:1.5,"& .MuiAvatar-root":{width:40,height:40,ml:-.5,mr:2},"&:before":{content:'""',display:"block",position:"absolute",top:0,right:14,width:10,height:10,bgcolor:"background.paper",transform:"translateY(-50%) translateX(-2000%) rotate(45deg)",zIndex:0}}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"left",vertical:"bottom"},children:[Object(Z.jsxs)(Je.a,{sx:{marginTop:"2vh"},children:[Object(Z.jsx)(Ye.a,{}),"  ",this.props.accountUsername]}),Object(Z.jsx)(W.a,{}),Object(Z.jsxs)(Je.a,{sx:{marginTop:"2vh"},children:[Object(Z.jsx)(Ge.a,{children:Object(Z.jsx)(qe.a,{fontSize:"medium"})}),"\u062a\u0646\u0638\u06cc\u0645\u0627\u062a"]}),Object(Z.jsxs)(Je.a,{sx:{marginTop:"2vh"},children:[Object(Z.jsx)(Ge.a,{children:Object(Z.jsx)($e.a,{fontSize:"medium"})}),"\u062e\u0631\u0648\u062c"]})]})})}}]),n}(u.a.Component)),et=Qe,tt=(n(16),n(816)),nt=(n(564),Object(tt.a)((function(e){return{appBar:{zIndex:"".concat(e.zIndex.drawer+1," !important"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginRight:240,width:"calc(100% - ".concat(240,"px) !important"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})}}})));function ot(e){var t=nt(),n=Object(d.useState)(null),o=Object(v.a)(n,2),a=o[0],r=o[1],i=Object(d.useState)(!1),l=Object(v.a)(i,2),s=l[0],c=l[1];return Object(Z.jsx)(T,{children:Object(Z.jsxs)(oe,{children:[Object(Z.jsx)(Ae.a,{sx:{flexGrow:1},children:Object(Z.jsx)(Me.a,{position:"fixed",dir:"rtl",className:"app-bar ".concat(e.drawerIsOpen?"appBarShift":"appBar"," ").concat(e.drawerIsOpen?t.appBarShift:t.appBar),children:Object(Z.jsxs)(ze.a,{children:[Object(Z.jsx)(A.a,{size:"large",edge:"start",color:"inherit","aria-label":"open drawer",onClick:e.openDrawerHandler,className:"".concat(e.drawerIsOpen?"menuButtonShift":""),sx:{mr:2},children:Object(Z.jsx)(Le.a,{className:"app-bar-button"})}),Object(Z.jsx)(Ae.a,{sx:{flexGrow:1}}),Object(Z.jsxs)(Ae.a,{sx:{display:{xs:"none",md:"flex",marginRight:"1%",justifyContent:"space-evenly",width:"12%"}},children:[Object(Z.jsx)(A.a,{size:"large",edge:"end","aria-label":"account of current user","aria-haspopup":"true",color:"inherit",children:Object(Z.jsx)(We.a,{className:"app-bar-button"})}),Object(Z.jsx)(A.a,{size:"large","aria-label":"show 17 new notifications",color:"inherit",children:Object(Z.jsx)(Pe.a,{badgeContent:0,color:"error",children:Object(Z.jsx)(Be.a,{className:"app-bar-button"})})}),Object(Z.jsx)(A.a,{size:"large",edge:"end","aria-label":"account of current user","aria-haspopup":"true",color:"inherit",className:"rotate180",children:Object(Z.jsx)(Ee.a,{className:"app-bar-button"})})]}),Object(Z.jsx)(Ae.a,{sx:{display:{xs:"flex",md:"none"}},children:Object(Z.jsx)(A.a,{size:"large","aria-label":"show more","aria-haspopup":"true",color:"inherit",children:Object(Z.jsx)(Fe.a,{})})})]})})}),Object(Z.jsx)(et,{anchorEl:a,open:s,handleClose:function(){r(null),c(!1)},accountUsername:"Hamidreza7799"})]})})}var at=n(8),rt=n(10),it=n(856),lt=n(840),st=n(828),ct=n(809),dt=n(258),ut=n.n(dt),pt=u.a.createContext({drawerIsopen:!1,openDrawerHandler:function(){},closeDrawerInfoHandler:function(){}}),gt=n(434),ft=n.n(gt),ht=n(435),bt=n.n(ht),mt=(n(565),function(e){return{width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),overflowX:"hidden"}}),jt=function(e){return Object(at.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:"calc(".concat(e.spacing(5)," + 1px)")},e.breakpoints.up("sm"),{width:"calc(".concat(e.spacing(8)," + 1px)")})},vt=Object(rt.a)("div")((function(e){var t=e.theme;return Object(f.a)({display:"flex",alignItems:"center",justifyContent:"flex-start",padding:t.spacing(0,1)},t.mixins.toolbar)})),yt=Object(rt.a)(it.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,n=e.open;return Object(f.a)(Object(f.a)({width:240,flexShrink:0,whiteSpace:"nowrap",boxSizing:"border-box"},n&&Object(f.a)(Object(f.a)({},mt(t)),{},{"& .MuiDrawer-paper":mt(t)})),!n&&Object(f.a)(Object(f.a)({},jt(t)),{},{"& .MuiDrawer-paper":jt(t)}))})),Ot=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).state={drawerButtons:[{title:"\u0635\u0641\u062d\u0647 \u0627\u0635\u0644\u06cc",link:"/home",icon:Object(Z.jsx)(ft.a,{fontSize:"large"})},{title:"\u0627\u0637\u0644\u0627\u0639\u0627\u062a",link:"/info",icon:Object(Z.jsx)(bt.a,{fontSize:"large"})},{title:"\u067e\u0631\u0648\u0641\u0627\u06cc\u0644",link:"/profile",icon:Object(Z.jsx)(We.a,{fontSize:"large"})}]},o}return Object(b.a)(n,[{key:"render",value:function(){return console.log(window.location.pathname),Object(Z.jsx)(oe,{children:Object(Z.jsx)(Ae.a,{sx:{display:"flex"},children:Object(Z.jsxs)(yt,{variant:"permanent",open:this.props.drawerIsOpen,anchor:"left",children:[Object(Z.jsx)(vt,{children:Object(Z.jsx)(A.a,{onClick:this.props.closeDrawerHandler,open:this.props.drawerIsOpen,children:Object(Z.jsx)(ut.a,{sx:{fontSize:"1.85rem"}})})}),Object(Z.jsx)(W.a,{}),Object(Z.jsx)(lt.a,{children:this.state.drawerButtons.map((function(e,t){return Object(Z.jsx)(ge.b,{to:"".concat(e.link),style:{textDecoration:"none"},children:Object(Z.jsxs)(st.a,{button:!0,dir:"rtl",className:"".concat(e.link===window.location.pathname?"dark-blue select-item-border":""),children:[Object(Z.jsx)(Ge.a,{className:"".concat(e.link===window.location.pathname?"dark-blue":""),children:e.icon}),Object(Z.jsx)(ct.a,{primary:e.title,className:"".concat(e.link===window.location.pathname?"select-item-text":"item-text")})]},e.title)})}))})]})})})}}]),n}(d.Component);Ot.contextType=pt;var xt=n(842),St=n(858),wt=n(860),_t=n(811),kt=n(342),Ct=n(861),Nt=n(859),Tt=n(857),Rt=n(846),Mt=n(438),At=n.n(Mt),zt=n(437),Pt=n.n(zt),It=(n(566),n(810)),Lt=n(436),Ht=Object(tt.a)((function(e){return{progressRootSuccess:{"& span":{backgroundColor:e.palette.success.main}},progressRootWarning:{"& span":{backgroundColor:e.palette.warning.main}},progressRootError:{"& span":{backgroundColor:e.palette.error.main}}}})),Et=Object(rt.a)(It.a)((function(e){var t,n=e.theme;return t={height:10,borderRadius:5},Object(at.a)(t,"&.".concat(Lt.a.colorPrimary),{backgroundColor:n.palette.grey["light"===n.palette.mode?200:800]}),Object(at.a)(t,"& .".concat(Lt.a.bar),{borderRadius:5}),t}));function Dt(e){var t=Ht();return Object(Z.jsx)(Ae.a,{sx:{display:"flex",alignItems:"center"},children:Object(Z.jsx)(Ae.a,{sx:{width:"100%",mr:1},children:Object(Z.jsx)(Et,{variant:"determinate",value:e.value,className:100===e.value?t.progressRootSuccess:e.value<50?t.progressRootError:t.progressRootWarning})})})}function Wt(e){return Object(Z.jsx)(Ae.a,{sx:{flexGrow:1},children:Object(Z.jsx)(Dt,{value:e.value})})}var Ut=n(439),Bt=n.n(Ut),Xt=n(815),Ft=Object(tt.a)((function(e){return{visibilityIconSuccess:{color:e.palette.success.main},visibilityIconWarning:{color:e.palette.warning.main},visibilityIconError:{color:e.palette.error.main}}})),Yt=Object(rt.a)(_t.a)((function(e){var t,n=e.theme;return t={},Object(at.a)(t,"&.".concat(kt.a.head),{backgroundColor:n.palette.common.black,color:n.palette.common.white}),Object(at.a)(t,"&.".concat(kt.a.body),{fontSize:14}),t}));function Vt(e){var t=Ft(),n=e.row,o=u.a.useState(!1),a=Object(v.a)(o,2),r=a[0],i=a[1];return Object(Z.jsxs)(u.a.Fragment,{children:[Object(Z.jsxs)(Tt.a,{sx:{"& > *":{borderBottom:"unset"}},className:e.cssClass,children:[Object(Z.jsx)(_t.a,{children:Object(Z.jsx)(A.a,{"aria-label":"expand row",size:"small",onClick:function(){return i(r)},children:r?Object(Z.jsx)(Pt.a,{}):Object(Z.jsx)(At.a,{})})}),Object(Z.jsx)(_t.a,{component:"th",scope:"row",align:"center",children:n.productOwner}),Object(Z.jsx)(_t.a,{align:"center",children:n.projectName}),Object(Z.jsx)(_t.a,{align:"center",children:n.startDate}),Object(Z.jsx)(_t.a,{align:"center",children:n.numberOfData}),Object(Z.jsx)(Xt.a,{title:"".concat(n.completePercent,"%"),placement:"right",children:Object(Z.jsx)(_t.a,{align:"center",children:Object(Z.jsx)(Wt,{value:n.completePercent,className:"progress-bar"})})}),Object(Z.jsx)(_t.a,{align:"center",children:Object(Z.jsx)(ge.b,{to:"/project/".concat(e.username,"/").concat(e.projectSlug,"/task/").concat(e.taskSlug),children:Object(Z.jsx)(A.a,{children:Object(Z.jsx)(Bt.a,{className:100===n.completePercent?t.visibilityIconSuccess:n.completePercent<50?t.visibilityIconError:t.visibilityIconWarning})})})})]},n.productOwner),Object(Z.jsx)(Tt.a,{children:Object(Z.jsx)(_t.a,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:Object(Z.jsx)(xt.a,{in:r,timeout:"auto",unmountOnExit:!0,children:Object(Z.jsxs)(Ae.a,{sx:{margin:1},children:[Object(Z.jsx)(ve.a,{variant:"h6",gutterBottom:!0,component:"div",children:"History"}),Object(Z.jsxs)(St.a,{size:"small","aria-label":"purchases",children:[Object(Z.jsx)(Nt.a,{children:Object(Z.jsxs)(Tt.a,{children:[Object(Z.jsx)(_t.a,{children:"Date"}),Object(Z.jsx)(_t.a,{children:"Customer"}),Object(Z.jsx)(_t.a,{align:"right",children:"Amount"}),Object(Z.jsx)(_t.a,{align:"right",children:"Total price ($)"})]})}),Object(Z.jsx)(wt.a,{children:n.history.map((function(e){return Object(Z.jsxs)(Tt.a,{children:[Object(Z.jsx)(_t.a,{component:"th",scope:"row",children:e.date}),Object(Z.jsx)(_t.a,{children:e.customerId}),Object(Z.jsx)(_t.a,{align:"right",children:e.amount}),Object(Z.jsx)(_t.a,{align:"right",children:Math.round(e.amount*n.price*100)/100})]},e.date)}))})]})]})})})})]})}Object(rt.a)(Vt)((function(e){return{"&:nth-of-child(even)":{backgroundColor:e.theme.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}}));function Jt(e){var t=Object(y.f)(),n=Object(d.useState)(!1),o=Object(v.a)(n,2),a=o[0],r=o[1],i=Object(d.useState)([]),l=Object(v.a)(i,2),s=l[0],c=l[1],u=(Object(d.useContext)(_),Object(d.useContext)(N));Object(d.useEffect)((function(){a||(r(!0),u.openLoadingHandler(),x.defaults.headers.common.Authorization=ue.a.get("token"),x.get("/api/annotator/tasks/").then((function(e){var t=e.data.results.map((function(e){return{id:e.id,productOwner:e.task.owner,projectSlug:e.task.project,projectName:e.task.subject,startDate:e.join_date.replace(/T.*/,"").split("-").join("/"),numberOfData:e.number_of_data,completePercent:e.progress,task:e.task,history:[{date:"2020-01-05",customerId:"11091700",amount:3},{date:"2020-01-02",customerId:"Anonymous",amount:1}]}}));c(t)})).catch((function(e){var n;u.openMessageDialogHandler({messageType:"error",messageText:null===(n=e.response)||void 0===n?void 0:n.data.detail}),500!=e.response.status&&t.push("/login")})).finally((function(){u.closeLoadingHandler()})))}));return Object(Z.jsx)(Ct.a,{component:Rt.a,className:"table-container",sx:{maxHeight:"80vh",overflowY:"auto",scrollbarColor:"#d4aa70 #e4e4e4",scrollbarWidth:"thin"},children:Object(Z.jsxs)(St.a,{stickyHeader:!0,dir:"rtl","aria-label":"collapsible table",children:[Object(Z.jsx)(Nt.a,{onClick:function(){console.log(s)},children:Object(Z.jsxs)(Tt.a,{children:[Object(Z.jsx)(Yt,{align:"center"}),Object(Z.jsx)(Yt,{align:"center",className:"table-header-cell",children:"\u0646\u0627\u0645 \u06a9\u0627\u0631\u0641\u0631\u0645\u0627"}),Object(Z.jsx)(Yt,{align:"center",className:"table-header-cell",children:"\u0646\u0627\u0645 \u067e\u0631\u0648\u0698\u0647"}),Object(Z.jsx)(Yt,{align:"center",className:"table-header-cell",children:"\u062a\u0627\u0631\u06cc\u062e \u0634\u0631\u0648\u0639"}),Object(Z.jsx)(Yt,{align:"center",className:"table-header-cell",children:"\u062a\u0639\u062f\u0627\u062f \u062f\u0627\u062f\u0647"}),Object(Z.jsx)(Yt,{align:"center",className:"table-header-cell",children:"\u062f\u0631\u0635\u062f \u067e\u06cc\u0634\u0631\u0641\u062a"}),Object(Z.jsx)(Yt,{align:"center",className:"table-header-cell",children:"\u0645\u0634\u0627\u0647\u062f\u0647 \u067e\u0631\u0648\u0698\u0647"})]})}),Object(Z.jsx)(wt.a,{children:s.map((function(e,t){return Object(Z.jsx)(Vt,{username:e.productOwner,projectSlug:e.task.url.split("/").at(-4),taskSlug:e.task.url.split("/").at(-2),row:e,cssClass:t%2===0?"colorful-row":""},e.productOwner)}))})]})})}var Gt=n(862),Kt=(n(567),Object(tt.a)((function(e){return{appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:"7vh",fontFamily:"IRANSansWeb",maxWidth:"100% !important",display:"flex !important",justifyContent:"center"}}})));var qt=function(e){var t=Kt();return Object(Z.jsx)(T,{children:Object(Z.jsxs)(oe,{children:[Object(Z.jsx)(ot,{drawerIsOpen:e.drawerIsOpen,openDrawerHandler:e.openDrawerHandler}),Object(Z.jsx)(Ot,{drawerIsOpen:e.drawerIsOpen,openDrawerHandler:e.openDrawerHandler,closeDrawerHandler:e.closeDrawerHandler}),Object(Z.jsxs)("main",{className:t.content,children:[Object(Z.jsx)("div",{className:t.appBarSpacer}),Object(Z.jsx)(Gt.a,{maxWidth:"lg",className:t.container,children:Object(Z.jsx)(Jt,{title:"\u0635\u0641\u062d\u0647 \u0627\u0635\u0644\u06cc"})})]})]})})},Zt=n(824),$t=n(277),Qt=n(1),en=n(11),tn=u.a.forwardRef((function(e,t){return Object(Z.jsx)(ye.a,Object(f.a)({direction:"up",ref:t},e))})),nn=(n(568),function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(Z.jsx)(oe,{children:Object(Z.jsx)(fe.a,{sx:{color:"#fff",zIndex:100},open:this.props.isOpen,onClick:this.props.closeDialog,children:Object(Z.jsxs)(he.a,{open:this.props.isOpen,TransitionComponent:tn,keepMounted:!0,onClose:this.props.closeDialog,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",scroll:"body",maxWidth:"xs",fullWidth:!0,children:[Object(Z.jsx)(be.a,{dir:"rtl",variant:"filled",severity:"warning",onClose:function(){},children:"\u062a\u0648\u0636\u06cc\u062d\u0627\u062a"}),Object(Z.jsx)(me.a,{children:Object(Z.jsx)(je.a,{id:"alert-dialog-description",children:Object(Z.jsx)(ve.a,{variant:"body1",sx:{textAlign:"center",fontWeight:"bold"},children:this.props.messageText})})})]})})})}}]),n}(u.a.Component)),on=nn,an=n(97),rn=n(440),ln=n.n(rn),sn=new(function(){function e(){Object(h.a)(this,e),this.tags=[],this.models={},this.views={},this.views_models={},this.tools={}}return Object(b.a)(e,[{key:"addTag",value:function(e,t,n){this.tags.push(e),this.models[e]=t,this.views[e]=n,this.views_models[t.name]=n}},{key:"modelsArr",value:function(){return Object.values(this.models)}},{key:"getViewByModel",value:function(e){var t=this.views_models[e];if(!t)throw new Error("No view for model: "+e);return t}},{key:"getViewByTag",value:function(e){return this.views[e]}},{key:"getTool",value:function(e){var t=this.tools[e];if(!t){var n=Object.keys(this.tools);throw new Error("No model registered for tool: "+e+"\nAvailable models:\n\t"+n.join("\n\t"))}return t}},{key:"addTool",value:function(e,t){this.tools[e]=t}},{key:"getModelByTag",value:function(e){var t=this.models[e];if(!t){var n=Object.keys(this.models);throw new Error("No model registered for tag: "+e+"\nAvailable models:\n\t"+n.join("\n\t"))}return t}}]),e}());sn.getTool=sn.getTool.bind(sn),sn.getModelByTag=sn.getModelByTag.bind(sn);var cn=sn,dn=n(343),un=n.n(dn);function pn(e){var t=un()(10);return e&&(t=un()(e)),t}function gn(e){var t=Object(Qt.h)(e);return Object(Qt.i)(e).create(Object(f.a)(Object(f.a)({},t),{},{id:pn()}))}function fn(e){var t=Object(Qt.h)(e);return Object(Qt.i)(e).create(Object(f.a)(Object(f.a)({},t),{},{id:pn()}))}var hn="skip",bn="stop";function mn(e){var t=cn.getViewByModel(Object(Qt.i)(e).name);if(console.log(Object(Qt.i)(e).name),!t)throw new Error("No view for model:"+Object(Qt.i)(e).name);return["ViewModel","ChoicesModel","RectangleLabelsModel","TextAreaModel","AudioPlusModel"].includes(Object(Qt.i)(e).name)?Object(Z.jsx)("div",{id:Object(Qt.i)(e).name,className:"Hamid",children:Object(Z.jsx)(t,{item:e,id:Object(Qt.i)(e).name},pn())}):Object(Z.jsx)(t,{item:e},pn())}function jn(e,t){var n;(n=function(e){var o=t(e);if(o!==hn){if(o===bn)return bn;if(e.children){var a,r=Object(an.a)(e.children);try{for(r.s();!(a=r.n()).done;){var i=a.value;if(n(i)===bn)return bn}}catch(l){r.e(l)}finally{r.f()}}}})(e)}var vn={cloneReactTree:function(e,t){var n=null;return(n=function(e){var o=[];return u.a.Children.forEach(e,(function(e){var a;if(e.props){var r={};"function"===typeof t?r=t(e):"object"===typeof t&&(r=t),a=u.a.cloneElement(e,r,n(e.props.children))}else a=e;o.push(a)})),o})(e)},renderItem:mn,renderChildren:function(e){return e&&e.children&&e.children.length?e.children.map((function(e){return mn(e)})):null},treeToModel:function(e){var t=-1,n=function(){var t,n=[],o=/<HyperText.*?>(.*?)<\/HyperText>/gi;do{(t=o.exec(e))&&n.push(t[1])}while(t);return n}();function o(e){var t=function(e){var t={};if(!e)return t;for(var n=0,o=Object.keys(e);n<o.length;n++){var a=o[n];"value"===a||"true"!==e[a]&&"false"!==e[a]?t[a.toLowerCase()]=e[a]:t[a.toLowerCase()]=JSON.parse(e[a])}return t}(e.$);return t.id=pn(),t.type=e["#name"].toLowerCase(),t}var a,r=function(e){for(var t=e.split("/>"),n="",o=0;o<t.length-1;o++){var a=t[o].split("<");n+=t[o]+"></"+a[a.length-1].split(" ")[0]+">"}return n+t[t.length-1]}(e.replace(/(\r\n|\n|\r)/gm,""));ln.a.parseString(r,{explicitChildren:!0,preserveChildrenOrder:!0,charsAsChildren:!0},(function(e,t){a=t}));var i=o(Object.values(a)[0]);return i.children=function e(a){if(!a.$$)return null;if("hypertext"===a["#name"].toLowerCase())return a.$&&"value"in a.$?a.$.value:n[t+=1];var r,i=null,l=[],s=Object(an.a)(a.$$);try{for(s.s();!(r=s.n()).done;){var c=r.value;if("__text__"!==c["#name"]){var d=o(c),u=e(c);u&&("string"===typeof u?d.value=u:d.children=u),l.push(d)}else i=c._}}catch(p){s.e(p)}finally{s.f()}return 0===l.length?i:l}(Object.values(a)[0]),i},findInterface:function(e,t){var n;return(n=function(t){if(Object(Qt.i)(t).name===e)return t;if(t.children){var o,a=Object(an.a)(t.children);try{for(a.s();!(o=a.n()).done;){var r=o.value,i=n(r);if(i)return i}}catch(l){a.e(l)}finally{a.f()}}})(t)},findParentOfType:function(e,t){var n,o=Object(an.a)(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;try{var r=Object(Qt.f)(e,a);if(r)return r}catch(i){}}}catch(i){o.e(i)}finally{o.f()}return null},filterChildrenOfType:function(e,t){var n=[];return Array.isArray(t)||(t=[t]),jn(e,(function(e){var o,a=Object(an.a)(t);try{for(a.s();!(o=a.n()).done;){var r=o.value;Object(Qt.i)(e).name===r&&n.push(e)}}catch(i){a.e(i)}finally{a.f()}})),n},cssConverter:function(e){if(!e)return null;var t,n,o,a,r={},i=e.split(";");for(n=0;n<i.length;n++){if(t=i[n].indexOf(":"),o=i[n].substring(0,t),a=i[n].substring(t+1),!((o=o.replace(/ /g,"")).length<1))" "===a[0]&&(a=a.substring(1))," "===a[a.length-1]&&(a=a.substring(0,a.length-1)),r[o.replace(/(-.)/g,(function(e){return e[1].toUpperCase()}))]=a}return r},traverseTree:jn},yn=n(83),On=function(e){return"string"===typeof e||e instanceof String},xn=function(e){return!!On(e)&&0===e.length},Sn=function(e){if(On(e)){try{JSON.parse(e)}catch(t){return!1}return!0}return!1};function wn(e,t){var n=t.slice(e),o=/^(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/g.exec(n);return o&&o.length?o[1]:""}function _n(e){if("number"===typeof e)return new Date(e).toUTCString().match(/(\d\d:\d\d:\d\d)/)[0]}function kn(e){return e.reduce((function(e,t){return e.concat(Array.isArray(t)?kn(t):t)}),[])}function Cn(e){var t=0;if(0===e.length)return t+"";for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t+""}function Nn(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}var Tn=["#c22525","#c13025","#bf3b24","#be4624","#bc5124","#bb5b23","#ba6623","#b87023","#b77a22","#b58422","#b48d22","#b39722","#b1a021","#b0aa21","#aaae21","#9ead20","#93ab20","#87aa20","#7ca91f","#71a71f","#66a61f","#5ba41e","#51a31e","#46a21e","#3ca01e","#329f1d","#289d1d","#1e9c1d","#1c9a24","#1c992d","#1c992d"],Rn={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Mn(e,t){var n=0,o=0,a=0,r=.3;return"number"===typeof parseInt(t)&&(r=t),e&&4===e.length?(n="0x"+e[1]+e[1],o="0x"+e[2]+e[2],a="0x"+e[3]+e[3]):e&&7===e.length&&(n="0x"+e[1]+e[2],o="0x"+e[3]+e[4],a="0x"+e[5]+e[6]),"rgba(".concat(+n,", ").concat(+o,", ").concat(+a,", ").concat(r,")")}function An(e,t){return"string"===typeof e&&void 0!==typeof Rn[e.toLowerCase()]?Mn(Rn[e.toLowerCase()],t):e}function zn(e,t){return"#"===e.charAt(0)?Mn(e,t):An(e,t)}function Pn(e){for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);for(var o="#",a=0;a<3;a++){o+=("00"+(t>>8*a&255).toString(16)).substr(-2)}return o}function In(e,t){return e.replace(/[\d\.]+\)$/g,"".concat(t,")"))}function Ln(e){return Tn[Math.ceil(30*e)]}var Hn=function(){var e={};return e.floodFill=function(e,t,n,o,a){var r,i,l,s,c,d,u,p,g,f,h=e.data,b=e.width,m=e.height,j=e.bytes,v=-1,y=b+1,O=-1,x=m+1,S=n*b+t,w=new Uint8Array(b*m),_=new Uint8Array(a||b*m);if(1===_[S])return null;var k=[h[S*=j],h[S+1],h[S+2],h[S+3]],C=[{y:n,left:t-1,right:t+1,dir:1}];do{for(f=!1,i=(s=C.shift()).left+1;i<s.right;i++)if(S=((u=s.y*b)+i)*j,1!==_[u+i]&&!((r=h[S]-k[0])>o||r<-o)&&!((r=h[S+1]-k[1])>o||r<-o)&&!((r=h[S+2]-k[2])>o||r<-o)){for(f=!0,w[u+i]=1,_[u+i]=1,d=i-1;d>-1&&(S=(p=u+d)*j,1!==_[p])&&!((r=h[S]-k[0])>o||r<-o)&&!((r=h[S+1]-k[1])>o||r<-o)&&!((r=h[S+2]-k[2])>o||r<-o);)w[p]=1,_[p]=1,d--;for(c=i+1;c<b&&(S=(g=u+c)*j,1!==_[g])&&!((r=h[S]-k[0])>o||r<-o)&&!((r=h[S+1]-k[1])>o||r<-o)&&!((r=h[S+2]-k[2])>o||r<-o);)w[g]=1,_[g]=1,c++;d<y&&(y=d+1),c>v&&(v=c-1),(l=s.y-s.dir)>=0&&l<m&&(d<s.left&&C.push({y:l,left:d,right:s.left,dir:-s.dir}),s.right<c&&C.push({y:l,left:s.right,right:c,dir:-s.dir})),(l=s.y+s.dir)>=0&&l<m&&d<c&&C.push({y:l,left:d,right:c,dir:s.dir})}f&&(s.y<x&&(x=s.y),s.y>O&&(O=s.y))}while(C.length>0);return{data:w,width:e.width,height:e.height,bounds:{minX:y,minY:x,maxX:v,maxY:O}}},e.gaussBlur=function(e,t){var n,o,a,r,i,l,s,c=2*t+1,d=t*t,u=new Float32Array(c),p=0,g=e.width,f=e.height,h=e.data,b=e.bounds.minX,m=e.bounds.maxX,j=e.bounds.minY,v=e.bounds.maxY;for(n=0;n<t;n++){var y=(t-n)*(t-n),O=Math.exp(-y/(2*d))/(2*Math.PI*d);u[t+n]=u[t-n]=O,p+=2*O}for(n=0;n<c;n++)u[n]/=p;var x=new Uint8Array(g*f),S=t+g,w=t+f;for(i=j;i<v+1;i++)for(r=b;r<m+1;r++){for(l=0,s=S-r<c?S-r:c,a=(o=i*g+r)-t,n=t-r>0?t-r:0;n<s;n++)l+=h[a+n]*u[n];for(s=w-i<c?w-i:c,a=o-t*g,n=t-i>0?t-i:0;n<s;n++)l+=h[a+n*g]*u[n];x[o]=l>.5?1:0}return{data:x,width:g,height:f,bounds:{minX:b,minY:j,maxX:m,maxY:v}}},e.gaussBlurOnlyBorder=function(e,t,n){var o,a,r,i,l,s,c,d,u,p,g=function(e,t,n){var o,a,r,i,l,s,c,d=e.width,u=e.height,p=e.data,g=new Uint8Array(p),f=e.bounds.minX,h=e.bounds.maxX,b=e.bounds.minY,m=e.bounds.maxY,j=d*u,v=new Uint8Array(j),y=[],O=Math.max(f,1),x=Math.min(h,d-2),S=Math.max(b,1),w=Math.min(m,u-2);if(n&&n.length>0)for(l=0;l<j;l++)1===n[l]&&(g[l]=1);for(i=S;i<w+1;i++)for(o=O;o<x+1;o++)0!==p[l=i*d+o]&&(s=l+d,c=l-d,0!==g[l+1]&&0!==g[l-1]&&0!==g[s]&&0!==g[s+1]&&0!==g[s-1]&&0!==g[c]&&0!==g[c+1]&&0!==g[c-1]||y.push(l));if(0===f)for(i=b;i<m+1;i++)1===p[i*d]&&y.push(i*d);if(h===d-1)for(i=b;i<m+1;i++)1===p[i*d+h]&&y.push(i*d+h);if(0===b)for(o=f;o<h+1;o++)1===p[o]&&y.push(o);if(m===u-1)for(o=f;o<h+1;o++)1===p[m*d+o]&&y.push(m*d+o);var _,k=[],C=t+d,N=t+u,T=2*t+1;for(j=y.length,r=0;r<j;r++){for(v[l=y[r]]=1,k.push(l),i=(l-(o=l%d))/d,_=C-o<T?C-o:T,s=l-t,a=t-o>0?t-o:0;a<_;a++)0===v[c=s+a]&&(v[c]=1,k.push(c));for(_=N-i<T?N-i:T,s=l-t*d,a=t-i>0?t-i:0;a<_;a++)0===v[c=s+a*d]&&(v[c]=1,k.push(c))}return k}(e,t,n),f=2*t+1,h=2*t*t,b=new Float32Array(f),m=0,j=e.width,v=e.height,y=e.data,O=e.bounds.minX,x=e.bounds.maxX,S=e.bounds.minY,w=e.bounds.maxY,_=g.length;for(r=0;r<t;r++)a=(t-r)*(t-r),o=Math.exp(-a/h)/Math.PI,b[t+r]=b[t-r]=o,m+=2*o;for(r=0;r<f;r++)b[r]/=m;var k=new Uint8Array(y),C=t+j,N=t+v;for(r=0;r<_;r++){for(u=0,d=((l=g[r])-(c=l%j))/j,p=C-c<f?C-c:f,s=l-t,i=t-c>0?t-c:0;i<p;i++)u+=y[s+i]*b[i];if(u>.5)k[l]=1,c<O&&(O=c),c>x&&(x=c),d<S&&(S=d),d>w&&(w=d);else{for(p=N-d<f?N-d:f,s=l-t*j,i=t-d>0?t-d:0;i<p;i++)u+=y[s+i*j]*b[i];u>.5?(k[l]=1,c<O&&(O=c),c>x&&(x=c),d<S&&(S=d),d>w&&(w=d)):k[l]=0}}return{data:k,width:j,height:v,bounds:{minX:O,minY:S,maxX:x,maxY:w}}},e.createBorderMask=function(e){var t,n,o,a,r,i=e.width,l=e.height,s=e.data,c=e.bounds.minX,d=e.bounds.maxX,u=e.bounds.minY,p=e.bounds.maxY,g=d-c+1,f=p-u+1,h=new Uint8Array(g*f),b=Math.max(c,1),m=Math.min(d,i-2),j=Math.max(u,1),v=Math.min(p,l-2);for(n=j;n<v+1;n++)for(t=b;t<m+1;t++)0!==s[o=n*i+t]&&(a=o+i,r=o-i,0!==s[o+1]&&0!==s[o-1]&&0!==s[a]&&0!==s[a+1]&&0!==s[a-1]&&0!==s[r]&&0!==s[r+1]&&0!==s[r-1]||(h[(n-u)*g+(t-c)]=1));if(0===c)for(n=u;n<p+1;n++)1===s[n*i]&&(h[(n-u)*g]=1);if(d===i-1)for(n=u;n<p+1;n++)1===s[n*i+d]&&(h[(n-u)*g+(d-c)]=1);if(0===u)for(t=c;t<d+1;t++)1===s[t]&&(h[t-c]=1);if(p===l-1)for(t=c;t<d+1;t++)1===s[p*i+t]&&(h[(p-u)*g+(t-c)]=1);return{data:h,width:g,height:f,offset:{x:c,y:u}}},e.getBorderIndices=function(e){var t,n,o,a,r,i=e.width,l=e.height,s=e.data,c=[],d=i-1,u=l-1;for(n=1;n<u;n++)for(t=1;t<d;t++)0!==s[o=n*i+t]&&(a=o+i,r=o-i,0!==s[o+1]&&0!==s[o-1]&&0!==s[a]&&0!==s[a+1]&&0!==s[a-1]&&0!==s[r]&&0!==s[r+1]&&0!==s[r-1]||c.push(o));for(n=0;n<l;n++)1===s[n*i]&&c.push(n*i);for(t=0;t<i;t++)1===s[t]&&c.push(t);for(o=i-1,n=0;n<l;n++)1===s[n*i+o]&&c.push(n*i+o);for(o=(l-1)*i,t=0;t<i;t++)1===s[o+t]&&c.push(o+t);return c},e.traceContours=function(e){var t,n,o,a,r,i,l,s,c,d,u,p,g,f,h,b=function(e){var t,n,o=e.width,a=e.data,r=e.bounds.minX,i=e.bounds.maxX,l=e.bounds.minY,s=e.bounds.maxY,c=i-r+3,d=s-l+3,u=new Uint8Array(c*d);for(n=l;n<s+1;n++)for(t=r;t<i+1;t++)1===a[n*o+t]&&(u[(n-l+1)*c+(t-r+1)]=1);return{data:u,width:c,height:d,offset:{x:r-1,y:l-1}}}(e),m=[],j=0,v=b.width,y=2*v,O=b.height,x=b.data,S=b.offset.x,w=b.offset.y,_=new Uint8Array(x),k=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]];for(a=1;a<O-1;a++)for(o=1;o<v-1;o++)if(1===x[r=a*v+o])for(t=-v;t<y;t+=y)if(0===x[r+t]&&0===_[r+t]){for(j++,l=[],c=(s=t===v)?2:6,p=g=d={x:o,y:a},u=null;;){for(_[p.y*v+p.x]=j,n=0;n<8;n++){if(h=k[c=(c+1)%8],1===x[i=(f={x:p.x+h[0],y:p.y+h[1]}).y*v+f.x]){_[i]=j;break}_[i]=-1,f=null}if(null===f)break;if(p=f,u){if(g.x===d.x&&g.y===d.y&&p.x===u.x&&p.y===u.y)break}else u=f;l.push({x:g.x+S,y:g.y+w}),g=p,c=(c+4)%8}null!=f&&(l.push({x:d.x+S,y:d.y+w}),m.push({inner:s,label:j,points:l}))}return m},e.simplifyContours=function(e,t,n){var o,a,r,i,l,s,c,d,u,p,g,f,h,b,m,j,v,y,O,x,S,w=e.length,_=[];for(a=0;a<w;a++)if(l=(i=e[a]).points,(s=i.points.length)<n){for(c=[],r=0;r<s;r++)c.push({x:l[r].x,y:l[r].y});_.push({inner:i.inner,label:i.label,points:c,initialCount:s})}else{d=[0,s-1],u=[{first:0,last:s-1}];do{if(!((p=u.shift()).last<=p.first+1)){for(g=-1,f=p.first,o=p.first+1;o<p.last;o++)O=l[o],x=l[p.first],S=l[p.last],v=O.x-x.x,y=O.y-x.y,b=Math.sqrt(v*v+y*y),v=O.x-S.x,y=O.y-S.y,m=Math.sqrt(v*v+y*y),v=x.x-S.x,y=x.y-S.y,j=Math.sqrt(v*v+y*y),(h=b>=Math.sqrt(m*m+j*j)?m:m>=Math.sqrt(b*b+j*j)?b:Math.abs((y*O.x-v*O.y+x.x*S.y-S.x*x.y)/j))>g&&(f=o,g=h);g>t&&(d.push(f),u.push({first:p.first,last:f}),u.push({first:f,last:p.last}))}}while(u.length>0);for(c=[],s=d.length,d.sort((function(e,t){return e-t})),r=0;r<s;r++)c.push({x:l[d[r]].x,y:l[d[r]].y});_.push({inner:i.inner,label:i.label,points:c,initialCount:i.points.length})}return _},e}();function En(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height)}function Dn(e,t,n,o,a,r,i){var l=[],s={data:e,width:t,height:n,bytes:4},c=Hn.floodFill(s,o,a,r,null,!0);c=Hn.gaussBlurOnlyBorder(c,5);var d=Hn.traceContours(c);if((d=Hn.simplifyContours(d,5,50)).length>0){if(i)return d[0].points;for(var u=0,p=d[0].points.length;u<p;u++)l.push([d[0].points[u].x,d[0].points[u].y]);return l}return!1}function Wn(e,t){var n,o=e.x,a=e.y,r=t.x,i=t.y;return o>r&&(n=Math.abs(o-r),r=(o=r)+n),a>i&&(n=Math.abs(a-i),i=(a=i)+n),{x1:o,y1:a,x2:r,y2:i}}function Un(e,t){for(var n=e.stageRef.getLayers().filter((function(e){return e.attrs.id===t.id}))[0].canvas.context,o=n.getImageData(0,0,n.canvas.width,n.canvas.height),a=[],r=0;r<e.stageRef.bufferCanvas.context.canvas.width*e.stageRef.bufferCanvas.context.canvas.height*4;r+=4){var i=o.data[r+0],l=o.data[r+1],s=o.data[r+2],c=o.data[r+3];i>0||l>0||s>0||c>0?a.push(1):a.push(0)}return a}function Bn(e){var t,n,o,a=[];for(n=1,t=e[0],o=1;o<e.length;o++)e[o]!==t?(a.push(n,t),n=1,t=e[o]):n++;return a.push(n,t),a}function Xn(e){var t=new Uint8ClampedArray,n=[];return e.forEach((function(n,o){o%2===0&&t.push(Array.from(new Array(1+n).join(e[o+1])))})),t.flat(2).forEach((function(e){return n.push(parseInt(e))})),n}function Fn(e){var t=e/1e3,n=parseInt(t/3600);return t%=3600,n+":"+parseInt(t/60)+":"+(t=Math.floor(t))}function Yn(e){if("string"===typeof e||/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/.test(e)){var t=new Date((e||"").replace(/-/g,"/").replace(/[TZ]/g," ")),n=((new Date).getTime()-t.getTime())/1e3,o=Math.floor(n/86400);if(!(isNaN(o)||o<0))return 0===o&&((n<60?"just now":n<120&&"1 minute ago")||n<3600&&Math.floor(n/60)+" minutes ago"||n<7200&&"1 hour ago"||n<86400&&Math.floor(n/3600)+" hours ago")||1===o&&"Yesterday"||o<7&&o+" days ago"||o<31&&Math.ceil(o/7)+" weeks ago"||o+" days ago"}}function Vn(){var e=6e4*(new Date).getTimezoneOffset();return new Date(Date.now()-e).toISOString().slice(0,-1)}var Jn=n(441),Gn=n.n(Jn),Kn=n(167),qn=n.n(Kn),Zn=n(350);var $n={imageData2Image:function(e){var t=document.createElement("canvas"),n=t.getContext("2d");t.width=e.width,t.height=e.height,n.putImageData(e,0,0);var o=new Image;return o.src=t.toDataURL(),o},Region2RLE:function(e,t,n){var o=t.naturalWidth,a=t.naturalHeight,r=document.createElement("div");r.style.display="none",document.body.appendChild(r),r.id="container-2";var i=new qn.a.Stage({container:"container-2",width:o,height:a}),l=new qn.a.Layer,s=l.getContext("2d");e._img&&s.drawImage(e._img,0,0),e.touches.map((function(e){var o=e.rescale(t.stageWidth,t.stageHeight,t.naturalWidth,t.naturalHeight),a="add"===e.type?"source-over":"destination-out",r=Object(f.a)({points:o,strokeWidth:e.scaledStrokeWidth(t.stageWidth,t.stageHeight,t.naturalWidth,t.naturalHeight),globalCompositeOperation:a,lineJoin:"round",lineCap:"round",opacity:1},n);return new qn.a.Line(r)})).forEach((function(e){return l.add(e)})),i.add(l);var c=s.getImageData(0,0,o,a);return Object(Zn.b)(c.data,c.data.length)},RLE2Region:function(e,t){var n=t.naturalWidth,o=t.naturalHeight,a=document.createElement("canvas"),r=a.getContext("2d");a.width=n,a.height=o;var i=r.createImageData(n,o);i.data.set(Object(Zn.a)(e)),r.putImageData(i,0,0);var l=new Image;return l.src=a.toDataURL(),l},brushSizeCircle:function(e){var t=document.createElement("canvas"),n=t.getContext("2d");return t.width=4*e+8,t.height=4*e+8,n.beginPath(),n.arc(e/2+4,e/2+4,e/2,0,2*Math.PI,!1),n.lineWidth=2,n.strokeStyle="white",n.stroke(),t.toDataURL()},labelToSVG:function(){var e={};return function(t){var n=t.label,o=t.score,a=n;if(null!==o&&(a+=o),a in e)return e[a];var r=0,i=[];if(null!==o&&void 0!==o){var l=Ln(o);i.push('<rect x="0" y="0" rx="2" ry="2" width="24" height="14" style="fill:'.concat(l,';opacity:0.5" />')),i.push('<text x="3" y="10" style="font-size: 8px; font-family: Monaco">'.concat(o.toFixed(2),"</text>")),r+=26}n&&(i.push('<text x="'.concat(r,'" y="11" style="font-size: 9.5px; font-weight: bold; font-family: Monaco">').concat(n,"</text>")),r=r+function(e){var t=document.createElement("svg"),n=document.createElement("text");n.style="font-size: 9.5px; font-weight: bold; color: red; fill: red; font-family: Monaco",n.innerHTML=e,t.appendChild(n),document.body.appendChild(t);var o=t.getBoundingClientRect().width;return t.remove(),o}(n)+2);var s=function(e){var t={level1:"'",level2:'"'},n=(e=(e=(e=(e=function(e){return e.indexOf("http://www.w3.org/2000/svg")<0&&(e=e.replace(/<svg/g,"<svg xmlns=".concat(t.level2,"http://www.w3.org/2000/svg").concat(t.level2))),e}(e)).replace(/'/g,'"')).replace(/>\s{1,}</g,"><")).replace(/\s{2,}/g," ")).replace(/[\r\n%#()<>?[\\\]^`{|}]/g,encodeURIComponent);return"".concat(t.level1,"data:image/svg+xml,").concat(n).concat(t.level1)}('<svg height="16" width="'.concat(r,'">').concat(i.join(""),"</svg>"));return e[a]=s,s}}()};function Qn(e){var t=document.getElementsByClassName("htx-highlight");Array.from(t).forEach((function(t){var n=null;Array.from(t.classList).forEach((function(e){-1!==e.indexOf("htx-label-")&&(n=e)})),null!==n&&(e?t.classList.remove("htx-no-label"):t.classList.add("htx-no-label"))}))}var eo=function(){var e={};return function(t,n){var o=n.labels,a=n.score,r=o?o.join(","):"",i=Cn(r+a),l="htx-label-"+i;if((l=l.toLowerCase())in e)return e[l];t.setAttribute("data-labels",r);var s=$n.labelToSVG({label:r,score:a}),c="url(".concat(s,")");return to(".".concat(l,":after"),"content:".concat(c)),e[i]=!0,l}}();function to(e,t){var n=document.createElement("style");n.type="text/css",document.getElementsByTagName("head")[0].appendChild(n),(n.sheet||{}).insertRule?n.sheet.insertRule(e+"{"+t+"}",0):(n.styleSheet||n.sheet).addRule(e,t)}function no(e){return 3===e.nodeType}function oo(e){for(;e.hasChildNodes();)e=e.firstChild;return e}function ao(e){for(;e.hasChildNodes();)e=e.lastChild;return e}function ro(e){if(e.firstChild)return e.firstChild;for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function io(e,t){var n=e.cloneNode(!1);return n.deleteData(0,t),e.deleteData(t,e.length-t),Gn()(n,e)}function lo(e){var t,n,o,a,r,i=e.startContainer,l=e.startOffset,s=e.endContainer,c=e.endOffset;function d(e){return!!no(e)&&(!(e===i&&l>0)&&(e!==s||0!==c))}for(i.childNodes.length&&l>0&&(i=ao(i.childNodes[l-1]),l=i.length||i.childNodes.length),c<s.childNodes.length&&(s=oo(s.childNodes[c]),c=0),t=i,n=function(e){return e===o?null:function(e){if(e.firstChild)return e.firstChild;for(;!e.nextSibling;)if(!(e=e.parentNode))return null;return e.nextSibling}(e)},o=ao(s);t&&!d(t);)t=n(t);for(a=t,t=s,n=function(e){return e===o?null:function(e){if(e.lastChild)return e.lastChild;for(;!e.previousSibling;)if(!(e=e.parentNode))return null;return e.previousSibling}(e)},o=oo(i);t&&!d(t);)t=n(t);r=t,e.setStart(a,0),e.setEnd(r,r.length)}function so(e,t,n){"undefined"!==typeof t&&null!==t||(t="htx-annotation");var o=function(e){var t,n=e.startContainer,o=e.endContainer,a=e.commonAncestorContainer,r=[];for(t=n.parentNode;t&&(r.push(t),t!==a);t=t.parentNode);for(r.reverse(),t=n;t&&(r.push(t),t!==o);t=ro(t));return r}(e._range),a=/^\s*$/,r=o.filter((function(e){return no(e)})),i=0;e._range.startOffset===r[i].length&&i++;var l=r.length;l>1&&r[r.length-1].length!==e._range.endOffset&&(l-=1);for(var s=[],c=i,d=l;c<d;c++){var u=r[c];if(!a.test(u.nodeValue)){var p=window.document.createElement("span");p.style.backgroundColor=n.backgroundColor,p.className=t,u.parentNode.replaceChild(p,u),p.appendChild(u),s.push(p)}}return s}function co(e){var t=e.startContainer,n=e.startOffset,o=e.endContainer,a=e.endOffset;no(o)&&a>0&&a<o.length&&(o=io(o,a),e.setEnd(o,0)),no(t)&&n>0&&n<t.length&&(t===o?(t=io(t,n),e.setEnd(t,a-n)):t=io(t,n),e.setStart(t,0))}var uo=function(e,t,n){var o=0;return n+function e(n){if(n===t)return o;"#text"===n.nodeName&&(o+=n.length),"BR"===n.nodeName&&(o+=1);for(var a=0;a<=n.childNodes.length;a++){var r=n.childNodes[a];if(r){var i=e(r);if(void 0!==i)return i}}}(e)},po=function(e){var t=window.getSelection().getRangeAt(0).cloneRange(),n=t.startOffset,o=t.endOffset,a=!1,r=!1;return function e(i){if("#text"===i.nodeName&&(i===t.startContainer||a||(n+=i.length),i===t.startContainer&&(a=!0),i===t.endContainer||r||(o+=i.length),i===t.endContainer&&(r=!0)),"BR"===i.nodeName&&(a||(n+=1),r||(o+=1)),i.childNodes.length>0)for(var l=0;l<=i.childNodes.length;l++){var s=i.childNodes[l];if(s){var c=e(s);if(c)return c}}}(e),{start:n,end:o}},go=function(e,t){var n=t,o=function e(t){if(t)if("#text"===t.nodeName){if(n-t.length<=0)return t;n-=t.length}else if("BR"===t.nodeName)n-=1;else if(t.childNodes.length>0)for(var o=0;o<=t.childNodes.length;o++){var a=t.childNodes[o];if(a){var r=e(a);if(r)return r}}}(e);return{node:o,len:n}};function fo(e){var t=[];e&&e.forEach((function(e){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);t.push(e.parentNode),e.parentNode.removeChild(e)})),t.forEach((function(e){return e.normalize()}))}var ho={Image:i,HTML:c,Checkers:o,Colors:a,UDate:s,guidGenerator:pn,debounce:function(e,t,n){var o;return function(){var a=this,r=arguments,i=function(){o=null,n||e.apply(a,r)},l=n&&!o;clearTimeout(o),o=setTimeout(i,t),l&&e.apply(a,r)}},styleToProp:function(e){return e?e.split(";").filter((function(e){return e.split(":")[0]&&e.split(":")[1]})).map((function(e){return[e.split(":")[0].trim().replace(/-./g,(function(e){return e.substr(1).toUpperCase()})),e.split(":").slice(1).join(":").trim()]})).reduce((function(e,t){return Object(f.a)(Object(f.a)({},e),{},Object(at.a)({},t[0],t[1]))}),{}):null},RLe:l,Floodfill:r},bo=n(129),mo=n.n(bo),jo=(n(631),n(130)),vo=n(812),yo=n(56),Oo=n(51),xo=n(837),So=function(e){return e.children},wo=["className"],_o=Object(rt.a)((function(e){var t=e.className,n=Object(yn.a)(e,wo);return Object(Z.jsx)(Xt.a,Object(f.a)(Object(f.a)({},n),{},{arrow:!0,classes:{popper:t}}))}))((function(e){var t,n=e.theme;return t={},Object(at.a)(t,"& .".concat(jo.a.arrow),{color:n.palette.common.black}),Object(at.a)(t,"& .".concat(jo.a.tooltip),{backgroundColor:n.palette.common.black}),t})),ko=Object(en.c)((function(e){var t=e.item,n=e.store;return Object(Z.jsxs)(st.a,{component:"div",disablePadding:!0,children:[Object(Z.jsx)(xo.a,{placement:"bottomLeft",title:"Please confirm you want to delete this completion",onConfirm:function(){t.list.deleteCompletion(t)},okText:"Delete",okType:"danger",cancelText:"Cancel",children:Object(Z.jsx)(_o,{title:"\u062d\u0630\u0641",children:Object(Z.jsx)(A.a,{disabled:!t.selected,size:"large",className:"".concat(t.selected?"color-error ":""," "),sx:{"& svg":{fontSize:"1rem",transition:"0.2s",transform:"translateX(0) rotate(0)"},"&:hover, &:focus":{bgcolor:"unset"}},children:Object(Z.jsx)(yo.a,{icon:Oo.s})})})}),Object(Z.jsx)(vo.a,{sx:{height:56,"&:after":{content:'""',position:"absolute",height:"50%",display:"block",left:0,width:"1px",bgcolor:"black"}},onClick:function(){!t.selected&&n.completionStore.selectCompletion(t.id)},children:Object(Z.jsx)(ct.a,{primary:t.pk,primaryTypographyProps:{fontWeight:"medium",variant:"body2"},secondary:t.createdBy})}),Object(Z.jsx)(A.a,{size:"large",sx:{"& svg":{fontSize:"0.875rem",transition:"0.2s",transform:"translateX(0) rotate(0)"},"&:hover, &:focus":{bgcolor:"unset"}},onClick:function(e){!t.selected&&n.completionStore.selectCompletion(t.id)},children:Object(Z.jsx)(yo.a,{icon:Oo.i,className:"".concat(t.selected?"on-lightbulb":""," ")})})]})})),Co=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).handleClick=function(){o.setState({open:!o.state.open})},o.state={open:!0},o}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props.store,t=e.completionStore.completions.map((function(t){return Object(Z.jsx)(So,{children:Object(Z.jsx)(ko,{item:t,store:e},t.id)})}));return Object(Z.jsx)(oe,{children:Object(Z.jsxs)(lt.a,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper",borderRadius:"20px"},component:"div",children:[Object(Z.jsxs)(st.a,{component:"div",disablePadding:!0,sx:{backgroundColor:"#3f407d"},children:[Object(Z.jsx)(_o,{title:"\u062a\u06a9\u0645\u06cc\u0644 \u062c\u062f\u06cc\u062f",children:Object(Z.jsx)(A.a,{size:"large",sx:{"& svg":{color:"white",fontSize:"1.25rem",transition:"0.2s",transform:"translateX(0) rotate(0)"},"&:hover, &:focus":{bgcolor:"unset"},"&:after":{content:'""',position:"absolute",height:"80%",display:"block",left:0,width:"1px",bgcolor:"white"}},onClick:function(t){t.preventDefault();var n=e.completionStore.addCompletion({userGenerate:!0});e.completionStore.selectCompletion(n.id)},children:Object(Z.jsx)(yo.a,{icon:Oo.o})})}),Object(Z.jsxs)(vo.a,{sx:{height:56},onClick:this.handleClick,children:[Object(Z.jsx)(ct.a,{primary:"\u062a\u06a9\u0645\u06cc\u0644\u200c\u0647\u0627",primaryTypographyProps:{color:"white",fontWeight:"medium",variant:"body2"}}),Object(Z.jsx)(Ge.a,{sx:{minWidth:"0px",marginRight:"10px",color:"white"},children:Object(Z.jsx)(yo.a,{icon:Oo.a,color:"primary"})})]})]}),Object(Z.jsx)(xt.a,{in:this.state.open,timeout:"auto",unmountOnExit:!0,sx:{border:"solid 1px rgba(34, 36, 38, 0.15)"},children:Object(Z.jsx)(lt.a,{component:"div",disablePadding:!0,className:"completion-list",children:e.completionStore.completions?t:Object(Z.jsx)("p",{children:"\u0686\u06cc\u0632\u06cc \u0645\u0648\u062c\u0648\u062f \u0646\u06cc\u0633\u062a"})})})]})})}}]),n}(d.Component),No=Object(en.c)(Co),To=n(345),Ro=n.n(To),Mo=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e,t="".concat(Ro.a.main);return this.props.style&&(e=this.props.style),this.props.className&&(t="".concat(Ro.a.main," ").concat(this.props.className)),Object(Z.jsx)("sup",{"data-copy":this.props.copy,className:t,style:e,children:this.props.children})}}]),n}(d.Component),Ao=n(205),zo=n.n(Ao),Po=["className"],Io=Object(rt.a)((function(e){var t=e.className,n=Object(yn.a)(e,Po);return Object(Z.jsx)(Xt.a,Object(f.a)(Object(f.a)({},n),{},{arrow:!0,classes:{popper:t}}))}))((function(e){var t,n=e.theme;return t={},Object(at.a)(t,"& .".concat(jo.a.arrow),{color:n.palette.common.black}),Object(at.a)(t,"& .".concat(jo.a.tooltip),{backgroundColor:n.palette.common.black}),t})),Lo=Object(en.b)("store")(Object(en.c)((function(e){var t,n,o,a=e.item,r=e.store,i={skip:"",update:"",submit:""},l=a.userGenerate,s=a.sentUserGenerate,c=r.settings,d=c.enableHotkeys,u=c.enableTooltips;r.task&&(zo.a.task,r.task.id),d&&u&&(i.submit=Object(Z.jsx)(Mo,{children:" [ Ctrl+Enter ]"}),i.skip=Object(Z.jsx)(Mo,{children:" [ Ctrl+Space ]"}),i.update=Object(Z.jsx)(Mo,{children:" [ Alt+Enter] "})),o=Object(Z.jsx)(Io,{title:"\u062a\u0633\u06a9 \u0642\u0628\u0644\u06cc",children:Object(Z.jsx)(z.a,{variant:"outlined",startIcon:Object(Z.jsx)(yo.a,{icon:Oo.d}),sx:{direction:"ltr",fontSize:"1rem",minWidth:"110px",color:"black",border:"solid 1px"},onClick:r.skipTask,children:"\u0628\u0627\u0632\u06af\u0634\u062a"})}),r.completionStore.predictSelect&&!r.explore||((l&&!s||r.explore&&!l&&r.hasInterface("submit"))&&(n=Object(Z.jsx)(Io,{title:"Save results: [ Ctrl+Enter ]",children:Object(Z.jsx)(z.a,{variant:"contained",startIcon:Object(Z.jsx)(yo.a,{icon:Oo.c}),sx:{direction:"ltr",fontSize:"1rem",minWidth:"110px"},onClick:r.submitCompletion,color:"success",children:"\u062a\u0627\u06cc\u06cc\u062f"})})),(l&&s||!l&&r.hasInterface("update"))&&(t=Object(Z.jsx)(Io,{title:"Update this task: [ Alt+Enter ]",children:Object(Z.jsx)(z.a,{variant:"contained",startIcon:Object(Z.jsx)(yo.a,{icon:Oo.l}),sx:{direction:"ltr",fontSize:"1rem",minWidth:"110px"},onClick:r.updateCompletion,color:"success",children:"\u0622\u067e\u062f\u06cc\u062a"})})));var p=Object(Z.jsx)("div",{className:zo.a.block,style:{width:"100%"},children:Object(Z.jsxs)("div",{className:zo.a.wrapper,style:{direction:"ltr",justifyContent:"start"},children:[Object(Z.jsx)("div",{className:zo.a.container,children:o}),Object(Z.jsxs)("div",{className:zo.a.container,children:[t,n]})]})});return("completion"===a.type||r.explore)&&p}))),Ho=n(94),Eo=n(817),Do=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(h.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={res:null},e}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this,n=this.props.store,o=n.completionStore.selected;return Object(Z.jsxs)("div",{children:[Object(Z.jsx)("br",{}),Object(Z.jsx)("h2",{children:"Debug"}),Object(Z.jsx)(Ho.a,{basic:!0,onClick:function(t){e.setState({res:JSON.stringify(n.completionStore.selected.toJSON())})},children:"Serialize whole tree"}),Object(Z.jsx)(Ho.a,{basic:!0,onClick:function(t){e.setState({res:JSON.stringify(n.completionStore.selected.serializeCompletion())})},children:"Seriealize results tree"}),Object(Z.jsx)(Ho.a,{basic:!0,onClick:function(e){t.state.res&&o.deserializeCompletion(JSON.parse(t.state.res))},children:"Load Serialized Results"}),Object(Z.jsx)(Ho.a,{basic:!0,onClick:function(e){var o=n.completionStore.addInitialCompletion();n.completionStore.selectCompletion(o.id),t.state.res&&o.deserializeCompletion(JSON.parse(t.state.res))},children:"Load As New Completion"}),Object(Z.jsx)(Ho.a,{basic:!0,onClick:function(t){e.setState({res:n.task.data})},children:"Task data"}),Object(Z.jsx)(Ho.a,{basic:!0,onClick:function(e){var o=JSON.parse(t.state.res),a={id:o.id,project:2,data:JSON.stringify(o)};n.resetState(),n.addTask(a),n.addGeneratedCompletion(a),n.markLoading(!1),n.completionStore.selected&&n.completionStore.selected.traverseTree((function(e){return e.updateValue&&e.updateValue(t)}))},children:"Simulate Loading Task"}),Object(Z.jsx)("br",{}),Object(Z.jsx)("br",{}),Object(Z.jsx)(Eo.a,{children:Object(Z.jsx)(Eo.a.TextArea,{value:this.state.res,className:"is-search",onChange:function(t){e.setState({res:t.target.value})}})})]})}}]),n}(d.Component),Wo=Object(en.c)(Do),Uo=n(863),Bo=n(843),Xo=n(864),Fo=n(236),Yo=n.n(Fo),Vo=(n(699),["className"]),Jo=Object(rt.a)((function(e){var t=e.className,n=Object(yn.a)(e,Vo);return Object(Z.jsx)(Xt.a,Object(f.a)(Object(f.a)({},n),{},{arrow:!0,classes:{popper:t}}))}))((function(e){var t,n=e.theme;return t={},Object(at.a)(t,"& .".concat(jo.a.arrow),{color:n.palette.common.black}),Object(at.a)(t,"& .".concat(jo.a.tooltip),{backgroundColor:n.palette.common.black}),t})),Go=Object(en.c)((function(e){var t=e.store,n=t.completionStore.selected.history;return Object(Z.jsxs)("div",{className:Yo.a.container+" ls-panel panel-container",children:[Object(Z.jsxs)("div",{className:"".concat(Yo.a.block," ").concat(Yo.a.block__controls),children:[Object(Z.jsxs)(Ho.a,{type:"ghost",icon:Object(Z.jsx)(Uo.a,{}),onClick:function(e){n&&n.canUndo&&n.undo(),e.preventDefault()},children:["Undo",t.settings.enableHotkeys&&t.settings.enableTooltips&&Object(Z.jsx)(Mo,{children:"[ Ctrl+z ]"})]}),Object(Z.jsx)(Ho.a,{type:"ghost",icon:Object(Z.jsx)(Bo.a,{}),onClick:function(e){n&&n.canRedo&&n.redo(),e.preventDefault()},children:"Redo"}),Object(Z.jsx)(Ho.a,{type:"ghost",icon:Object(Z.jsx)(Xo.a,{}),onClick:function(e){n&&n.reset()},children:"Reset"}),t.setPrelabeling&&Object(Z.jsxs)(Ho.a,{style:{display:"none"},onClick:function(e){t.resetPrelabeling()},children:[" ","Reset Prelabeling"]})]}),Object(Z.jsxs)("div",{className:Yo.a.block,children:[Object(Z.jsx)(A.a,{className:"tool-button",sx:{color:"#3f407d"},onClick:function(e){return t.settings.toggleFullscreen(),e.preventDefault(),!1},children:Object(Z.jsx)(yo.a,{icon:t.settings.fullscreen?Oo.h:Oo.g})}),t.description&&t.showingDescription&&Object(Z.jsx)(Jo,{title:"\u062a\u0648\u0636\u06cc\u062d\u0627\u062a \u0628\u0631\u0646\u0627\u0645\u06a9",children:Object(Z.jsx)(A.a,{className:"tool-button",sx:{color:"#3f407d"},onClick:function(e){t.toggleDescription()},children:Object(Z.jsx)(yo.a,{icon:Oo.q})})}),t.description&&!t.showingDescription&&Object(Z.jsx)(Jo,{title:"\u062a\u0648\u0636\u06cc\u062d\u0627\u062a \u0628\u0631\u0646\u0627\u0645\u06a9",children:Object(Z.jsx)(A.a,{className:"tool-button",sx:{color:"#3f407d"},onClick:function(e){t.toggleDescription()},children:Object(Z.jsx)(yo.a,{icon:Oo.q})})}),Object(Z.jsx)(Jo,{title:"\u062a\u0646\u0638\u06cc\u0645\u0627\u062a",children:Object(Z.jsx)(A.a,{className:"tool-button",sx:{color:"#3f407d"},onClick:function(e){return t.toggleSettings(),e.preventDefault(),!1},children:Object(Z.jsx)(yo.a,{icon:Oo.f})})})]})]})})),Ko=n(838),qo=n(93),Zo=n(830),$o=n(465),Qo=n(865),ea=Object(en.c)((function(e){var t=e.item,n=e.store;return Object(Z.jsx)(Ko.b.Item,{className:t.selected?"".concat(mo.a.completion," ").concat(mo.a.completion_selected):mo.a.completion,onClick:function(e){!t.selected&&n.completionStore.selectPrediction(t.id)},children:Object(Z.jsxs)("div",{className:mo.a.itembtns,children:[Object(Z.jsxs)("div",{children:[Object(Z.jsx)("div",{className:mo.a.title,children:t.createdBy?"Model (".concat(t.createdBy,")"):null}),"Created",Object(Z.jsx)("i",{children:t.createdAgo?" ".concat(t.createdAgo," ago"):" ".concat(ho.UDate.prettyDate(t.createdDate))})]}),Object(Z.jsx)("div",{className:mo.a.buttons,children:t.selected&&Object(Z.jsx)(qo.a,{placement:"topLeft",title:"Add a new completion based on this prediction",children:Object(Z.jsx)(Ho.a,{size:"small",onClick:function(e){e.preventDefault();var t=n.completionStore,o=t.selected,a=t.addCompletionFromPrediction(o);window.setTimeout((function(){n.completionStore.selectCompletion(a.id)}),50)},children:Object(Z.jsx)($o.a,{})})})})]})},t.id)})),ta=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props.store,t=e.completionStore.predictions,n=Object(Z.jsxs)("div",{className:mo.a.title+" "+mo.a.titlespace,children:[Object(Z.jsx)("h3",{children:"Predictions"}),e.completionStore.predictions.length>0&&Object(Z.jsx)(qo.a,{placement:"topLeft",title:"View all predictions",children:Object(Z.jsx)(Ho.a,{size:"small",type:e.completionStore.viewingAllPredictions?"primary":"",onClick:function(t){t.preventDefault(),e.completionStore.toggleViewingAllPredictions()},children:Object(Z.jsx)(Qo.a,{})})})]});return Object(Z.jsx)(Zo.a,{title:n,size:"small",bodyStyle:{padding:"0"},children:Object(Z.jsx)(Ko.b,{children:t&&t.length?t.map((function(t){return Object(Z.jsx)(ea,{item:t,store:e},t.id)})):Object(Z.jsx)(Ko.b.Item,{children:Object(Z.jsx)("div",{style:{padding:"0 12px"},children:"No predictions"})})})})}}]),n}(d.Component),na=(Object(en.c)(ta),n(445)),oa=n.n(na),aa=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=oa.a.block;return this.props.className&&(e=e+" "+this.props.className),Object(Z.jsx)("div",{className:e,children:this.props.children})}}]),n}(u.a.Component),ra=n(814),ia=n(820),la=n(349),sa=n(204),ca=n(158),da=n.n(ca),ua={},pa={};da.a.filter=function(e){if("__none__"!==da.a.getScope()){var t=(e.target||e.srcElement).tagName,n=(e.target||e.srcElement).name;return da.a.setScope(/^(INPUT|TEXTAREA|SELECT)$/.test(t)?n:"__main__"),!0}};var ga={removeKey:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"__main__";da.a.unbind(e,t),delete ua[e],delete pa[e]},addKey:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"__main__";ua[e]||(ua[e]=t,pa[e]=n,da()(e,o,t))},unbindAll:function(){for(var e=0,t=Object.keys(ua);e<t.length;e++){var n=t[e];da.a.unbind(n)}ua={}},makeComb:function(){for(var e="1234567890qwertasdfgzxcvbyuiophjklnm".split(""),t=0;t<=e.length;t++){var n=void 0;if(n=e[t],!ua.hasOwnProperty(n))return n}return null},setScope:function(e){da.a.setScope(e)},getKeys:function(){return Object.keys(ua)},keysDescipritions:function(){return pa}},fa=function(){var e=ga.keysDescipritions(),t=Object.keys(e).filter((function(t){return e[t]})).map((function(t){return new Object({key:t,descr:e[t]})}));return Object(Z.jsx)(ra.a,{columns:[{title:"Key",dataIndex:"key",key:"key"},{title:"Description",dataIndex:"descr",key:"descr"}],dataSource:t,size:"small"})},ha=Object(en.c)((function(e){var t=e.store;return Object(Z.jsx)(ia.a,{visible:t.showingSettings,title:"Settings",bodyStyle:{paddingTop:"0"},footer:"",onCancel:t.toggleSettings,children:Object(Z.jsxs)(la.a,{defaultActiveKey:"1",children:[Object(Z.jsxs)(la.a.TabPane,{tab:"General",children:[Object(Z.jsx)(sa.a,{value:"Enable labeling hotkeys",defaultChecked:t.settings.enableHotkeys,onChange:function(){t.settings.toggleHotkeys()},children:"Enable labeling hotkeys"}),Object(Z.jsx)("br",{}),Object(Z.jsx)(sa.a,{value:"Show tooltips",defaultChecked:t.settings.enableTooltips,onChange:function(){t.settings.toggleTooltips()},children:"Show hotkey tooltips"}),Object(Z.jsx)("br",{}),Object(Z.jsx)(sa.a,{value:"Show labels tooltips",defaultChecked:t.settings.enableLabelTooltips,onChange:function(){t.settings.toggleLabelTooltips()},children:"Show labels hotkey tooltips"}),Object(Z.jsx)("br",{}),Object(Z.jsx)(sa.a,{value:"Show labels inside the regions",defaultChecked:t.settings.showLabels,onChange:function(){t.settings.toggleShowLabels()},children:"Show labels inside the regions"}),Object(Z.jsx)("br",{}),Object(Z.jsx)(sa.a,{value:"Keep label selected after creating a region",defaultChecked:t.settings.continuousLabeling,onChange:function(){t.settings.toggleContinuousLabeling()},children:"Keep label selected after creating a region"})]},"1"),Object(Z.jsx)(la.a.TabPane,{tab:"Hotkeys",children:Object(Z.jsx)(fa,{})},"2"),Object(Z.jsx)(la.a.TabPane,{tab:"Layout",children:Object(Z.jsx)(sa.a,{value:"Move sidepanel to the bottom",defaultChecked:t.settings.bottomSidePanel,onChange:function(){t.settings.toggleBottomSP()},children:"Move sidepanel to the bottom"})},"3")]})})})),ba=n(825),ma=n(839),ja=n(175),va=n(455),ya=n(288),Oa=n(874),xa=n(875),Sa=n(291),wa=(n(705),n(140)),_a=n.n(wa),ka=n(228),Ca=n.n(ka),Na=n(866),Ta=n(867),Ra=n(868),Ma=n(869),Aa=n(870),za=n(871),Pa=n(464),Ia=n(872),La=n(873),Ha=n(347),Ea=n.n(Ha),Da={TextRegionModel:["Text",Na.a,function(e){return Object(Z.jsx)("span",{className:null,children:e.text.substring(0,100)})}],HyperTextRegionModel:["HTML",Na.a,function(e){return Object(Z.jsx)("span",{style:{color:"#5a5a5a"},children:e.text})}],AudioRegionModel:["Audio",Ta.a,function(e){return"Audio ".concat(e.start.toFixed(2)," - ").concat(e.end.toFixed(2))}],TextAreaRegionModel:["Input",Ra.a,function(e){return Object(Z.jsxs)(d.Fragment,{children:["Input ",Object(Z.jsx)("span",{style:{color:"#5a5a5a"},children:e._value})]})}],RectRegionModel:["Rect",Ma.a,function(e){var t=e.width*e.scaleX,n=e.height*e.scaleY;return"Rectangle ".concat(t.toFixed(2)," x ").concat(n.toFixed(2))}],PolygonRegionModel:["Polygon",Aa.a,function(){return"Polygon"}],EllipseRegionModel:["Ellipse",za.a,function(e){var t=e.radiusX*e.scaleX,n=e.radiusY*e.scaleY,o=e.rotation;return"Ellipse ".concat(t.toFixed(2)," x ").concat(n.toFixed(2),", \u03b8 = ").concat(o.toFixed(2),"\xb0,\n        center = (").concat(e.x.toFixed(2),", ").concat(e.y.toFixed(2),")")}],KeyPointRegionModel:["KeyPoint",Pa.a,function(){return"KeyPoint"}],BrushRegionModel:["Brush",Ia.a,function(){return"Brush"}],ChoicesModel:["Classification",La.a,function(){return"Classification"}],TextAreaModel:["Input",Ra.a,function(){return"Input"}]},Wa=Object(en.c)((function(e){var t=e.className,n=e.node,o=e.onClick,a=Object(Qt.i)(n).name;a in Da||console.error("No ".concat(a," in NodeView"));var r=Object(v.a)(Da[a],3),i=r[1],l=r[2];return Object(Z.jsxs)("span",{onClick:o||function(e){return e.preventDefault(),Object(Qt.g)(n).completionStore.selected.regionStore.unselectAll(),n.selectRegion(),!1},className:[Ea.a.node,t].filter(Boolean).join(" "),children:[Object(Z.jsx)(i,{}),l(n)]})})),Ua=Object(en.c)((function(e){var t=e.node,n=Object(Qt.g)(t).completionStore.selected.regionStore.sortedRegions.indexOf(t),o=Object(Qt.i)(t).name;if(!(o in Da))return null;var a=t.getOneColor(),r={};r=a?{backgroundColor:a}:{backgroundColor:"#fff",color:"#999",boxShadow:"0 0 0 1px #d9d9d9 inset"};var i=Object(v.a)(Da[o],2),l=i[0],s=i[1];return Object(Z.jsxs)("span",{className:Ea.a.minimal,dir:"rtl",children:[n>=0&&Object(Z.jsx)(ba.a,{count:n+1,style:r}),Object(Z.jsx)(s,{}),l]})})),Ba=n(446),Xa=n.n(Ba),Fa=["number","className"],Ya=function(e){var t=e.number,n=e.className,o=Object(yn.a)(e,Fa);return Object(Z.jsx)("div",Object(f.a)(Object(f.a)({className:[Xa.a.badge,n].filter(Boolean).join(" ")},o),{},{children:t}))},Va=n(876),Ja=n(877),Ga=(n(706),["className"]),Ka=Object(rt.a)((function(e){var t=e.className,n=Object(yn.a)(e,Ga);return Object(Z.jsx)(Xt.a,Object(f.a)(Object(f.a)({},n),{},{arrow:!0,classes:{popper:t}}))}))((function(e){var t,n=e.theme;return t={},Object(at.a)(t,"& .".concat(jo.a.arrow),{color:n.palette.common.black}),Object(at.a)(t,"& .".concat(jo.a.tooltip),{backgroundColor:n.palette.common.black}),t})),qa=Object(en.c)((function(e){var t=e.item,n=e.idx,o=e.flat,a=Object(Qt.g)(t).completionStore,r=[_a.a.lstitem,o&&_a.a.flat,!0===t.hidden&&_a.a.hidden,t.selected&&_a.a.selected].filter(Boolean),i=t.getOneColor(),l={};return l=i?{backgroundColor:i}:{backgroundColor:"#fff",color:"#999",boxShadow:"0 0 0 1px #d9d9d9 inset"},Object(Z.jsxs)(Ko.b.Item,{dir:"rtl",className:r.join(" "),onClick:function(){a&&a.selected.regionStore.unselectAll(),t.selectRegion()},onMouseOver:function(){a&&a.selected.regionStore.unhighlightAll(),t.setHighlight(!0)},onMouseOut:function(){a&&a.selected.regionStore.unhighlightAll(),t.setHighlight(!1)},children:[Object(Z.jsx)(Ya,{number:n+1,style:l}),Object(Z.jsx)(Wa,{node:t,onClick:function(){},className:"".concat(_a.a.node," region-item")}),!t.editable&&Object(Z.jsx)(ba.a,{count:"ro",style:{backgroundColor:"#ccc"}}),t.score&&Object(Z.jsx)("span",{className:_a.a.confbadge,style:{color:ho.Colors.getScaleGradient(t.score)},children:t.score.toFixed(2)})]},t.id)})),Za=Object(en.c)((function(e){var t=e.item,n=(e.idx,{backgroundColor:t.background,color:t.selectedcolor,cursor:"pointer",margin:"5px"});return Object(Z.jsx)(ma.a,{style:n,size:t.size,children:t._value})})),$a=function(e){e.store;var t=e.regionStore;return Object(Z.jsxs)(ja.a,{selectedKeys:[t.view],children:[Object(Z.jsx)(ja.a.Item,{dir:"rtl",children:Object(Z.jsx)("div",{onClick:function(e){return t.setView("regions"),e.preventDefault(),!1},style:{width:"135px",display:"flex",justifyContent:"space-between"},children:Object(Z.jsx)("div",{children:"\u0645\u0646\u0637\u0642\u0647\u200c\u0647\u0627"})})},"regions"),Object(Z.jsx)(ja.a.Item,{dir:"rtl",children:Object(Z.jsx)("div",{onClick:function(e){return t.setView("labels"),e.preventDefault(),!1},style:{width:"135px",display:"flex",justifyContent:"space-between"},children:Object(Z.jsx)("div",{children:"\u0628\u0631\u0686\u0633\u0628\u200c\u0647\u0627"})})},"labels")]})},Qa=(Object(en.c)((function(e){var t=e.regionStore;return Object(Z.jsxs)(ja.a,{selectedKeys:[t.sort],children:[Object(Z.jsx)(ja.a.Item,{children:Object(Z.jsxs)("div",{onClick:function(e){return t.setSort("date"),e.preventDefault(),!1},style:{width:"135px",display:"flex",justifyContent:"space-between"},children:[Object(Z.jsxs)("div",{children:[Object(Z.jsx)(Oa.a,{})," Date"]}),Object(Z.jsx)("div",{})]})},"date"),Object(Z.jsx)(ja.a.Item,{children:Object(Z.jsxs)("div",{onClick:function(e){return t.setSort("score"),e.preventDefault(),!1},style:{width:"135px",display:"flex",justifyContent:"space-between"},children:[Object(Z.jsxs)("div",{children:[Object(Z.jsx)(xa.a,{})," Score"]}),Object(Z.jsx)("div",{})]})},"score")]})})),Object(en.c)((function(e){var t=e.regionStore.asLabelsTree((function(e,t,n){return{key:e.id,title:n?Object(Z.jsx)(Za,{item:e,idx:t}):Object(Z.jsx)(qa,{item:e,idx:t})}}));return Object(Z.jsx)(va.a,{className:_a.a.treelabels,style:{direction:"rtl",paddingRight:"7px"},treeData:t,showIcon:!1,blockNode:!0,defaultExpandAll:!0,autoExpandParent:!0,switcherIcon:Object(Z.jsx)(Sa.a,{})})}))),er=Object(en.c)((function(e){var t=e.regionStore,n=!t.sortedRegions.some((function(e){return""!==e.parentID})),o=t.asTree((function(e,t){return{key:e.id,title:Object(Z.jsx)(qa,{item:e,idx:t,flat:n})}}));return Object(Z.jsx)(va.a,{className:_a.a.treelabels,treeData:o,draggable:!0,showIcon:!1,blockNode:!0,defaultExpandAll:!0,autoExpandParent:!0,switcherIcon:Object(Z.jsx)(Sa.a,{}),onDrop:function(e){var n=e.node,o=e.dragNode,a=e.dropPosition,r=e.dropToGap,i=n.props.eventKey,l=o.props.eventKey,s=n.props.pos.split("-");a-=parseInt(s[s.length-1]);var c=s.length,d=t.findRegionID(i),u=t.findRegionID(l);t.unhighlightAll(),2===c&&r&&-1===a?u.setParentID(""):-1!==a&&u.setParentID(d.pid)}})})),tr=Object(en.c)((function(e){e.store;var t=e.regionStore,n=t.regions;return Object(Z.jsx)("div",{children:Object(Z.jsxs)(re.a,{children:[Object(Z.jsx)(Va.a,{sx:{direction:"ltr !important",borderTop:"solid 1px","& div span":{fontSize:"1rem",color:"rgba(0, 0, 0, 1)"}},action:Object(Z.jsx)(Ka,{title:"\u0645\u0631\u062a\u0628 \u0634\u062f\u0647 \u0628\u0631 \u0627\u0633\u0627\u0633 \u062a\u0627\u0631\u06cc\u062e",children:Object(Z.jsx)(A.a,{sx:{fontSize:"1rem"},children:Object(Z.jsx)(yo.a,{icon:Oo.b})})}),title:Object(Z.jsx)(ya.a,{overlay:Object(Z.jsx)($a,{regionStore:t}),placement:"bottomRight",children:Object(Z.jsxs)("span",{className:Ca.a.link,onClick:function(e){return e.preventDefault()},children:["regions"===t.view?Object(Z.jsxs)("span",{children:["\u0645\u0646\u0637\u0642\u0647\u200c\u0647\u0627 (",n.length,")"]}):null,"labels"===t.view?"\u0628\u0631\u0686\u0633\u0628\u200c\u0647\u0627":null]})})}),Object(Z.jsxs)(Ja.a,{children:[!n.length&&Object(Z.jsx)("p",{style:{display:"flex",direction:"rtl",justifyContent:"center"},children:"\u0646\u0627\u062d\u06cc\u0647\u200c\u0627\u06cc \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f!!!"}),n.length>0&&"regions"===t.view&&Object(Z.jsx)(er,{regionStore:t}),n.length>0&&"labels"===t.view&&Object(Z.jsx)(Qa,{regionStore:t})]})]})})})),nr=n(878),or=n(819),ar=n(159),rr=n.n(ar),ir=(n(707),["className"]),lr=Object(rt.a)((function(e){var t=e.className,n=Object(yn.a)(e,ir);return Object(Z.jsx)(Xt.a,Object(f.a)(Object(f.a)({},n),{},{arrow:!0,classes:{popper:t}}))}))((function(e){var t,n=e.theme;return t={},Object(at.a)(t,"& .".concat(jo.a.arrow),{color:n.palette.common.black}),Object(at.a)(t,"& .".concat(jo.a.tooltip),{backgroundColor:n.palette.common.black}),t})),sr=or.a.Paragraph,cr=or.a.Text,dr=Object(en.c)((function(e){var t=e.node,n=function(e){if(-1!==Object(Qt.i)(e).name.indexOf("Labels"))return n=e,Object(Z.jsxs)(cr,{className:rr.a.labels,children:["\u0628\u0631\u0686\u0633\u0628\u200c\u0647\u0627:\xa0",n.selectedValues().map((function(e){var t=n.findLabel(e).background?n.findLabel(e).background:"#000000";return Object(Z.jsx)(ma.a,{color:t,className:rr.a.tag,children:e},n.findLabel(e).id)}))]},n.pid);if("RatingModel"===Object(Qt.i)(e).name)return Object(Z.jsxs)(sr,{children:["Rating: ",e.getSelectedString()]});if("TextAreaModel"===Object(Qt.i)(e).name){var t=e.regions.map((function(e){return e._value})).join("\n");return Object(Z.jsxs)(sr,{className:rr.a.row,children:[Object(Z.jsx)(cr,{children:"Text: "}),Object(Z.jsx)(cr,{mark:!0,className:rr.a.long,children:t})]})}return"ChoicesModel"===Object(Qt.i)(e).name?Object(Z.jsxs)(sr,{children:["Choices: ",e.getSelectedString(", ")]}):null;var n};return Object(Z.jsx)(d.Fragment,{children:t.states.filter((function(e){return e.holdsState})).map((function(e){return n(e)}))})})),ur=Object(en.c)((function(e){var t=e.store,n=e.completion,o=n.highlightedNode;return Object(Z.jsxs)(d.Fragment,{children:[o&&Object(Z.jsxs)(So,{children:[Object(Z.jsxs)("p",{className:rr.a.row,style:{marginTop:"15px",direction:"rtl"},children:[Object(Z.jsx)(Ua,{node:o})," (id: ",o.id,")"," ",!o.editable&&Object(Z.jsx)(ba.a,{count:"readonly",style:{backgroundColor:"#ccc"}})]}),Object(Z.jsxs)("div",{className:rr.a.statesblk+" ls-entity-states",style:{direction:"rtl",paddingRight:"10px"},children:[o.score&&Object(Z.jsx)(d.Fragment,{children:Object(Z.jsxs)(cr,{children:["Score: ",Object(Z.jsx)(cr,{underline:!0,children:o.score})]})}),o.normalization&&Object(Z.jsxs)(cr,{children:["Normalization: ",Object(Z.jsx)(cr,{code:!0,children:o.normalization}),"\xa0",Object(Z.jsx)(nr.a,{type:"delete",style:{cursor:"pointer"},onClick:function(){o.deleteNormalization()}})]}),o.states&&Object(Z.jsx)(dr,{node:o})]})]}),!o&&Object(Z.jsx)("p",{style:{marginBottom:"20px",direction:"rtl",display:"flex",justifyContent:"center",alignItems:"center",marginTop:"15px"},children:"\u0646\u062a\u06cc\u062c\u0647\u200c\u0627\u06cc \u0627\u0646\u062a\u062e\u0627\u0628\u200c \u0646\u0634\u062f\u0647\u200c\u0627\u0633\u062a!!!"}),Object(Z.jsxs)("div",{className:rr.a.block+" ls-entity-buttons buttons-container",children:[Object(Z.jsx)(d.Fragment,{children:Object(Z.jsx)(lr,{title:"Create Relation: [r]",children:Object(Z.jsxs)(A.a,{disabled:!(o&&o.editable),className:"tool-button",sx:{color:"#3f407d"},onClick:function(e){n.startRelationMode(o)},children:[Object(Z.jsx)(yo.a,{icon:Oo.j}),t.settings.enableHotkeys&&t.settings.enableTooltips&&Object(Z.jsx)(Mo,{children:"[ r ]"})]})})}),Object(Z.jsx)(lr,{title:"Unselect: [u]",children:Object(Z.jsxs)(A.a,{disabled:!(o&&o.editable),className:"tool-button",sx:{color:"#3f407d"},onClick:function(e){n.highlightedNode.unselectRegion()},children:[Object(Z.jsx)(yo.a,{icon:Oo.e}),t.settings.enableHotkeys&&t.settings.enableTooltips&&Object(Z.jsx)(Mo,{children:"[ u ]"})]})}),Object(Z.jsx)(lr,{title:"Delete Entity: [Backspace]",children:Object(Z.jsxs)(A.a,{disabled:!(o&&o.editable),className:"tool-button",sx:{color:"red"},onClick:function(e){n.highlightedNode.deleteRegion()},children:[Object(Z.jsx)(yo.a,{icon:Oo.s}),t.settings.enableHotkeys&&t.settings.enableTooltips&&Object(Z.jsx)(Mo,{children:"[ Bksp ]"})]})})]})]})})),pr=n(230),gr=n(844),fr=n(845),hr=n(879),br=n(880),mr=n(141),jr=n.n(mr),vr=["className"],yr=(Object(rt.a)((function(e){var t=e.className,n=Object(yn.a)(e,vr);return Object(Z.jsx)(Xt.a,Object(f.a)(Object(f.a)({},n),{},{arrow:!0,classes:{popper:t}}))}))((function(e){var t,n=e.theme;return t={},Object(at.a)(t,"& .".concat(jo.a.arrow),{color:n.palette.common.black}),Object(at.a)(t,"& .".concat(jo.a.tooltip),{backgroundColor:n.palette.common.black}),t})),pr.a.Option),Or=Object(en.c)((function(e){e.store;var t=e.rl.relations,n=t.getSelected().map((function(e){return e.value}));return Object(Z.jsxs)("div",{style:{marginTop:"10px"},children:[Object(Z.jsx)("h4",{className:jr.a.header,children:"LABELS"}),Object(Z.jsx)(pr.a,{mode:"multiple"===t.choice?"multiple":"",style:{width:"100%"},placeholder:"Please select",defaultValue:n,onChange:function(e,n){t.unselectAll(),e.forEach((function(e){return t.findRelation(e).setSelected(!0)}))},children:t.children.map((function(e){return Object(Z.jsx)(yr,{style:{background:e.background},children:e.value},e.value)}))})]})})),xr=Object(en.c)((function(e){e.store;var t=e.rl;if(!Object(Qt.j)((function(){return t.node1}))||!Object(Qt.j)((function(){return t.node2})))return null;var n={left:Object(Z.jsx)(gr.a,{}),right:Object(Z.jsx)(fr.a,{}),bi:Object(Z.jsx)(hr.a,{})};return Object(Z.jsx)("div",{children:Object(Z.jsxs)("div",{className:jr.a.section__blocks,children:[Object(Z.jsx)("div",{children:Object(Z.jsx)(Ua,{node:t.node1})}),Object(Z.jsx)(Ho.a,{onClick:function(){return t.rotateDirection()},size:"small",className:jr.a.relationbtn,children:n[t.direction]}),Object(Z.jsx)("div",{children:Object(Z.jsx)(Ua,{node:t.node2})})]})})})),Sr=Object(en.c)((function(e){var t=e.item,n=Object(Qt.g)(t).completionStore.selected.highlightedNode,o=n===t.node1||n===t.node2;return Object(Z.jsxs)(Ko.b.Item,{className:o&&jr.a.selected,actions:[],onMouseOver:function(){t.toggleHighlight()},onMouseOut:function(){t.toggleHighlight()},children:[Object(Z.jsxs)("div",{className:jr.a.item,children:[Object(Z.jsx)("div",{children:Object(Z.jsx)(xr,{rl:t})}),Object(Z.jsxs)("div",{children:[t.hasRelations&&Object(Z.jsx)(Ho.a,{size:"small",onClick:function(){t.toggleMeta()},className:jr.a.button,children:Object(Z.jsx)(br.a,{})}),"\xa0",Object(Z.jsx)(Ho.a,{size:"small",className:jr.a.button,onClick:function(){return t.node1.setHighlight(!1),t.node2.setHighlight(!1),t.parent.deleteRelation(t),!1},danger:!0,children:Object(Z.jsx)(nr.a,{})})]})]}),t.showMeta&&Object(Z.jsx)(Or,{rl:t})]},t.id)})),wr=Object(en.c)((function(e){var t=e.store.completionStore.selected,n=t.relationStore.relations;return Object(Z.jsx)(d.Fragment,{children:Object(Z.jsxs)(re.a,{sx:{marginTop:"24px"},children:[Object(Z.jsx)(Va.a,{sx:{direction:"ltr !important",borderTop:"solid 1px","& div span":{fontSize:"1rem",color:"rgba(0, 0, 0, 1)"}},action:Object(Z.jsx)(A.a,{disabled:!0,sx:{fontSize:"1rem"},children:Object(Z.jsx)(yo.a,{icon:Oo.j})}),title:Object(Z.jsxs)("span",{children:["\u0631\u0627\u0628\u0637\u0647\u200c\u0647\u0627 (",n.length,")"]})}),Object(Z.jsxs)(Ja.a,{children:[!n.length&&Object(Z.jsx)("p",{style:{display:"flex",direction:"rtl",justifyContent:"center"},children:"\u0631\u0627\u0628\u0637\u0647\u200c\u0627\u06cc \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f!!!"}),n.length>0&&Object(Z.jsx)(Ko.b,{size:"small",bordered:!0,itemLayout:"vertical",className:jr.a.list,dataSource:t.relationStore.relations,renderItem:function(e){return Object(Z.jsx)(Sr,{item:e})}})]})]})})})),_r=(n(709),["className"]),kr=Object(rt.a)((function(e){var t=e.className,n=Object(yn.a)(e,_r);return Object(Z.jsx)(Xt.a,Object(f.a)(Object(f.a)({},n),{},{arrow:!0,classes:{popper:t}}))}))((function(e){var t,n=e.theme;return t={},Object(at.a)(t,"& .".concat(jo.a.arrow),{color:n.palette.common.black}),Object(at.a)(t,"& .".concat(jo.a.tooltip),{backgroundColor:n.palette.common.black}),t})),Cr=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).buttonRemove=function(e){return Object(Z.jsx)(xo.a,{placement:"bottomLeft",title:"Please confirm you want to delete all labeled regions",onConfirm:function(){e.deleteAllRegions()},okText:"Delete",okType:"danger",cancelText:"Cancel",children:Object(Z.jsx)(kr,{title:"\u062d\u0630\u0641 \u0647\u0645\u0647\u200c\u06cc \u0646\u062a\u0627\u06cc\u062c",children:Object(Z.jsx)(A.a,{size:"large",sx:{"& svg":{color:"white",fontSize:"1.15rem !important",transition:"0.2s",transform:"translateX(0) rotate(0)"},"&:hover, &:focus":{bgcolor:"unset"},"&:after":{content:'""',position:"absolute",height:"80%",display:"block",left:0,width:"1px",bgcolor:"white"}},children:Object(Z.jsx)(yo.a,{icon:Oo.s})})})})},o.toggleListItem=function(){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{openListItem:!o.state.openListItem}))},o.state={openListItem:!0},o}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props.store,t=e.completionStore.selected,n=e.completionStore.selected;t.highlightedNode,n.regionStore.regions;return Object(Z.jsx)(oe,{children:Object(Z.jsxs)(lt.a,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper",borderRadius:"20px"},component:"div",children:[Object(Z.jsxs)(st.a,{component:"div",disablePadding:!0,sx:{backgroundColor:"#3f407d"},children:[this.buttonRemove(n),Object(Z.jsxs)(vo.a,{sx:{height:56},onClick:this.toggleListItem,children:[Object(Z.jsx)(ct.a,{primary:"\u0646\u062a\u0627\u06cc\u062c",primaryTypographyProps:{color:"white",fontWeight:"medium",variant:"body2"}}),Object(Z.jsx)(Ge.a,{sx:{minWidth:"0px",marginRight:"10px",color:"white"},children:Object(Z.jsx)(yo.a,{icon:Oo.p,color:"primary"})})]})]}),Object(Z.jsx)(W.a,{}),Object(Z.jsx)(xt.a,{in:this.state.openListItem,timeout:"auto",unmountOnExit:!0,sx:{border:"solid 1px rgba(34, 36, 38, 0.15)"},children:Object(Z.jsxs)(lt.a,{component:"div",disablePadding:!0,className:"completion-list",children:[Object(Z.jsx)(ur,{store:e,completion:t}),Object(Z.jsx)(tr,{store:e,regionStore:t.regionStore}),Object(Z.jsx)(wr,{store:e,item:t})]})})]})})}}]),n}(d.Component),Nr=Object(en.c)(Cr),Tr=n(881),Rr=n(882),Mr=Object(en.c)((function(e){var t=e.item,n=e.store;return Object(Z.jsx)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"1em"},children:Object(Z.jsxs)(Ho.a,{type:"primary",onClick:function(e){t._ws.playPause()},children:[t.playing&&Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)(Tr.a,{})," Pause",n.settings.enableTooltips&&n.settings.enableHotkeys&&t.hotkey&&Object(Z.jsxs)(Mo,{children:["[",t.hotkey,"]"]})]}),!t.playing&&Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)(Rr.a,{})," Play",n.settings.enableTooltips&&n.settings.enableHotkeys&&t.hotkey&&Object(Z.jsxs)(Mo,{children:["[",t.hotkey,"]"]})]})]})})})),Ar=Object(en.c)(Mr),zr=n(348),Pr=n.n(zr),Ir=function(e,t,n){var o={type:"",title:""};switch(e){case"error":o.type=ia.a.error,o.title="Error";break;case"warning":o.type=ia.a.warning,o.title="Warning";break;case"success":o.type=ia.a.success,o.title="Success";break;default:o.type=ia.a.info,o.title="Info"}o.type({title:n||o.title,content:t})},Lr={error:function(e,t){Ir("error",e,t)},warning:function(e,t){Ir("warning",e,t)},success:function(e,t){Ir("success",e,t)},info:function(e,t){Ir("info",e,t)}},Hr=Qt.n.model({_needsUpdate:Qt.n.optional(Qt.n.number,0)}).views((function(e){return{findRegion:function(t){var n=null;return e._regionsCache&&e._regionsCache.length&&(n=e._regionsCache.find((function(e){var n=e.region;return Pr()(n,t)}))),n||e.regions.find((function(e){return Pr()(e,t)}))}}})).actions((function(e){return{toStateJSON:function(){if(e.regions)return e.regions.map((function(e){return e.toStateJSON()}))}}})).actions((function(e){var t={};return{addProp:function(n,o){t[n]=o,e._needsUpdate=e._needsUpdate+1},getProps:function(){return t},getAvailableStates:function(){var t=(e.states()||[]).reduce((function(e,t){return t.checkMaxUsages?e.concat(t.checkMaxUsages()):e}),[]),n=e.activeStates()||[];if(0===n.length){if(t.length){var o=t[0];Lr.warning("You can't use ".concat(o.value," more than ").concat(o.maxUsages," time(s)"))}e.completion.regionStore.unselectAll(!0)}return n}}})),Er=Hr,Dr=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=t.getProps&&t.getProps();return Object(Z.jsx)("div",Object(f.a)(Object(f.a)({className:e.className,dataneedsupdate:t._needsUpdate,style:e.style},n),{},{children:e.children}))}}]),n}(u.a.Component),Wr=Object(en.c)(Dr),Ur=n(448),Br=n.n(Ur),Xr=n(283),Fr=n.n(Xr),Yr=n(883),Vr=n(884),Jr=n(449),Gr=n.n(Jr),Kr=n(450),qr=n.n(Kr),Zr=n(451),$r=n.n(Zr),Qr=n(452),ei=n.n(Qr),ti=n(206),ni=n(121),oi=n(818),ai=n(885);function ri(e,t){e=Number(e);var n=Math.floor(e/60);e%=60;var o=Math.round(e).toString();return t>=250?o=e.toFixed(2):t>=25&&(o=e.toFixed(1)),n>0?(e<10&&(o="0"+o),"".concat(n,":").concat(o)):o}function ii(e){return e>=2500?.01:e>=1e3?.025:e>=250?.1:e>=100?.25:e>=25?1:5*e>=25?5:15*e>=25?15:60*Math.ceil(.5/e)}function li(e){return e>=2500?10:e>=1e3?4:e>=250?10:e>=100?4:e>=25?1:5*e>=25?5:15*e>=25?15:60*Math.ceil(.5/e)}function si(e){return Math.floor(10/ii(e))}var ci=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).onChangeZoom=function(e){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{zoom:e})),o.wavesurfer.zoom(e)},o.onChangeVolume=function(e){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{volume:e})),o.wavesurfer.setVolume(e)},o.onChangeSpeed=function(e){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{speed:e})),o.wavesurfer.setPlaybackRate(e)},o.onZoomPlus=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=o.state.zoom;return(n+=t)>700&&(n=700),o.onChangeZoom(n),e&&e.preventDefault(),!1},o.onZoomMinus=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=o.state.zoom;return(n-=t)<0&&(n=0),o.onChangeZoom(n),e.preventDefault(),!1},o.onWheel=function(e){if(!e||e.shiftKey){e&&e.shiftKey&&e.preventDefault();var t=e.deltaY>0?5:-5;o.onZoomPlus(e,t)}},o.state={src:o.props.src,pos:0,colors:{waveColor:"#97A0AF",progressColor:"#52c41a"},zoom:0,speed:1,volume:1},o}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.$el=g.a.findDOMNode(this),this.$waveform=this.$el.querySelector("#wave");var t={container:this.$waveform,waveColor:this.state.colors.waveColor,height:this.props.height,backend:"MediaElement",progressColor:this.state.colors.progressColor,splitChannels:!0};this.props.regions&&(t=Object(f.a)(Object(f.a)({},t),{},{plugins:[Gr.a.create({dragSelection:{slop:5}}),qr.a.create({container:"#timeline",formatTimeCallback:ri,timeInterval:ii,primaryLabelInterval:li,secondaryLabelInterval:si,primaryColor:"blue",secondaryColor:"blue",primaryFontColor:"#000",secondaryFontColor:"#000"}),Br.a.create({wrapper:this.$waveform,showTime:!0,opacity:1})]})),this.wavesurfer=$r.a.create(t),this.wavesurfer.load(this.props.src),this.wavesurfer.setPlaybackRate(this.state.speed);var n=this;this.props.regions&&(this.wavesurfer.on("region-mouseenter",(function(e){e._region.onMouseOver()})),this.wavesurfer.on("region-mouseleave",(function(e){e._region.onMouseLeave()})),this.wavesurfer.on("region-created",(function(e){var t=n.props.addRegion(e);t&&(e._region=t,e.color=t.selectedregionbg,e.on("click",(function(){return t.onClick(n.wavesurfer)})),e.on("update-end",(function(){return t.onUpdateEnd(n.wavesurfer)})),e.on("dblclick",(function(t){window.setTimeout((function(){e.play()}),0)})),e.on("out",(function(){})))})));var o=document.querySelector("#slider");o&&(o.oninput=function(){n.wavesurfer.zoom(Number(this.value))}),this.wavesurfer.on("ready",(function(){n.props.onCreate(e.wavesurfer),e.wavesurfer.container.onwheel=Fr()(e.onWheel,100)})),this.wavesurfer.on("pause",n.props.handlePlay),this.wavesurfer.on("play",n.props.handlePlay),this.props.regions&&this.props.onLoad(this.wavesurfer)}},{key:"render",value:function(){var e=this,t=(this.props.store,this.props.item);return Object(Z.jsxs)("div",{children:[Object(Z.jsx)("div",{id:"wave",className:ei.a.wave}),Object(Z.jsx)("div",{id:"timeline"}),this.props.zoom&&Object(Z.jsxs)(ti.a,{gutter:16,style:{paddingTop:"3vh",justifyContent:"space-evenly",paddingBottom:"3vh",margin:0,borderBottom:"solid 1px rgba(34, 36, 38, 0.15)"},children:[Object(Z.jsx)(ni.a,{span:10,style:{textAlign:"right",marginTop:"6px"},children:Object(Z.jsxs)("div",{style:{display:"flex"},children:[Object(Z.jsx)("div",{style:{marginTop:"6px",marginRight:"5px"},children:Object(Z.jsx)(Yr.a,{onClick:this.onZoomMinus,className:Ca.a.link})}),Object(Z.jsx)("div",{style:{width:"100%"},children:Object(Z.jsx)(oi.a,{min:0,step:10,max:500,value:"number"===typeof this.state.zoom?this.state.zoom:0,onChange:function(t){e.onChangeZoom(t)}})}),Object(Z.jsx)("div",{style:{marginTop:"6px",marginLeft:"5px"},children:Object(Z.jsx)(Vr.a,{onClick:this.onZoomPlus,className:Ca.a.link})})]})}),Object(Z.jsx)(ni.a,{span:6,children:this.props.volume&&Object(Z.jsxs)("div",{style:{display:"flex",marginTop:"6.5px"},children:[Object(Z.jsx)("div",{style:{width:"100%"},children:Object(Z.jsx)(oi.a,{min:0,max:1,step:.1,value:"number"===typeof this.state.volume?this.state.volume:1,onChange:function(t){e.onChangeVolume(t)}})}),Object(Z.jsx)("div",{style:{marginLeft:"10px",marginTop:"5px"},children:Object(Z.jsx)(ai.a,{})})]})}),Object(Z.jsx)(ni.a,{span:4,style:{marginTop:"6px"},children:this.props.speed&&Object(Z.jsx)(pr.a,{placeholder:"Speed",style:{width:"100%"},defaultValue:this.state.speed,onChange:this.onChangeSpeed,children:["0.5","1.0","1.25","1.5","2.0"].map((function(e){return Object(Z.jsxs)(pr.a.Option,{value:+e,children:["Speed ",e]},e)}))})}),Object(Z.jsx)(ni.a,{span:4,style:{marginTop:"6px"},children:Object(Z.jsx)("div",{style:{display:"flex",justifyContent:"end",paddingRight:"5%"},children:Object(Z.jsx)(z.a,{variant:"contained",startIcon:Object(Z.jsx)(yo.a,{icon:t.playing?Oo.k:Oo.m}),sx:{direction:"ltr",width:"50%"},onClick:function(e){t._ws.playPause()},children:t.playing?"\u062a\u0648\u0642\u0641":"\u067e\u062e\u0634"})})})]})]})}}]),n}(u.a.Component),di=Object(en.c)(ci);function ui(e,t,n){return"string"===typeof t?ui(e,t.split("."),n):1===t.length&&void 0!==n?e[t[0]]=n:0===t.length?e:ui(e[t[0]],t.slice(1),n)}function pi(e,t){return"$"===e.charAt(0)?ui(t,e.substring(1)):e}function gi(e,t){t||(t={});for(var n,o,a=/[$](.+)/g,r=/(^( )?(var|if|for|else|switch|case|break|{|}|;))(.*)?/g,i="with(obj) { var r=[];\n",l=0,s=function e(t,n){return i+=n?t.match(r)?t+"\n":"r.push("+t+");\n":""!==t?'r.push("'+t.replace(/"/g,'\\"')+'");\n':"",e};o=a.exec(e);)s(e.slice(l,o.index))(o[1],!0),l=o.index+o[0].length;if(!e)return"";s(e.substr(l,e.length-l)),i=(i+'return r.join(""); }').replace(/[\r\t\n]/g," ");try{n=new Function("obj",i).apply(t,[t])}catch(c){console.error("'"+c.message+"'"," in \n\nCode:\n",i,"\n")}return n}var fi=Qt.n.model().actions((function(e){return{updateLocalValue:function(t){e._value=t},updateValue:function(t){e._value=gi(e.value,t.task.dataObj)||""}}})),hi=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),value:Qt.n.maybeNull(Qt.n.string),zoom:Qt.n.optional(Qt.n.boolean,!0),volume:Qt.n.optional(Qt.n.boolean,!0),speed:Qt.n.optional(Qt.n.boolean,!0)}),bi=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),type:"audio",_value:Qt.n.optional(Qt.n.string,""),playing:Qt.n.optional(Qt.n.boolean,!1),height:Qt.n.optional(Qt.n.number,20)}).views((function(e){return{get completion(){return Object(Qt.g)(e).completionStore.selected}}})).actions((function(e){return{wsCreated:function(t){e._ws=t},handlePlay:function(){e.playing=!e.playing}}})),mi=Qt.n.compose("AudioHOCModel",hi,bi,fi),ji=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),value:Qt.n.maybeNull(Qt.n.string),zoom:Qt.n.optional(Qt.n.boolean,!1),volume:Qt.n.optional(Qt.n.boolean,!1),speed:Qt.n.optional(Qt.n.boolean,!1),hotkey:Qt.n.maybeNull(Qt.n.string)}),vi=mi.named("AudioModel").actions((function(e){return{fromStateJSON:function(t,n){t.value.choices&&e.completion.names.get(t.from_name).fromStateJSON(t),t.value.text&&e.completion.names.get(t.from_name).fromStateJSON(t)},onHotKey:function(){return e._ws.playPause()},onLoad:function(t){e._ws=t}}})),yi=Qt.n.compose("AudioModel",vi,ji,Er),Oi=Object(en.c)((function(e){var t=e.store,n=e.item;return n._value?Object(Z.jsxs)(Wr,{item:n,children:[Object(Z.jsx)(di,{src:n._value,onCreate:n.wsCreated,onLoad:n.onLoad,handlePlay:n.handlePlay,speed:n.speed,zoom:n.zoom,volume:n.volume,regions:!1,height:n.height}),Object(Z.jsx)(Ar,{item:n,store:t})]}):null})),xi=Object(en.b)("store")(Object(en.c)(Oi));cn.addTag("audio",yi,xi);n(710);var Si=Qt.n.model("WithStates").views((function(e){return{getOneColor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"first";if(e.states){if("first"===t){var n=e.states.find((function(e){return"getSelectedColor"in e}));return n?n.getSelectedColor():null}t="combine"}},getClonedStates:function(){return e.states.map((function(e){return gn(e)}))}}})).actions((function(e){return{}})),wi="",_i="",ki=1,Ci="#36B37E",Ni="#fff",Ti="white",Ri="black",Mi="red",Ai=2,zi="1px dashed #00aeff",Pi="default",Ii="pointer",Li="pointer",Hi="move",Ei="crosshair",Di=100,Wi=400,Ui=100,Bi=400,Xi=Qt.n.model({normInput:Qt.n.maybeNull(Qt.n.string),normalization:Qt.n.maybeNull(Qt.n.string)}).actions((function(e){return{setNormalization:function(t){e.normalization=t},deleteNormalization:function(){e.setNormalization("")},setNormInput:function(t){e.normInput=t}}})),Fi=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),score:Qt.n.maybeNull(Qt.n.number),readonly:Qt.n.optional(Qt.n.boolean,!1),hidden:Qt.n.optional(Qt.n.boolean,!1),selected:Qt.n.optional(Qt.n.boolean,!1),highlighted:Qt.n.optional(Qt.n.boolean,!1),parentID:Qt.n.optional(Qt.n.string,"")}).views((function(e){return{get perRegionStates(){var t=e.states;return t&&t.filter((function(e){return!0===e.perregion}))},get store(){return Object(Qt.g)(e)},get parent(){return Object(Qt.e)(e)},get completion(){return Object(Qt.g)(e).completionStore.selected},get editable(){return!1===e.readonly&&!0===e.completion.editable},get labelsState(){return e.states.find((function(e){return-1!==e.type.indexOf("labels")}))},hasLabelState:function(t){var n=e.labelsState;if(!n)return!1;var o=n.findLabel(t);return!(!o||!o.selected)}}})).actions((function(e){return{setParentID:function(t){e.parentID=t},moveTop:function(e){},moveBottom:function(e){},moveLeft:function(e){},moveRight:function(e){},sizeRight:function(e){},sizeLeft:function(e){},sizeTop:function(e){},sizeBottom:function(e){},rotatePoint:function(t,n){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.x,r=t.y;if(!n)return{x:a,y:r};n=(360+n)%360;var i=e.parent.stageWidth,l=e.parent.stageHeight;return 270===n?{x:r,y:(o?l:i)-a}:90===n?{x:(o?i:l)-r,y:a}:180===Math.abs(n)?{x:i-a,y:l-r}:{x:a,y:r}},rotateDimensions:function(e,t){var n=e.width,o=e.height;return(t+360)%180===0?{width:n,height:o}:{width:o,height:n}},updateAppearenceFromState:function(){},serialize:function(){console.error("Region class needs to implement serialize")},toStateJSON:function(){var t=e.parent,n=function(n){var o={id:e.pid,from_name:n.name,to_name:t.name,source:t.value,type:n.type,parent_id:""===e.parentID?null:e.parentID};return e.normalization&&(o.normalization=e.normalization),o};if(e.states&&e.states.length)return e.states.map((function(o){var a=e.serialize(o,t);return a?Object(f.a)(Object(f.a)({},n(o)),a):null})).filter(Boolean);var o=e.completion.toNames.get(t.name),a=o.length?o[0]:o;return Object(f.a)(Object(f.a)({},n(a)),e.serialize(a,t))},updateOrAddState:function(t){var n=e.states.findIndex((function(e){return e.name===t.name}));-1!==n?(e.states[n]=gn(t),e.updateAppearenceFromState()):e.states.push(gn(t))},updateSingleState:function(t){var n=e.states.findIndex((function(e){return e.name===t.name}));if(-1!==n){if(e.states[n]=gn(t),-1!==t.type.indexOf("labels")){var o=e.states.filter((function(e){return null!==e.whenlabelvalue&&void 0!==e.whenlabelvalue}));o&&o.forEach((function(t){return e.states.remove(t)}))}e.updateAppearenceFromState()}},selectRegion:function(){e.selected=!0,e.completion.setHighlightedNode(e),e.completion.loadRegionState(e)},unselectRegion:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.completion,o=e.parent,a=t&&e.store.settings.continuousLabeling;n.relationMode&&n.stopRelationMode(),o.setSelected&&o.setSelected(void 0),e.selected=!1,n.setHighlightedNode(null),e.afterUnselectRegion(),a||n.unloadRegionState(e)},afterUnselectRegion:function(){},onClickRegion:function(){var t=e.completion;t.editable&&(t.relationMode?(t.addRelation(e),t.stopRelationMode(),t.regionStore.unselectAll()):e.selected?e.unselectRegion(!0):(t.regionStore.unselectAll(),e.selectRegion()))},deleteRegion:function(){e.completion.editable&&(e.unselectRegion(),e.completion.relationStore.deleteNodeRelation(e),"polygonregion"===e.type&&e.destroyRegion(),e.completion.regionStore.deleteRegion(e),e.completion.deleteRegion(e))},setHighlight:function(t){e.highlighted=t},toggleHighlight:function(){e.setHighlight(!e.highlighted)},toggleHidden:function(){e.hidden=!e.hidden}}})),Yi=Fi,Vi=n(459),Ji=Qt.n.model({required:Qt.n.optional(Qt.n.boolean,!1),requiredmessage:Qt.n.maybeNull(Qt.n.string)}).actions((function(e){return{validate:function(){if(e.perregion)for(var t=e.completion.names.get(e.toname),n=0;n<t.regions.length;n++){var o=t.regions[n],a=o.states.find((function(t){return t.type===e.type}));if(e.whenlabelvalue&&!o.hasLabelState(e.whenlabelvalue))return!0;if(!a||0===a.selectedValues().length)return e.completion.regionStore.unselectAll(),o.selectRegion(),e.requiredModal(),!1}else if(0===e.selectedValues().length)return e.requiredModal(),!1;return!0}}})),Gi=Qt.n.model({perregion:Qt.n.optional(Qt.n.boolean,!1),whenlabelvalue:Qt.n.maybeNull(Qt.n.string)}).views((function(e){return{perRegionVisible:function(){if(!e.perregion)return!0;var t=e.completion.highlightedNode;return!!t&&(t.parent.name===e.toname&&(null===e.whenlabelvalue||void 0===e.whenlabelvalue||t.hasLabelState(e.whenlabelvalue)))}}})).actions((function(e){return{}}));function Ki(e){return function(t){return Qt.n.maybeNull(Qt.n.array(e(t)))}}function qi(e,t){return function(n){return Qt.n.union({dispatcher:function(o){if(n.find((function(e){return o.type===e})))return e(o.type);throw Error(t+o.type)}})}}var Zi=qi(cn.getModelByTag,"Not expecting tag: ");var $i={unionArray:function(e){return Qt.n.maybeNull(Qt.n.array(Zi(e)))},allModelsTypes:function(){var e=[{dispatcher:function(e){if(cn.tags.find((function(t){return e.type===t})))return cn.getModelByTag(e.type);throw Error("Not expecting tag: "+e.type)}},cn.modelsArr()],t=[].concat.apply([],e);return Qt.n.union.apply(null,t)},isType:function(e,t){var n,o=Object(Qt.i)(e),a=Object(an.a)(t);try{for(a.s();!(n=a.n()).done;){if(o===n.value)return!0}}catch(r){a.e(r)}finally{a.f()}return!1},getParentOfTypeString:function(e,t){var n=Object(Qt.e)(e);Array.isArray(t)||(t=[t]);for(var o=function(){var e=Object(Qt.i)(n).name;if(t.find((function(t){return t===e})))return{v:n};n=Object(Qt.e)(n)};n;){var a=o();if("object"===typeof a)return a.v}return null},tagsArray:Ki(Zi),toolsArray:Ki(qi(cn.getTool,"Not expecting tool: "))},Qi=(n(711),n(237)),el=n.n(Qi),tl=(n(712),["className"]),nl=(or.a.Paragraph,or.a.Text),ol=Object(rt.a)((function(e){var t=e.className,n=Object(yn.a)(e,tl);return Object(Z.jsx)(Xt.a,Object(f.a)(Object(f.a)({},n),{},{arrow:!0,classes:{popper:t}}))}))((function(e){var t,n=e.theme;return t={},Object(at.a)(t,"& .".concat(jo.a.arrow),{color:n.palette.common.black}),Object(at.a)(t,"& .".concat(jo.a.tooltip),{backgroundColor:n.palette.common.black}),t})),al=Qt.n.model("TextAreaRegionModel",{id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"textarearegion",_value:Qt.n.string}).views((function(e){return{get parent(){return Object(Qt.f)(e,ul)}}})).actions((function(e){return{setValue:function(t){e._value=t}}})),rl=Qt.n.compose("TextAreaRegionModel",Si,Yi,Xi,al),il=Object(en.b)("store")(Object(en.c)((function(e){e.store;var t=e.item,n=e.editTag,o=[el.a.mark],a=t.parent,r=t.completion.relationMode;r&&o.push(el.a.relation),t.selected?o.push(el.a.selected):t.highlighted&&o.push(el.a.highlighted),a.editable;return a.perregion||{onClick:t.onClickRegion,onMouseOver:function(){r&&t.setHighlight(!0)},onMouseOut:function(){r&&t.setHighlight(!1)}},Object(Z.jsxs)("div",{style:{display:"flex"},children:[Object(Z.jsx)(ol,{title:t._value.length>20?t._value:"",children:Object(Z.jsx)("div",{style:{width:"30%"},children:Object(Z.jsx)(nl,{style:{cursor:"pointer",backgroundColor:"#f6ffed",border:"solid 1px #b7eb8f",borderRadius:"5px",margin:0,padding:"0.7em 1em",direction:"rtl",width:"100%",overflow:"hidden",textOverflow:"ellipsis"},ellipsis:{tooltip:""},children:t._value})})}),Object(Z.jsx)(ol,{title:"\u0648\u06cc\u0631\u0627\u06cc\u0634",children:Object(Z.jsx)(A.a,{className:"edit-button",onClick:function(e){var o=t.completion.highlightedNode;return t.completion.deleteRegion(t),o&&o.updateSingleState(a),console.log(t._value),t.setValue(t._value),n(t),e.preventDefault(),!1},sx:{color:"#3f407d"},children:Object(Z.jsx)(yo.a,{icon:Oo.l})})}),Object(Z.jsx)(ol,{title:"\u062d\u0630\u0641",children:Object(Z.jsx)(A.a,{className:"delete-button",onClick:function(e){var n=t.completion.highlightedNode;return t.completion.deleteRegion(t),n&&n.updateSingleState(a),e.preventDefault(),!1},sx:{color:"red","&:after":{content:'""',position:"absolute",height:"50%",display:"block",left:0,width:"1px",bgcolor:"black"}},children:Object(Z.jsx)(yo.a,{icon:Oo.s})})})]})})));cn.addTag("textarearegion",rl,il);var ll=Qt.n.model({}).views((function(e){return{get serializableValue(){var t={};return e.selectedValues&&(t[e.type]=e.selectedValues()),t}}})).actions((function(e){return{}})),sl=Vi.a.TextArea,cl=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string),allowsubmit:Qt.n.optional(Qt.n.boolean,!0),label:Qt.n.optional(Qt.n.string,""),value:Qt.n.maybeNull(Qt.n.string),rows:Qt.n.optional(Qt.n.string,"1"),showsubmitbutton:Qt.n.optional(Qt.n.boolean,!1),placeholder:Qt.n.maybeNull(Qt.n.string),maxsubmissions:Qt.n.maybeNull(Qt.n.string),editable:Qt.n.optional(Qt.n.boolean,!1)}),dl=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),type:"textarea",regions:Qt.n.array(rl),_value:Qt.n.optional(Qt.n.string,""),children:$i.unionArray(["shortcut"])}).views((function(e){return{get holdsState(){return e.regions.length>0},get submissionsNum(){return e.regions.length},get completion(){return Object(Qt.g)(e).completionStore.selected},get showSubmit(){if(e.maxsubmissions){var t=parseInt(e.maxsubmissions);return e.submissionsNum<t}return!0},get serializableValue(){return e.regions.length?{text:e.selectedValues()}:null},selectedValues:function(){return e.regions.map((function(e){return e._value}))}}})).actions((function(e){return{getSerializableValue:function(){var t=e.regions.map((function(e){return e._value}));if(0!==t.length)return{text:t}},requiredModal:function(){Lr.warning(e.requiredmessage||'Input for the textarea "'.concat(e.name,'" is required.'))},setValue:function(t){e._value=t},copyState:function(t){e.regions=t.regions.map((function(e){return gn(e)}))},perRegionCleanup:function(){e.regions=[]},createRegion:function(t,n){var o=rl.create({pid:n,_value:t});return e.regions.push(o),o},addText:function(t,n){var o=e.createRegion(t,n);if(e.perregion){var a=e.completion.highlightedNode;a&&a.updateOrAddState(e)}else e.completion.addRegion(o);return o},beforeSend:function(){e._value&&e._value.length&&(e.addText(e._value),e._value="")},deleteText:function(e){Object(Qt.b)(e)},onShortcut:function(t){e.setValue(e._value+t)},toStateJSON:function(){if(e.regions.length){var t=e.toname||e.name;return{id:e.pid,from_name:e.name,to_name:t,type:"textarea",value:{text:e.regions.map((function(e){return e._value}))}}}},fromStateJSON:function(t,n){var o=t.value.text;Array.isArray(o)||(o=[o]),o.forEach((function(n){return e.addText(n,t.id)}))}}})),ul=Qt.n.compose("TextAreaModel",ll,cl,dl,fi,Ji,Gi),pl=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).editTag=function(e){o.setState({isEdit:!0,_value:e._value})},o.state={isEdit:!1,_value:null},o}return Object(b.a)(n,[{key:"render",value:function(){var e=this,t=this.props.item,n=parseInt(t.rows);this.state.isEdit&&(t.setValue(this.state._value),this.setState({isEdit:!1}));var o={name:t.name,value:t._value,rows:t.rows,className:"is-search",label:t.label,placeholder:t.placeholder,onChange:function(e){var n=e.target.value;t.setValue(n)}};t.completion.editable||(o.disabled=!0);var a=t.perRegionVisible()?{}:{display:"none"},r=t.completion.editable&&1!==n||t.showSubmitButton,i={};return r&&(i.marginBottom=0),a.marginTop="4px",Object(Z.jsxs)("div",{style:a,children:[vn.renderChildren(t),t.showSubmit&&Object(Z.jsx)(Eo.a,{onFinish:function(e){return t.allowsubmit&&t._value&&(t.addText(t._value),t.setValue("")),!1},children:Object(Z.jsxs)(Eo.a.Item,{style:i,children:[Object(Z.jsx)(sl,Object(f.a)({},o)),r&&Object(Z.jsx)(Eo.a.Item,{children:Object(Z.jsx)(z.a,{variant:"contained",startIcon:Object(Z.jsx)(yo.a,{icon:Oo.n}),sx:{direction:"ltr",marginTop:"10px"},type:"submit",size:"small",children:"\u0627\u0636\u0627\u0641\u0647\u200c\u06a9\u0631\u062f\u0646"})})]})}),t.regions.length>0&&Object(Z.jsx)("div",{style:{marginBottom:"1em"},children:t.regions.map((function(t){return Object(Z.jsx)(il,{item:t,editTag:function(t){e.editTag(t)}},t.id)}))})]})}}]),n}(d.Component),gl=Object(en.c)(pl);cn.addTag("textarea",ul,gl);var fl=Qt.n.model().views((function(e){return{get tiedChildren(){return vn.filterChildrenOfType(e,e._child)},get selectedLabels(){return e.tiedChildren.filter((function(e){return!0===e.selected}))},getSelectedColor:function(){var t=e.tiedChildren.find((function(e){return!0===e.selected}));return t&&t.background},get isSelected(){return e.selectedLabels.length>0},get holdsState(){return e.selectedLabels.length>0},selectedValues:function(){return e.selectedLabels.map((function(e){return e.alias?e.alias:e.value}))},getSelectedString:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ";return e.selectedValues().join(t)},findLabel:function(t){return e.tiedChildren.find((function(e){return e.alias===t||e.value===t}))}}})).actions((function(e){return{unselectAll:function(){e.tiedChildren.forEach((function(e){return e.setSelected(!1)}))},checkMaxUsages:function(){var t=e.tiedChildren.filter((function(e){return!e.canBeUsed()}));return t.length&&t.forEach((function(e){return e.setSelected(!1)})),t},selectFirstVisible:function(){var t=e.tiedChildren.find((function(e){return e.visible}));return t&&t.toggleSelected(),t}}})),hl=fl,bl=Qt.n.model({visiblewhen:Qt.n.maybeNull(Qt.n.string),whentagname:Qt.n.maybeNull(Qt.n.string),whenchoicevalue:Qt.n.maybeNull(Qt.n.string),whenlabelvalue:Qt.n.maybeNull(Qt.n.string)}).views((function(e){return{get isVisible(){if(e.visiblewhen){var t={"region-selected":function(t){var n=t.tagName,o=t.labelValue,a=e.completion.highlightedNode;return!(null===a||void 0===a||n&&a.parent.name!==n)&&(!o||o.split(",").some((function(e){return a.hasLabelState(e)})))},"choice-selected":function(t){var n=t.tagName,o=t.choiceValue;if(!n){var a,r=Object(an.a)(e.completion.names.values());try{for(r.s();!(a=r.n()).done;){var i=a.value;if("choices"===i.type&&i.selectedValues&&i.selectedValues().length)return!0}}catch(s){r.e(s)}finally{r.f()}return!1}var l=e.completion.names.get(n);return!!l&&(o?o.split(",").map((function(e){return l.findLabel(e)})).some((function(e){return e&&e.selected})):l.isSelected)},"no-region-selected":function(t){t.tagName;return null===e.completion.highlightedNode}};if(Object.keys(t).includes(e.visiblewhen))return!1!==t[e.visiblewhen]({tagName:e.whentagname,choiceValue:e.whenchoicevalue,labelValue:e.whenlabelvalue})}return!0}}})).actions((function(e){return{}})),ml=n(287),jl=Qt.n.model({selected:Qt.n.optional(Qt.n.boolean,!1),alias:Qt.n.maybeNull(Qt.n.string),value:Qt.n.maybeNull(Qt.n.string),hotkey:Qt.n.maybeNull(Qt.n.string),style:Qt.n.maybeNull(Qt.n.string)}),vl=Qt.n.model({type:"choice",visible:Qt.n.optional(Qt.n.boolean,!0),_value:Qt.n.optional(Qt.n.string,"")}).views((function(e){return{get isCheckbox(){var t=e.parent.choice;return"multiple"===t||"single"===t},get isSelect(){return console.log(e.parent.layout),"select"===e.parent.layout},get completion(){return Object(Qt.g)(e).completionStore.selected},get parent(){return Object(Qt.f)(e,kl)},canBeUsed:function(){return!0}}})).actions((function(e){return{toggleSelected:function(){var t=e.parent;t.shouldBeUnselected&&t.unselectAll(),e.setSelected(!e.selected);var n=e.completion.highlightedNode;n&&t.perregion&&n.parent.name===t.toname&&n.updateOrAddState(t)},setVisible:function(t){e.visible=t},setSelected:function(t){e.selected=t},onHotKey:function(){return e.toggleSelected()}}})),yl=Qt.n.compose("ChoiceModel",jl,vl,fi),Ol=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.store,o={};if(t.style&&(o=vn.cssConverter(t.style)),t.visible||(o.display="none"),t.isCheckbox){var a=Object.assign({display:"flex",alignItems:"center",marginBottom:0},o);return Object(Z.jsx)(Eo.a.Item,{style:a,children:Object(Z.jsxs)(sa.a,{disabled:t.parent.readonly,name:t._value,onChange:function(e){t.completion.editable&&(t.toggleSelected(),e.nativeEvent.target.blur())},checked:t.selected,children:[t._value,n.settings.enableTooltips&&n.settings.enableHotkeys&&t.hotkey&&Object(Z.jsxs)(Mo,{children:["[",t.hotkey,"]"]})]})})}return Object(Z.jsx)("div",{style:o,children:Object(Z.jsxs)(ml.a,{disabled:t.parent.readonly,value:t._value,style:{display:"inline-block",marginBottom:"0.5em"},checked:t.selected,onChange:function(e){t.completion.editable&&(t.toggleSelected(),e.nativeEvent.target.blur())},children:[t._value,(n.settings.enableTooltips||n.settings.enableLabelTooltips)&&n.settings.enableHotkeys&&t.hotkey&&Object(Z.jsxs)(Mo,{children:["[",t.hotkey,"]"]})]})})}}]),n}(d.Component),xl=Object(en.b)("store")(Object(en.c)(Ol));cn.addTag("choice",yl,xl);var Sl=pr.a.Option,wl=Qt.n.model({name:Qt.n.string,toname:Qt.n.maybeNull(Qt.n.string),showinline:Qt.n.maybeNull(Qt.n.boolean),choice:Qt.n.optional(Qt.n.enumeration(["single","single-radio","multiple"]),"single"),layout:Qt.n.optional(Qt.n.enumeration(["select","inline","vertical"]),"vertical")}),_l=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),readonly:Qt.n.optional(Qt.n.boolean,!1),visible:Qt.n.optional(Qt.n.boolean,!0),type:"choices",_type:"choices",children:$i.unionArray(["choice","view","header","hypertext"])}).views((function(e){return{get shouldBeUnselected(){return"single"===e.choice||"single-radio"===e.choice},get completion(){return Object(Qt.g)(e).completionStore.selected},states:function(){return e.completion.toNames.get(e.name)},get serializableValue(){var t=e.selectedValues();return t&&t.length?{choices:t}:null}}})).actions((function(e){return{afterCreate:function(){!0===e.showinline&&(e.layout="inline"),!1===e.showinline&&(e.layout="vertical")},requiredModal:function(){Lr.warning(e.requiredmessage||'Checkbox "'.concat(e.name,'" is required.'))},copyState:function(t){t.selectedValues().forEach((function(t){e.findLabel(t).setSelected(!0)}))},toStateJSON:function(){var t=e.selectedValues();if(t&&t.length){var n=e.toname||e.name;return{id:e.pid,from_name:e.name,to_name:n,type:e.type,value:{choices:t}}}},fromStateJSON:function(t,n){if(e.unselectAll(),!t.value.choices)throw new Error("No labels param");t.id&&(e.pid=t.id),e.readonly=t.readonly,t.value.choices.forEach((function(t){var n=e.findLabel(t);if(!n)throw new Error("No label "+t);n.setSelected(!0)}))}}})),kl=Qt.n.compose("ChoicesModel",ll,wl,_l,hl.props({_child:"ChoiceModel"}),Ji,Gi,bl),Cl=Object(en.c)((function(e){var t=e.item,n=t.perRegionVisible()?{}:{display:"none"};return!1===t.isVisible&&(t.unselectAll(),n.display="none"),Object(Z.jsx)("div",{style:Object(f.a)(Object(f.a)({},{marginTop:"1em",marginBottom:"1em"}),n),children:"select"===t.layout?Object(Z.jsx)(pr.a,{style:{width:"100%"},defaultValue:t.selectedLabels.map((function(e){return e._value})),mode:"multiple"===t.choice?"multiple":"",onChange:function(e,n){if(Array.isArray(e))t.unselectAll(),e.forEach((function(e){return t.findLabel(e).setSelected(!0)}));else{var o=t.findLabel(e);o&&o.toggleSelected()}},children:t.tiedChildren.map((function(e){return Object(Z.jsx)(Sl,{value:e._value,children:e._value},e._value)}))}):Object(Z.jsx)(Eo.a,{layout:t.layout,children:vn.renderChildren(t)})})}));cn.addTag("choices",kl,Cl);var Nl=Qt.n.model("LabelMixin").actions((function(e){return{beforeSend:function(){e.selectedValues()&&e.type===e._type&&e.unselectAll()},copyState:function(t){t.selectedValues().forEach((function(t){e.findLabel(t).setSelected(!0)}))},fromStateJSON:function(t,n){e.unselectAll();var o=t.value[e._type];o?(t.id&&(e.pid=t.id),o.forEach((function(t){var n=e.findLabel(t);n?n.setSelected(!0):Lr.error("Error with ".concat(e._type,". Not found: ")+o)}))):Lr.error("Error with ".concat(e._type,"."))}}})),Tl=n(453),Rl=n.n(Tl),Ml=(n(713),Qt.n.model({value:Qt.n.maybeNull(Qt.n.string),selected:Qt.n.optional(Qt.n.boolean,!1),maxusages:Qt.n.maybeNull(Qt.n.string),alias:Qt.n.maybeNull(Qt.n.string),hotkey:Qt.n.maybeNull(Qt.n.string),showalias:Qt.n.optional(Qt.n.boolean,!1),aliasstyle:Qt.n.optional(Qt.n.string,"opacity: 0.6"),size:Qt.n.optional(Qt.n.string,"medium"),background:Qt.n.optional(Qt.n.string,Ci),selectedcolor:Qt.n.optional(Qt.n.string,"white")})),Al=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),type:"label",visible:Qt.n.optional(Qt.n.boolean,!0),_value:Qt.n.optional(Qt.n.string,"")}).views((function(e){return{get completion(){return Object(Qt.g)(e).completionStore.selected},get maxUsages(){return Number(e.maxusages||e.parent.maxusages)},usedAlready:function(){return e.completion.regionStore.regions.reduce((function(t,n){return t+n.hasLabelState(e.value)}),0)},canBeUsed:function(){return!e.maxUsages||e.usedAlready()<e.maxUsages},get parent(){return $i.getParentOfTypeString(e,["LabelsModel","EllipseLabelsModel","RectangleLabelsModel","PolygonLabelsModel","KeyPointLabelsModel","BrushLabelsModel","HyperTextLabelsModel"])}}})).actions((function(e){return{toggleSelected:function(){var t=e.completion.highlightedNode;if((!t||!0!==t.readonly||t.parent.name!==e.parent.toname)&&e.completion.editable)if(e.selected||e.canBeUsed()){var n=e.parent;if(t){var o=n.selectedLabels;if(1===o.length&&o[0]._value===e._value)return}if(!n.selectedLabels.length&&!e.selected){e.completion.toNames.get(n.toname).filter((function(e){return e.type&&e.type.endsWith("labels")&&e.name!==n.name})).forEach((function(e){return e.unselectAll&&e.unselectAll()}));var a=Object.values(e.parent.tools||{})[0];a&&a.manager.findSelectedTool()!==a&&(a.manager.unselectAll(),a.setSelected(!0))}n.shouldBeUnselected||e.setSelected(!e.selected),n.shouldBeUnselected&&(e.selected?n.unselectAll():(n.unselectAll(),e.setSelected(!e.selected))),t&&t.updateSingleState(n)}else Lr.warning("You can't use ".concat(e.value," more than ").concat(e.maxUsages," time(s)"))},setVisible:function(t){e.visible=t},setSelected:function(t){e.selected=t},onHotKey:function(){return e.toggleSelected()},_updateBackgroundColor:function(t){e.background===Ci&&(e.background=Rl.a.make_color({seed:t})[0])},afterCreate:function(){e._updateBackgroundColor(e._value||e.value)},updateValue:function(t){e._value=gi(e.value,t.task.dataObj)||"",e._updateBackgroundColor(e._value)}}})),zl=Qt.n.compose("LabelModel",Ml,Al,fi),Pl=Object(en.b)("store")(Object(en.c)((function(e){var t=e.item,n=e.store,o=t.background,a={backgroundColor:t.selected?o:"#e8e8e8",color:t.selected?t.selectedcolor:"#333333",cursor:"pointer",margin:"5px"};return t.visible||(a.display="none"),Object(Z.jsxs)(ma.a,{onClick:function(e){return t.toggleSelected(),!1},style:a,size:t.size,icon:Object(Z.jsx)(yo.a,{icon:Oo.r}),className:"tag",children:[t._value,!0===t.showalias&&t.alias&&Object(Z.jsxs)("span",{style:ho.styleToProp(t.aliasstyle),children:["\xa0",t.alias]}),(n.settings.enableTooltips||n.settings.enableLabelTooltips)&&n.settings.enableHotkeys&&t.hotkey&&Object(Z.jsxs)(Mo,{children:["[",t.hotkey,"]"]})]})})));cn.addTag("label",zl,Pl);var Il=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string),choice:Qt.n.optional(Qt.n.enumeration(["single","multiple"]),"single"),maxusages:Qt.n.maybeNull(Qt.n.string),showinline:Qt.n.optional(Qt.n.boolean,!0)}),Ll=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"labels",children:$i.unionArray(["label","header","view","hypertext"]),visible:Qt.n.optional(Qt.n.boolean,!0)}),Hl=Nl.props({_type:"labels"}).views((function(e){return{get shouldBeUnselected(){return"single"===e.choice}}})).actions((function(e){return{validate:function(){var t,n=e.completion.regionStore.regions,o=Object(an.a)(n);try{for(o.s();!(t=o.n()).done;){var a,r=t.value,i=Object(an.a)(r.states);try{for(i.s();!(a=i.n()).done;){if(a.value.name===e.name)return!0}}catch(l){i.e(l)}finally{i.f()}}}catch(l){o.e(l)}finally{o.f()}return Lr.warning(e.requiredmessage||'Labels "'.concat(e.name,'" were not used.')),!1}}})),El=Qt.n.compose("LabelsModel",Ll,Il,Hl,Ji,hl.props({_child:"LabelModel"}),ll),Dl=Object(en.c)((function(e){var t=e.item,n={marginTop:"1em",marginBottom:"1em",display:"flex",justifyContent:"flex-start",alignItems:"center",flexFlow:"wrap",marginLeft:"-5px"};return t.showinline||(n.flexDirection="column",n.alignItems="flex-start",n.marginTop="0"),t.visible||(n.display="none"),Object(Z.jsx)("div",{style:n,children:vn.renderChildren(t)})}));cn.addTag("labels",El,Dl);var Wl=n(821),Ul=n(886),Bl=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string),maxrating:Qt.n.optional(Qt.n.string,"5"),icon:Qt.n.optional(Qt.n.string,"star"),size:Qt.n.optional(Qt.n.string,"medium"),defaultvalue:Qt.n.optional(Qt.n.string,"0"),hotkey:Qt.n.maybeNull(Qt.n.string)}),Xl=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"rating",rating:Qt.n.maybeNull(Qt.n.number)}).views((function(e){return{get completion(){return Object(Qt.g)(e).completionStore.selected},selectedValues:function(){return e.holdsState?e.rating:null},get serializableValue(){var t=e.selectedValues();return t?{rating:t}:null},get holdsState(){return e.rating>0}}})).actions((function(e){return{getSelectedString:function(){return e.rating+" star"},copyState:function(t){e.setRating(t.rating)},unselectAll:function(){e.rating=0},setRating:function(t){if(e.rating=t,e.perregion){var n=e.completion.highlightedNode;n&&n.updateOrAddState(e)}},increaseValue:function(){e.rating>=Number(e.maxrating)?e.setRating(0):e.rating>0?e.setRating(e.rating+1):e.setRating(1)},onHotKey:function(){return e.increaseValue()},toStateJSON:function(){if(e.rating){var t=e.toname||e.name;return{id:e.pid,from_name:e.name,to_name:t,type:e.type,value:{rating:e.rating}}}},fromStateJSON:function(t,n){t.id&&(e.pid=t.id),e.rating=t.value.rating}}})),Fl=Qt.n.compose("RatingModel",ll,Bl,Xl,Ji,Gi),Yl=Object(en.b)("store")(Object(en.c)((function(e){var t,n=e.item,o=e.store;"small"===n.size?t=15:"medium"===n.size?t=25:"large"===n.size&&(t=40);var a=n.perRegionVisible()?{}:{display:"none"};return Object(Z.jsxs)("div",{style:a,children:[Object(Z.jsx)(Wl.a,{character:Object(Z.jsx)(Ul.a,{style:{fontSize:t}}),value:n.rating,count:Number(n.maxrating),defaultValue:Number(n.defaultvalue),onChange:n.setRating}),o.settings.enableTooltips&&o.settings.enableHotkeys&&n.hotkey&&Object(Z.jsxs)("sup",{style:{fontSize:"9px"},children:["[",n.hotkey,"]"]})]})})));cn.addTag("rating",Fl,Yl);var Vl=Qt.n.model("AudioRegionModel",{id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"audioregion",start:Qt.n.number,end:Qt.n.number,states:Qt.n.maybeNull(Qt.n.array(Qt.n.union(El,ul,kl,Fl))),selectedregionbg:Qt.n.optional(Qt.n.string,"rgba(0, 0, 0, 0.5)")}).views((function(e){return{get parent(){return Object(Qt.f)(e,ql)},wsRegionElement:function(e){var t=e.id,n=Array.from(document.querySelectorAll('[data-id="'.concat(t,'"]')));return n&&n.length&&(n=n[0]),n}}})).actions((function(e){return{serialize:function(t,n){var o={original_length:n._ws.getDuration(),value:{start:e.start,end:e.end}};return o.value=Object.assign(o.value,t.serializableValue),o},updateAppearenceFromState:function(){var t=e.labelsState;t&&(e.selectedregionbg=ho.Colors.convertToRGBA(t.getSelectedColor(),.3),e._ws_region.update&&(e.applyCSSClass(e._ws_region),e._ws_region.update({color:ho.Colors.rgbaChangeAlpha(e.selectedregionbg,.8)})))},applyCSSClass:function(t){var n=e.wsRegionElement(t),o=Object(Qt.g)(e).settings,a=ho.Checkers.flatten(e.states.filter((function(e){return"labels"===e._type})).map((function(e){return e.selectedValues()}))),r=ho.HTML.labelWithCSS(n,{labels:a,score:e.score}),i=[n.className,"htx-highlight","htx-highlight-last",r];e.parent.showlabels||o.showLabels||i.push("htx-no-label"),n.className=i.filter((function(e){return e})).join(" ")},selectRegion:function(){e.selected=!0,e.completion.setHighlightedNode(e),e._ws_region.update({color:ho.Colors.rgbaChangeAlpha(e.selectedregionbg,.8)}),e.completion.loadRegionState(e);var t=e.wsRegionElement(e._ws_region);if(t){var n=window.document.scrollingElement,o=n.scrollTop,a=n.scrollLeft;t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded():t.scrollIntoView(),window.document.scrollingElement.scrollTo(a,o)}},afterUnselectRegion:function(){e._ws_region.update&&e._ws_region.update({color:e.selectedregionbg})},setHighlight:function(t){e.highlighted=t,t?(e._ws_region.update({color:ho.Colors.rgbaChangeAlpha(e.selectedregionbg,.8)}),e._ws_region.element.style.border=zi):(e._ws_region.update({color:e.selectedregionbg}),e._ws_region.element.style.border="none")},beforeDestroy:function(){e._ws_region&&e._ws_region.remove()},onClick:function(t){e.completion.relationMode||e._ws_region.update({color:ho.Colors.rgbaChangeAlpha(e.selectedregionbg,.8)}),e.onClickRegion()},onMouseOver:function(){e.completion.relationMode&&(e.setHighlight(!0),e._ws_region.element.style.cursor=Ei)},onMouseLeave:function(){e.completion.relationMode&&(e.setHighlight(!1),e._ws_region.element.style.cursor=Hi)},onUpdateEnd:function(t){e.start=e._ws_region.start,e.end=e._ws_region.end}}})),Jl=Qt.n.compose("AudioRegionModel",Si,Yi,Xi,Vl),Gl=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),value:Qt.n.maybeNull(Qt.n.string),zoom:Qt.n.optional(Qt.n.boolean,!0),volume:Qt.n.optional(Qt.n.boolean,!0),speed:Qt.n.optional(Qt.n.boolean,!0),regs:Qt.n.optional(Qt.n.boolean,!0),hotkey:Qt.n.maybeNull(Qt.n.string),showlabels:Qt.n.optional(Qt.n.boolean,!1),showscores:Qt.n.optional(Qt.n.boolean,!1),height:Qt.n.optional(Qt.n.string,"128")}),Kl=Qt.n.model("AudioPlusModel",{id:Qt.n.identifier,type:"audio",_value:Qt.n.optional(Qt.n.string,""),playing:Qt.n.optional(Qt.n.boolean,!1),regions:Qt.n.array(Jl)}).views((function(e){return{get hasStates(){var t=e.states();return t&&t.length>0},get completion(){return Object(Qt.g)(e).completionStore.selected},states:function(){return e.completion.toNames.get(e.name)},activeStates:function(){var t=e.states();return t&&t.filter((function(e){return"LabelsModel"===Object(Qt.i)(e).name&&e.isSelected}))}}})).actions((function(e){return{onHotKey:function(t){return t&&t.preventDefault(),e._ws.playPause()},fromStateJSON:function(t,n){var o,a,r=e.completion.names.get(t.from_name);if(r.fromStateJSON(t),r.perregion||"labels"===n.type){var i={pid:t.id,start:t.value.start,end:t.value.end,normalization:t.normalization,score:t.score,readonly:t.readonly};return o=e.findRegion({start:t.value.start,end:t.value.end}),n&&(a=fn(n),o?o.states.push(a):o=e.createRegion(i,[a])),e._ws&&e._ws.addRegion({start:o.start,end:o.end}),o.updateAppearenceFromState(),o}},setRangeValue:function(t){e.rangeValue=t},setPlaybackRate:function(t){e.playBackRate=t},createRegion:function(t,n){var o=e.selectedregionbg,a=n.find((function(e){return"labels"===e.type}));a&&(o=ho.Colors.convertToRGBA(a.getSelectedColor(),.3));var r=Jl.create({id:t.id?t.id:pn(),pid:t.pid?t.pid:pn(),parentID:null===t.parent_id?"":t.parent_id,start:t.start,end:t.end,score:t.score,readonly:t.readonly,regionbg:e.regionbg,selectedregionbg:o,normalization:t.normalization,states:n});return r._ws_region=t,e.regions.push(r),e.completion.addRegion(r),r},addRegion:function(t){var n=e.findRegion({start:t.start,end:t.end});if(n)return n.applyCSSClass(t),n._ws_region=t,n;var o=e.getAvailableStates();if(0!==o.length){var a=e.createRegion(t,o.map((function(e){return gn(e)})));return a.applyCSSClass(t),a}t.remove&&t.remove()},handlePlay:function(){e.playing=!e.playing},onLoad:function(t){e._ws=t,e.regions.forEach((function(t){var n={};t.readonly&&(n={drag:!1,resize:!1}),e._ws.addRegion(Object(f.a)({start:t.start,end:t.end},n))}))},wsCreated:function(t){e._ws=t}}})),ql=Qt.n.compose("AudioPlusModel",Gl,Kl,fi,Er),Zl=Object(en.c)((function(e){var t=e.store,n=e.item;return n._value?Object(Z.jsx)(Wr,{item:n,children:Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)(di,{src:n._value,selectRegion:n.selectRegion,handlePlay:n.handlePlay,onCreate:n.wsCreated,addRegion:n.addRegion,onLoad:n.onLoad,speed:n.speed,zoom:n.zoom,volume:n.volume,regions:n.regs,height:n.height,store:t,item:n}),Object(Z.jsx)("div",{style:{marginBottom:"4px"}})]})}):null})),$l=Object(en.b)("store")(Object(en.c)(Zl));cn.addTag("audioplus",ql,$l);var Ql=n(229),es=Qt.n.model().views((function(e){return{}})).actions((function(e){return{updateSpansColor:function(t,n){e._spans&&e._spans.forEach((function(e){t&&(e.style.backgroundColor=t),n&&(e.style.backgroundColor=ho.Colors.rgbaChangeAlpha(e.style.backgroundColor,n))}))},updateAppearenceFromState:function(){var t=e.getLabelColor();e.updateSpansColor(t),e.applyCSSClass(e._lastSpan)},createSpans:function(){var t=e.getLabelColor(),n=so(e,"htx-highlight",{backgroundColor:t}),o=n[n.length-1];if(o)return e.applyCSSClass(o),e._lastSpan=o,e._spans=n,n},getLabelColor:function(){var t=e.parent.highlightcolor;if(!t){var n=e.states.find((function(e){return e._type&&-1!==e._type.indexOf("labels")}));n&&(t=n.getSelectedColor())}return t&&(t=ho.Colors.convertToRGBA(t,.3)),t},applyCSSClass:function(t){var n=Object(Qt.g)(e).settings,o=ho.Checkers.flatten(e.states.filter((function(e){return e._type&&-1!==e._type.indexOf("labels")})).map((function(e){return e.selectedValues()}))),a=["htx-highlight","htx-highlight-last",ho.HTML.labelWithCSS(t,{labels:o,score:e.score})];e.parent.showlabels||n.showLabels||a.push("htx-no-label"),t.className=a.filter((function(e){return e})).join(" ")},addEventsToSpans:function(t){t&&t.forEach((function(t){return function(t){return t.onmouseover=function(n){e.completion.relationMode?(e.toggleHighlight(),t.style.cursor=Ei,n.stopPropagation()):t.style.cursor=Li},t.onmouseout=function(){e.setHighlight(!1)},t.onmousedown=function(t){e.parent._currentSpan!==this&&(t.stopPropagation(),e.parent._currentSpan=this)},t.onclick=function(n){e.parent._currentSpan===this&&(t.style.cursor=Li,e.onClickRegion())},!1}(t)}))},selectRegion:function(){e.selected=!0,e.completion.setHighlightedNode(e),e.updateSpansColor(null,.8),e.completion.loadRegionState(e);var t=e._spans[0];t&&(t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded():t.scrollIntoView({block:"center",behavior:"smooth"}))},afterUnselectRegion:function(){e.updateSpansColor(null,.3)},setHighlight:function(t){if(e.highlighted=t,e._spans){var n=e._spans.length,o=e._spans[0],a=e._spans[n-1],r=e._spans.slice(1,n-1),i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.top,a=void 0===o||o,r=n.bottom,i=void 0===r||r,l=n.right,s=void 0===l||l,c=n.left,d=void 0===c||c;s&&(e.style.borderRight=t),d&&(e.style.borderLeft=t),a&&(e.style.borderTop=t),i&&(e.style.borderBottom=t)};if(e.highlighted){var l=zi;i(o,l,{right:!1}),i(a,l,{left:!1}),r.length&&r.forEach((function(e){return i(e,l,{left:!1,right:!1})}))}else{var s="0px";i(o,s),i(a,s),r.length&&r.forEach((function(e){return i(e,s,{left:!1,right:!1})}))}}}}})),ts=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string)}),ns=Qt.n.model("HyperTextLabelesModel",{id:Qt.n.identifier,pid:Qt.n.optional(Qt.n.string,pn),type:"htmllabels",children:$i.unionArray(["label","header","view","hypertext"])}).views((function(e){return{get hasStates(){var t=e.states();return t&&t.length>0},get serializableValue(){var t={};return t.htmllabels=e.selectedValues(),t}}})),os=Nl.props({_type:"htmllabels"}),as=Qt.n.compose(ll,El,ns,ts,os,hl.props({_child:"LabelModel"})),rs=Qt.n.compose("HyperTextLabelsModel",as),is=Object(en.c)((function(e){var t=e.item;return Object(Z.jsx)(Dl,{item:t})}));cn.addTag("hypertextlabels",rs,is);var ls=Qt.n.model("HyperTextRegionModel",{id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"hypertextregion",startOffset:Qt.n.integer,start:Qt.n.string,endOffset:Qt.n.integer,end:Qt.n.string,text:Qt.n.string,states:Qt.n.maybeNull(Qt.n.array(Qt.n.union(rs,ul,kl,Fl)))}).views((function(e){return{get parent(){return Object(Qt.f)(e,us)}}})).actions((function(e){return{beforeDestroy:function(){ho.HTML.removeSpans(e._spans)},serialize:function(t,n){var o={value:{start:e.start,end:e.end,text:e.text,startOffset:e.startOffset,endOffset:e.endOffset}};return o.value=Object.assign(o.value,t.serializableValue),o}}})),ss=Qt.n.compose("HyperTextRegionModel",Si,Yi,Xi,ls,es),cs=Qt.n.model("HyperTextModel",{name:Qt.n.maybeNull(Qt.n.string),value:Qt.n.maybeNull(Qt.n.string),highlightcolor:Qt.n.maybeNull(Qt.n.string),showlabels:Qt.n.optional(Qt.n.boolean,!1),encoding:Qt.n.optional(Qt.n.enumeration(["none","base64","base64unicode"]),"none")}),ds=Qt.n.model("HyperTextModel",{id:Qt.n.optional(Qt.n.identifier,pn),type:"hypertext",regions:Qt.n.array(ss),_value:Qt.n.optional(Qt.n.string,""),_update:Qt.n.optional(Qt.n.number,1)}).views((function(e){return{get hasStates(){var t=e.states();return t&&t.length>0},get completion(){return Object(Qt.g)(e).completionStore.selected},states:function(){return e.completion.toNames.get(e.name)},activeStates:function(){var t=e.states();return t?t.filter((function(e){return e.isSelected&&("HyperTextLabelsModel"===Object(Qt.i)(e).name||"RatingModel"===Object(Qt.i)(e).name)})):null}}})).actions((function(e){return{needsUpdate:function(){e._update=e._update+1},updateValue:function(t){e._value=gi(e.value,t.task.dataObj)},createRegion:function(t){var n=ss.create(Object(f.a)({pid:t.id},t));return n._range=t._range,e.regions.push(n),e.completion.addRegion(n),n},addRegion:function(t){var n=e.getAvailableStates();if(0!==n.length){var o=n.map((function(e){return gn(e)}));return e.createRegion(Object(f.a)(Object(f.a)({},t),{},{states:o}))}},fromStateJSON:function(t,n){var o=t.value,a=o.start,r=o.startOffset,i=o.end,l=o.endOffset,s=o.text;if("textarea"!==n.type&&"choices"!==n.type){var c=fn(n),d={pid:t.id,parentID:null===t.parent_id?"":t.parent_id,startOffset:r,endOffset:l,start:a,end:i,text:s,score:t.score,readonly:t.readonly,normalization:t.normalization,states:[c]};c.fromStateJSON(t),e.createRegion(d),e.needsUpdate()}else e.completion.names.get(t.from_name).fromStateJSON(t)}}})),us=Qt.n.compose("HyperTextModel",Yi,cs,ds,Er),ps=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.store;return t._value?Object(Z.jsx)(hs,{store:n,item:t}):null}}]),n}(d.Component),gs=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).myRef=u.a.createRef(),o}return Object(b.a)(n,[{key:"captureDocumentSelection",value:function(){var e,t=[],n=[],o=window.getSelection();if(o.isCollapsed)return[];for(e=0;e<o.rangeCount;e++){var a=o.getRangeAt(e);"DIV"===a.endContainer.nodeName&&a.setEnd(a.startContainer,a.startContainer.length);try{var r=Ql.fromRange(a,this.myRef.current);co(a),r._range=a,r.text=o.toString(),null===r?n.push(a):t.push(r)}catch(i){}}return o.removeAllRanges(),t}},{key:"onMouseUp",value:function(e){var t=this.props.item,n=t.activeStates();if(n&&0!==n.length){var o=this.captureDocumentSelection();if(0!==o.length){t._currentSpan=null;var a=t.addRegion(o[0]);if(a){var r=a.createSpans();a.addEventsToSpans(r)}}}}},{key:"_handleUpdate",value:function(){var e=this.myRef.current;this.props.item.regions.forEach((function(t){try{var n=Ql.toRange(t.start,t.startOffset,t.end,t.endOffset,e);co(n),t._range=n;var o=t.createSpans();t.addEventsToSpans(o)}catch(a){console.log(t)}})),Array.from(this.myRef.current.getElementsByTagName("a")).forEach((function(e){e.addEventListener("click",(function(e){return e.preventDefault(),!1}))}))}},{key:"componentDidUpdate",value:function(){this._handleUpdate()}},{key:"componentDidMount",value:function(){this._handleUpdate()}},{key:"render",value:function(){var e=this.props,t=e.item,n=e.store,o=gi(t.value,n.task.dataObj);return"base64"===t.encoding&&(o=atob(o)),"base64unicode"===t.encoding&&(o=ho.Checkers.atobUnicode(o)),Object(Z.jsx)(Wr,{item:t,children:Object(Z.jsx)("div",{ref:this.myRef,"data-update":t._update,style:{overflow:"auto"},onMouseUp:this.onMouseUp.bind(this),dangerouslySetInnerHTML:{__html:o}})})}}]),n}(d.Component),fs=Object(en.b)("store")(Object(en.c)(ps)),hs=Object(en.b)("store")(Object(en.c)(gs));cn.addTag("hypertext",us,fs);var bs=n(57),ms=Qt.n.model("BaseTool",{}).actions((function(e){return{}})),js=3,vs=3,ys=ms,Os=n(170),xs=n.n(Os),Ss=Object(en.c)(function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)(oi.a,{defaultValue:this.props.default||15,max:this.props.max||50,min:0,vertical:!0,tipFormatter:null,style:{height:this.props.height||100},onChange:this.props.onChange}),Object(Z.jsx)(qo.a,{title:this.props.title,placement:"left",children:Object(Z.jsx)(Ho.a,{shape:"circle",type:this.props.selected?"primary":"default",className:xs.a.button,onClick:this.props.onClick,children:this.props.icon})})]})}}]),n}(d.Component)),ws=Qt.n.model({selected:Qt.n.optional(Qt.n.boolean,!1)}).views((function(e){return{get obj(){return e._manager.obj},get manager(){return e._manager},get control(){return e._control},get completion(){return Object(Qt.g)(e.control).completionStore.selected},get viewClass(){return null},get clonedStates(){var t=[e.control],n=t?t.filter((function(e){return e.isSelected})):null;return n?n.map((function(e){return gn(e)})):null},moreRegionParams:function(e){},paramsFromStates:function(t){var n=e.control,o=n.fillcolor,a=n.strokecolor;if(t&&t.length){var r=t.find((function(e){return e&&e.hasOwnProperty("getSelectedColor")}));if(r){var i=r.getSelectedColor();o=i,a=i}}return{fillColor:o,strokeColor:a}},get statesAndParams(){var t=e.clonedStates,n=e.paramsFromStates(t);return Object(f.a)({states:t},n)},get getActiveShape(){var t=e.obj;return t.regions[t.regions.length-1]},get getSelectedShape(){return e.control.completion.highlightedNode}}})).actions((function(e){return{setSelected:function(t){e.selected=t},event:function(t,n,o){var a=t+"Ev";"undefined"!==typeof e[a]&&e[a].call(e,n,o)},createFromJSON:function(t,n){var o,a=[],r=e.completion.names.get(t.from_name);if(r.fromStateJSON(t),!r.perregion||"textarea"!==n.type){var i=e.tagTypes,l=i.stateTypes,s=i.controlTagTypes;if(r.perregion||s.includes(n.type)){if(t.type===l&&((a=fn(n)).fromStateJSON&&a.fromStateJSON(t),a=[a]),s.includes(t.type)){var c=e.paramsFromStates(a),d=e.moreRegionParams(t),u=Object(f.a)(Object(f.a)(Object(f.a)({pid:t.id,parentID:null===t.parent_id?"":t.parent_id,score:t.score,readonly:t.readonly,coordstype:"perc",states:a},c),t.value),d);o=e.createRegion(u)}else if(r.perregion){var p=fn(n);(o=e.obj.regions.find((function(e){return e.pid===t.id})))&&o.states.push(p)}return o}}},fromStateJSON:function(t,n){if(e.tagTypes)return e.createFromJSON(t,n)}}})),_s=n(42),ks=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string),strokewidth:Qt.n.optional(Qt.n.string,"15")}),Cs=Qt.n.model({id:Qt.n.identifier,type:"brush"}).views((function(e){return{get hasStates(){var t=e.states();return t&&t.length>0},get completion(){return Object(Qt.g)(e).completionStore.selected}}})).actions((function(e){return{afterCreate:function(){var t=qs.create(),n=tc.create();t._control=e,n._control=e,e.tools={brush:t,erase:n}}}})),Ns=Qt.n.compose("BrushModel",ks,Cs,ll);cn.addTag("brush",Ns,(function(){return null}));var Ts=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string)}),Rs=Qt.n.model("BrushLabelsModel",{id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"brushlabels",children:$i.unionArray(["label","header","view","hypertext"])}),Ms=Nl.props({_type:"brushlabels"}),As=Qt.n.compose("BrushLabelsModel",El,Rs,Ns,Ts,Ms,hl.props({_child:"LabelModel"}),ll),zs=Object(en.c)((function(e){var t=e.item;return Object(Z.jsx)(Dl,{item:t})}));function Ps(e){var t=[],n=[];return e.forEach((function(e){t.push(e.x),n.push(e.y)})),[[Math.min.apply(null,t),Math.max.apply(null,t)],[Math.min.apply(null,n),Math.max.apply(null,n)]]}cn.addTag("brushlabels",As,zs);var Is=function(e){var t=e.x,n=e.y,o=e.text,a=e.score,r=e.showLabels,i=e.showScore&&a,l=1/(e.zoomScale||1);return Object(Z.jsxs)(_s.Group,{strokeScaleEnabled:!1,opacity:.8,children:[i&&Object(Z.jsxs)(_s.Label,{x:t,y:n-20*l,scaleX:l,scaleY:l,children:[Object(Z.jsx)(_s.Tag,{fill:ho.Colors.getScaleGradient(a),cornerRadius:2}),Object(Z.jsx)(_s.Text,{text:a.toFixed(2),fontFamily:"Calibri",fill:"white",padding:2})]}),r&&Object(Z.jsxs)(_s.Label,{x:i?t+34*l:t,y:n-20*l,scaleX:l,scaleY:l,children:[Object(Z.jsx)(_s.Tag,{fill:Ri,cornerRadius:2}),Object(Z.jsx)(_s.Text,{text:o,fontFamily:"Calibri",fill:Ti,padding:2})]})]})},Ls=Object(en.c)((function(e){var t=e.item,n=t.states.find((function(e){return"ellipselabels"===e.type}));return n&&n.holdsState?Object(Z.jsx)(Is,{x:t.x,y:t.y,text:n.getSelectedString(","),score:t.score,showLabels:Object(Qt.g)(t).settings.showLabels,showScore:Object(Qt.g)(t).settings.showLabels,zoomScale:t.parent.zoomScale}):null})),Hs=Object(en.c)((function(e){var t=e.item,n=t.states.find((function(e){return"rectanglelabels"===e.type}));return n&&n.holdsState?Object(Z.jsx)(Is,{x:t.x,y:t.y,text:n.getSelectedString(","),score:t.score,showLabels:Object(Qt.g)(t).settings.showLabels,showScore:Object(Qt.g)(t).settings.showLabels,zoomScale:t.parent.zoomScale}):null})),Es=Object(en.c)((function(e){var t=e.item,n=t.states.find((function(e){return"polygonlabels"===e.type}));if(!n||!n.holdsState)return null;var o=Ps(t.points),a=Object(Qt.g)(t).settings;return Object(Z.jsxs)(d.Fragment,{children:[a&&(a.showLabels||a.showScore)&&Object(Z.jsx)(_s.Rect,{x:o[0][0],y:o[1][0],fillEnabled:!1,width:o[0][1]-o[0][0],height:o[1][1]-o[1][0],stroke:t.strokeColor,strokeWidth:1,strokeScaleEnabled:!1,shadowBlur:0}),Object(Z.jsx)(Is,{x:o[0][0],y:o[1][0]+2/t.parent.zoomScale,text:n.getSelectedString(","),score:t.score,showLabels:a&&a.showLabels,showScore:a&&a.showScore,zoomScale:t.parent.zoomScale})]})})),Ds=Object(en.c)((function(e){var t=e.item,n=t.states.find((function(e){return"brushlabels"===e.type}));if(!n||!n.holdsState)return null;if(0===t.touches.length)return null;var o=Ps(t.touches),a=Object(Qt.g)(t).settings;return Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)(_s.Rect,{x:o[0][0],y:o[1][0],fillEnabled:!1,width:o[0][1]-o[0][0],height:o[1][1]-o[1][0],stroke:t.strokeColor,strokeWidth:1,strokeScaleEnabled:!1,shadowBlur:0}),Object(Z.jsx)(Is,{x:o[0][0],y:o[1][0]+2/t.parent.zoomScale,text:n.getSelectedString(","),score:t.score,showLabels:Object(Qt.g)(t).settings.showLabels,showScore:a&&a.showScore,zoomScale:t.parent.zoomScale})]})})),Ws=Object(en.c)((function(e){var t=e.item,n=t.states.find((function(e){return"keypointlabels"===e.type}));return n&&n.holdsState?Object(Z.jsx)(Is,{x:t.x+(t.width+2)/t.parent.zoomScale,y:t.y+(t.width+2)/t.parent.zoomScale,text:n.getSelectedString(","),score:t.score,showLabels:Object(Qt.g)(t).settings.showLabels,showScore:Object(Qt.g)(t).settings.showScore,zoomScale:t.parent.zoomScale}):null})),Us=Qt.n.model("Points",{id:Qt.n.optional(Qt.n.identifier,pn),type:Qt.n.optional(Qt.n.enumeration(["add","eraser"]),"add"),points:Qt.n.array(Qt.n.number),strokeWidth:Qt.n.optional(Qt.n.number,25)}).actions((function(e){return{setType:function(t){e.type=t},addPoints:function(t,n){e.points.push(t),e.points.push(n)},rescale:function(t,n,o,a){var r=o/t;return e.points.map((function(e){return e*r}))},scaledStrokeWidth:function(t,n,o,a){return o/t*e.strokeWidth}}})),Bs=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"brushregion",states:Qt.n.maybeNull(Qt.n.array(Qt.n.union(As,ul,kl,Fl))),coordstype:Qt.n.optional(Qt.n.enumeration(["px","perc"]),"px"),tension:Qt.n.optional(Qt.n.number,1),strokeColor:Qt.n.optional(Qt.n.string,"red"),opacity:Qt.n.optional(Qt.n.number,1),scaleX:Qt.n.optional(Qt.n.number,1),scaleY:Qt.n.optional(Qt.n.number,1),touches:Qt.n.array(Us),currentTouch:Qt.n.maybeNull(Qt.n.reference(Us)),mode:Qt.n.optional(Qt.n.string,"brush"),needsUpdate:Qt.n.optional(Qt.n.number,1)}).views((function(e){return{get parent(){return Object(Qt.f)(e,Gd)}}})).actions((function(e){return{afterCreate:function(){},addTouch:function(t){var n=t.type,o=t.strokeWidth,a=Us.create({id:pn(),type:n,strokeWidth:o});return e.touches.push(a),e.currentTouch=a,a},afterAttach:function(){},selectRegion:function(){e.selected=!0,e.completion.setHighlightedNode(e),e.parent.setSelected(e.id),e.completion.loadRegionState(e)},convertPointsToMask:function(){},updateAppearenceFromState:function(){var t=e.states[0].getSelectedColor();e.strokeColor=t},setScale:function(t,n){e.scaleX=t,e.scaleY=n},updateImageSize:function(t,n,o,a){if(e.parent.initialWidth>1&&e.parent.initialHeight>1){var r=e.parent.stageWidth/e.parent.initialWidth,i=e.parent.stageHeight/e.parent.initialHeight;e.setScale(r,i),e.needsUpdate=e.needsUpdate+1}},addState:function(t){e.states.push(t)},serialize:function(t,n){var o=$n.Region2RLE(e,n,{stroke:e.strokeColor,tension:e.tension}),a={original_width:n.naturalWidth,original_height:n.naturalHeight,value:{format:"rle",rle:Array.prototype.slice.call(o)}};return a.value=Object.assign(a.value,t.serializableValue),a}}})),Xs=Qt.n.compose("BrushRegionModel",Si,Yi,Xi,Bs),Fs=Object(en.c)((function(e){e.store;var t=e.item,n=e.points,o=[];return n.points.forEach((function(e){o.push(e)})),"add"===n.type?Object(Z.jsx)(Ys,{item:t,points:o,strokeWidth:n.strokeWidth}):Object(Z.jsx)(Vs,{item:t,points:o,strokeWidth:n.strokeWidth})})),Ys=Object(en.c)((function(e){e.store;var t=e.item,n=e.points,o=e.strokeWidth,a=t.highlighted?{shadowColor:"red",shadowBlur:1,shadowOffsetY:2,shadowOffsetX:2,shadowOpacity:1}:{shadowOpacity:0};return Object(Z.jsx)(_s.Line,Object(f.a)({onMouseDown:function(e){e.cancelBubble=!1},strokeWidth:o,points:n,stroke:t.strokeColor,opacity:"brush"===t.mode?t.opacity:1,globalCompositeOperation:"source-over",tension:t.tension,lineJoin:"round",lineCap:"round"},a))})),Vs=function(e){e.store;var t=e.item,n=e.points,o=e.strokeWidth;return Object(Z.jsx)(_s.Line,{onMouseDown:function(e){e.cancelBubble=!1},strokeWidth:o,points:n,tension:t.tension,lineJoin:"round",lineCap:"round",stroke:t.strokeColor,opacity:1,globalCompositeOperation:"destination-out"})},Js=Object(en.b)("store")(Object(en.c)((function(e){var t=e.store,n=e.item,o=n.highlighted?{shadowColor:"red",shadowBlur:1,shadowOffsetY:2,shadowOffsetX:2,shadowOpacity:1}:{shadowOpacity:0};return Object(Z.jsx)(d.Fragment,{children:Object(Z.jsxs)(_s.Group,{attrMy:n.needsUpdate,name:"segmentation",scaleX:n.scaleX,scaleY:n.scaleY,onMouseOver:function(e){var o=n.parent.stageRef;t.completionStore.selected.relationMode?(n.setHighlight(!0),o.container().style.cursor="crosshair"):n.parent.getToolsManager().findSelectedTool()||(o.container().style.cursor="pointer")},onMouseOut:function(e){(t.completionStore.selected.relationMode&&n.setHighlight(!1),n.parent.getToolsManager().findSelectedTool())||(n.parent.stageRef.container().style.cursor="default")},onClick:function(e){if(!n.parent.getToolsManager().findSelectedTool()){var o=n.parent.stageRef;t.completionStore.selected.relationMode&&(o.container().style.cursor="default"),n.setHighlight(!1),n.onClickRegion()}},children:[Object(Z.jsx)(_s.Shape,Object(f.a)({sceneFunc:function(e,t){if(1===n.parent.naturalWidth)return null;if(!0===n._loadedOnce)return e.drawImage(n._img,0,0,n.parent.stageWidth,n.parent.stageHeight),void e.fillStrokeShape(t);if(n._rle){var o=$n.RLE2Region(n._rle,n.parent);n._loadedOnce=!0,o.onload=function(){e.drawImage(o,0,0,n.parent.stageWidth,n.parent.stageHeight),e.fillStrokeShape(t)},n._img=o}},opacity:1},o)),n.touches.map((function(e){return Object(Z.jsx)(Fs,{store:t,item:n,points:e})})),Object(Z.jsx)(Ds,{item:n})]})})})));cn.addTag("brushregion",Xs,Js);var Gs=Object(en.c)((function(e){var t=e.item;return Object(Z.jsx)(Ss,{selected:t.selected,icon:Object(Z.jsx)(Ia.a,{}),onClick:function(e){var n=t.selected;t.manager.unselectAll(),t.setSelected(!n),t.selected&&t.updateCursor()},onChange:function(e){t.setStroke(e),t.updateCursor()}})})),Ks=Qt.n.model({strokeWidth:Qt.n.optional(Qt.n.number,10)}).views((function(e){return{get viewClass(){return Object(Z.jsx)(Gs,{item:e})},get tagTypes(){return{stateTypes:"brushlabels",controlTagTypes:["brushlabels","brush"]}}}})).actions((function(e){return{fromStateJSON:function(t,n){var o=e.createFromJSON(t,n);t.value.points&&o.addPoints({type:"add"}).addPoints(t.value.points);return"rle"===t.value.format&&(o._rle=t.value.rle),o},createRegion:function(t){var n=Xs.create(t);return e.obj.addShape(n),n},updateCursor:function(){var t=e.strokeWidth,n=e.obj.stageRef,o=["url('",$n.brushSizeCircle(t),"')"," ",Math.floor(t/2)+4," ",Math.floor(t/2)+4,", auto"];n.container().style.cursor=o.join("")},setStroke:function(t){e.strokeWidth=t},mouseupEv:function(){e.mode="viewing"},mousemoveEv:function(t,n){var o=Object(v.a)(n,2),a=o[0],r=o[1];"drawing"===e.mode&&e.getSelectedShape.currentTouch.addPoints(Math.floor(a),Math.floor(r))},mousedownEv:function(t,n){var o=Object(v.a)(n,2),a=o[0],r=o[1],i=e.control,l=e.getSelectedShape;if(l)e.mode="drawing",l.addTouch({type:"add",strokeWidth:e.strokeWidth||i.strokeWidth}).addPoints(Math.floor(a),Math.floor(r));else if(i.isSelected){e.mode="drawing";var s=e.statesAndParams;e.createRegion(Object(f.a)({x:a,y:r,coordstype:"px"},s)).addTouch({type:"add",strokeWidth:e.strokeWidth||i.strokeWidth}).addPoints(Math.floor(a),Math.floor(r))}}}})),qs=Qt.n.compose(ws,ys,Ks),Zs=n(887),$s=Object(en.c)(function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(Z.jsx)(qo.a,{title:this.props.tooltip,placement:"left",children:Object(Z.jsx)(Ho.a,{shape:"circle",type:this.props.selected?"primary":"default",disabled:!!this.props.disabled,icon:this.props.icon,className:xs.a.button,onClick:this.props.onClick})})}}]),n}(d.Component)),Qs=Object(en.c)((function(e){var t=e.item;return Object(Z.jsx)($s,{selected:t.selected,onClick:function(e){var n=t.selected;t.manager.unselectAll(),t.setSelected(!n),t.selected&&t.updateCursor()},icon:Object(Z.jsx)(Zs.a,{})})})),ec=Qt.n.model({}).views((function(e){return{get viewClass(){return Object(Z.jsx)(Qs,{item:e})}}})).actions((function(e){return{updateCursor:function(){var t=e.obj.stageRef,n=["url('",$n.brushSizeCircle(24),"')"," ",Math.floor(12)+4," ",Math.floor(12)+4,", auto"];t.container().style.cursor=n.join("")},mouseupEv:function(){e.mode="viewing"},mousemoveEv:function(t,n){var o=Object(v.a)(n,2),a=o[0],r=o[1];if("drawing"===e.mode){var i=e.getSelectedShape;i&&"brushregion"===i.type&&i.currentTouch.addPoints(Math.floor(a),Math.floor(r))}},mousedownEv:function(t,n){var o=Object(v.a)(n,2);o[0],o[1];e.mode="drawing";var a=e.getSelectedShape;a&&a&&"brushregion"===a.type&&a.addTouch({type:"eraser"})}}})),tc=Qt.n.compose(ws,ec,ys),nc=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string),opacity:Qt.n.optional(Qt.n.string,"0.9"),fillcolor:Qt.n.optional(Qt.n.string,"#8bad00"),strokecolor:Qt.n.optional(Qt.n.string,"#8bad00"),strokewidth:Qt.n.optional(Qt.n.string,"1")}),oc=Qt.n.model({id:Qt.n.identifier,type:"keypoint"}).views((function(e){return{get hasStates(){var t=e.states();return t&&t.length>0},get completion(){return $i.getParentOfTypeString(e,"Completion")}}})).actions((function(e){return{fromStateJSON:function(e){},afterCreate:function(){var t=hc.create();t._control=e,e.tools={keypoint:t}}}})),ac=Qt.n.compose("KeyPointModel",nc,oc,ll);cn.addTag("keypoint",ac,(function(){return null}));var rc=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string)}),ic=Qt.n.model("KeyPointLabelesModel",{id:Qt.n.identifier,pid:Qt.n.optional(Qt.n.string,pn),type:"keypointlabels",children:$i.unionArray(["label","header","view","hypertext"])}).views((function(e){return{get hasStates(){var t=e.states();return t&&t.length>0}}})),lc=Nl.props({_type:"keypointlabels"}),sc=Qt.n.compose(El,ic,ac,rc,lc,hl.props({_child:"LabelModel"}),ll),cc=Qt.n.compose("KeyPointLabelsModel",sc),dc=Object(en.c)((function(e){var t=e.item;return Object(Z.jsx)(Dl,{item:t})}));cn.addTag("keypointlabels",cc,dc);var uc=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"keypointregion",x:Qt.n.number,y:Qt.n.number,relativeX:Qt.n.optional(Qt.n.number,0),relativeY:Qt.n.optional(Qt.n.number,0),width:Qt.n.number,opacity:Qt.n.number,fillColor:Qt.n.maybeNull(Qt.n.string),states:Qt.n.maybeNull(Qt.n.array(Qt.n.union(cc,ul,kl,Fl))),sw:Qt.n.maybeNull(Qt.n.number),sh:Qt.n.maybeNull(Qt.n.number),coordstype:Qt.n.optional(Qt.n.enumeration(["px","perc"]),"px")}).views((function(e){return{get parent(){return Object(Qt.f)(e,Gd)}}})).actions((function(e){return{selectRegion:function(){e.selected=!0,e.completion.setHighlightedNode(e),e.parent.setSelected(e.id),e.completion.loadRegionState(e)},updateAppearenceFromState:function(){var t=e.states[0].getSelectedColor();e.strokeColor=t,e.fillColor=t},rotate:function(t){var n=e.rotatePoint(e,t);e.setPosition(n.x,n.y)},setPosition:function(t,n){e.x=t,e.y=n,e.relativeX=t/e.parent.stageWidth*100,e.relativeY=n/e.parent.stageHeight*100},addState:function(t){e.states.push(t)},setFill:function(t){e.fill=t},afterAttach:function(){"perc"===e.coordstype&&(e.relativeX=e.x,e.relativeY=e.y),"px"===e.coordstype&&(e.relativeX=e.x/e.parent.stageWidth*100,e.relativeY=e.y/e.parent.stageHeight*100)},updateImageSize:function(t,n,o,a){e.sw=o,e.sh=a,"px"===e.coordstype&&(e.x=o*e.relativeX/100,e.y=a*e.relativeY/100),e.completion.sentUserGenerate||"perc"!==e.coordstype||(e.x=o*e.x/100,e.y=a*e.y/100,e.width=o*e.width/100,e.coordstype="px")},serialize:function(t,n){var o=n.naturalWidth,a=n.naturalHeight,r=n.stageWidth,i=n.stageHeight,l=-e.parent.rotation,s=e.rotateDimensions({width:o,height:a},l),c=e.rotateDimensions({width:r,height:i},l),d=c.width,u=c.height,p=e.rotatePoint(e,l,!1),g=p.x,f=p.y,h={original_width:s.width,original_height:s.height,image_rotation:e.parent.rotation,value:{x:100*g/d,y:100*f/u,width:100*e.width/d}};return h.value=Object.assign(h.value,t.serializableValue),h}}})),pc=Qt.n.compose("KeyPointRegionModel",Si,Yi,Xi,uc),gc=Object(en.b)("store")(Object(en.c)((function(e){var t=e.store,n=e.item,o=n.x,a=n.y,r={};return r.opacity=n.opacity,n.fillColor&&(r.fill=n.fillColor),r.stroke=n.strokeColor,r.strokeWidth=n.strokeWidth,r.strokeScaleEnabled=!1,r.shadowBlur=0,n.highlighted&&(r.stroke=Mi,r.strokeWidth=Ai),Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)(_s.Circle,Object(f.a)(Object(f.a)({x:o,y:a,radius:n.width,scaleX:1/n.parent.zoomScale,scaleY:1/n.parent.zoomScale,name:n.id,onDragEnd:function(e){var t=e.target;n.setPosition(t.getAttr("x"),t.getAttr("y"))},dragBoundFunc:n.parent.fixForZoom((function(e){var t=n.parent.stageWidth,o=n.parent.stageHeight,a=e.x,r=e.y;return a<0&&(a=0),r<0&&(r=0),a>t&&(a=t),r>o&&(r=o),{x:a,y:r}})),onMouseOver:function(e){var o=n.parent.stageRef;t.completionStore.selected.relationMode?(n.setHighlight(!0),o.container().style.cursor="crosshair"):o.container().style.cursor="pointer"},onMouseOut:function(e){n.parent.stageRef.container().style.cursor="default",t.completionStore.selected.relationMode&&n.setHighlight(!1)},onClick:function(e){var o=n.parent.stageRef;n.completion.editable&&(t.completionStore.selected.relationMode&&(o.container().style.cursor="default"),n.setHighlight(!1),n.onClickRegion())}},r),{},{draggable:n.editable})),Object(Z.jsx)(Ws,{item:n})]})})));cn.addTag("keypointregion",pc,gc);var fc=Qt.n.model({default:Qt.n.optional(Qt.n.boolean,!0)}).views((function(e){return{get tagTypes(){return{stateTypes:"keypointlabels",controlTagTypes:["keypointlabels","keypoint"]}}}})).actions((function(e){return{createRegion:function(t){var n=e.obj,o=e.control,a=pc.create(Object(f.a)({opacity:parseFloat(o.opacity)},t));return n.addShape(a),a},clickEv:function(t,n){var o=Object(v.a)(n,2),a=o[0],r=o[1],i=e.control;if(("keypointlabels"!==i.type||i.isSelected)&&e.obj.checkLabels()){var l=e.statesAndParams;e.createRegion(Object(f.a)({x:a,y:r,width:Number(i.strokewidth),coordstype:"px"},l)),e.obj.completion.highlightedNode.unselectRegion(!0)}}}})),hc=Qt.n.compose(ws,ys,fc),bc=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string),opacity:Qt.n.optional(Qt.n.string,"0.6"),fillcolor:Qt.n.optional(Qt.n.string,"#f48a42"),strokewidth:Qt.n.optional(Qt.n.string,"3"),strokecolor:Qt.n.optional(Qt.n.string,"#f48a42"),pointsize:Qt.n.optional(Qt.n.string,"small"),pointstyle:Qt.n.optional(Qt.n.string,"circle")}),mc=Qt.n.model({id:Qt.n.identifier,type:"polygon",_value:Qt.n.optional(Qt.n.string,"")}).views((function(e){return{get completion(){return Object(Qt.g)(e).completionStore.selected}}})).actions((function(e){return{fromStateJSON:function(){},afterCreate:function(){var t=Hc.create(),n=Id.create();t._control=e,n._control=e,e.tools={poly:t}}}})),jc=Qt.n.compose("PolygonModel",ll,bc,mc),vc=Object(en.b)("store")(Object(en.c)((function(e){e.store,e.item;return null})));cn.addTag("polygon",jc,vc);var yc=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string)}),Oc=Qt.n.model("PolygonLabelsModel",{id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"polygonlabels",children:$i.unionArray(["label","header","view","hypertext"])}),xc=Nl.props({_type:"polygonlabels"}),Sc=Qt.n.compose(El,Oc,jc,yc,xc,hl.props({_child:"LabelModel"}),ll),wc=Qt.n.compose("PolygonLabelsModel",Sc),_c=Object(en.c)((function(e){var t=e.item;return Object(Z.jsx)(Dl,{item:t})}));cn.addTag("polygonlabels",wc,_c);var kc=Qt.n.model("PolygonPoint",{id:Qt.n.optional(Qt.n.identifier,pn),relativeX:Qt.n.optional(Qt.n.number,0),relativeY:Qt.n.optional(Qt.n.number,0),initX:Qt.n.optional(Qt.n.number,0),initY:Qt.n.optional(Qt.n.number,0),x:Qt.n.number,y:Qt.n.number,index:Qt.n.number,selected:Qt.n.optional(Qt.n.boolean,!1),style:Qt.n.string,size:Qt.n.string}).views((function(e){return{get parent(){return Object(Qt.e)(e,2)},get completion(){return Object(Qt.g)(e).completionStore.selected}}})).actions((function(e){return{afterCreate:function(){e.initX=e.x,e.initY=e.y,"perc"===e.parent.coordstype?(e.relativeX=e.x,e.relativeY=e.y):(e.relativeX=e.x/e.parent.parent.stageWidth*100,e.relativeY=e.y/e.parent.parent.stageHeight*100)},movePoint:function(t,n){e.initX=e.initX+t,e.initY=e.initY+n,e.x=e.x+t,e.y=e.y+n,e.relativeX=e.x/e.parent.parent.stageWidth*100,e.relativeY=e.y/e.parent.parent.stageHeight*100},_movePoint:function(t,n){e.initX=t,e.initY=n,e.relativeX=t/e.parent.parent.stageWidth*100,e.relativeY=n/e.parent.parent.stageHeight*100,e.x=t,e.y=n},closeStartPoint:function(t){e.completion.editable&&e.parent.mouseOverStartPoint&&e.parent.closePoly()},handleMouseOverStartPoint:function(t){if(e.parent.parent.stageRef.container().style.cursor="crosshair",!(e.parent.closed||e.parent.points.length<3)){var n=t.target;"rectangle"===e.style&&(n.setX(n.x()-n.width()/2),n.setY(n.y()-n.height()/2));var o={small:2,medium:3,large:4}[e.size];n.scale({x:o/e.parent.parent.zoomScale,y:o/e.parent.parent.zoomScale}),e.parent.setMouseOverStartPoint(!0)}},handleMouseOutStartPoint:function(t){var n=t.target;e.parent.parent.stageRef.container().style.cursor="default","rectangle"===e.style&&(n.setX(n.x()+n.width()/2),n.setY(n.y()+n.height()/2)),n.scale({x:1/e.parent.parent.zoomScale,y:1/e.parent.parent.zoomScale}),e.parent.setMouseOverStartPoint(!1)}}})),Cc=Object(en.c)((function(e){var t=e.item,n=e.name,o={small:1,medium:2,large:3},a={small:4,medium:8,large:12}[t.size],r=0===t.index?{hitStrokeWidth:12,fill:t.parent.strokeColor?t.parent.strokeColor:t.primary,onMouseOver:t.handleMouseOverStartPoint,onMouseOut:t.handleMouseOutStartPoint,onClick:t.closeStartPoint}:null,i={onDragMove:function(e){var n=e.target.attrs,o=n.x,a=n.y;o<0&&(o=0),a<0&&(a=0),o>t.parent.parent.stageWidth&&(o=t.parent.parent.stageWidth),a>t.parent.parent.stageHeight&&(a=t.parent.parent.stageHeight),t._movePoint(o,a)},onDragEnd:function(e){e.cancelBubble=!0},onMouseOver:function(e){t.parent.parent.stageRef.container().style.cursor="crosshair"},onMouseOut:function(e){t.parent.parent.stageRef.container().style.cursor="default"}},l=t.selected?"green":"white";return"circle"===t.style?Object(Z.jsx)(_s.Circle,Object(f.a)(Object(f.a)(Object(f.a)({name:n,x:t.x,y:t.y,radius:a,fill:l,stroke:"black",strokeWidth:o[t.size],dragOnTop:!1,strokeScaleEnabled:!1,scaleX:1/(t.parent.parent.zoomScale||1),scaleY:1/(t.parent.parent.zoomScale||1),onClick:function(e){t.parent.mouseOverStartPoint?t.parent.closePoly():t.parent.setSelectedPoint(t)}},i),r),{},{draggable:t.parent.editable}),n):Object(Z.jsx)(_s.Rect,Object(f.a)(Object(f.a)(Object(f.a)({name:n,x:t.x-a/2,y:t.y-a/2,width:a,height:a,fill:l,stroke:"black",strokeWidth:o[t.size],dragOnTop:!1},i),r),{},{draggable:t.parent.editable}),n)})),Nc=n(154),Tc=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"polygonregion",opacity:Qt.n.number,fillColor:Qt.n.maybeNull(Qt.n.string),strokeWidth:Qt.n.number,strokeColor:Qt.n.string,pointSize:Qt.n.string,pointStyle:Qt.n.string,closed:Qt.n.optional(Qt.n.boolean,!1),points:Qt.n.array(kc,[]),states:Qt.n.maybeNull(Qt.n.array(Qt.n.union(wc,ul,kl,Fl))),mouseOverStartPoint:Qt.n.optional(Qt.n.boolean,!1),selectedPoint:Qt.n.maybeNull(Qt.n.safeReference(kc)),coordstype:Qt.n.optional(Qt.n.enumeration(["px","perc"]),"px"),fromName:Qt.n.maybeNull(Qt.n.string),wp:Qt.n.maybeNull(Qt.n.number),hp:Qt.n.maybeNull(Qt.n.number)}).views((function(e){return{get parent(){return Object(Qt.f)(e,Gd)}}})).actions((function(e){return{setMouseOverStartPoint:function(t){e.mouseOverStartPoint=t},setSelectedPoint:function(t){e.selectedPoint&&(e.selectedPoint.selected=!1),t.selected=!0,e.selectedPoint=t},handleMouseMove:function(t){var n=t.e,o=t.flattenedPoints,a=n.evt,r=a.offsetX,i=a.offsetY,l=e.parent.fixZoomedCoords([r,i]),s=Object(v.a)(l,2),c=Mc({flattenedPoints:o,cursorX:s[0],cursorY:s[1]}),d=Object(v.a)(c,2);!function(e){var t=e.point,n=e.group,o=e.layer,a=e.zoom;(zc({layer:o})||function(e){var t=e.point,n=e.group,o=e.layer,a=e.zoom,r=new qn.a.Circle({name:"hoverAnchor",x:t[0],y:t[1],stroke:Nc.b.primary,fill:Nc.b[0],scaleX:1/(a||1),scaleY:1/(a||1),strokeWidth:2,radius:5});return n.add(r),o.draw(),r}({point:t,group:n,layer:o,zoom:a})).to({x:t[0],y:t[1],duration:0})}({point:[d[0],d[1]],group:n.currentTarget,layer:n.currentTarget.getLayer(),zoom:e.parent.zoomScale})},handleMouseLeave:function(e){Pc({layer:e.e.currentTarget.getLayer()})},handleLineClick:function(t){var n=t.e,o=t.flattenedPoints,a=t.insertIdx;if(n.cancelBubble=!0,e.closed&&e.selected){Pc({layer:n.currentTarget.getLayer()});var r=n.evt,i=r.offsetX,l=r.offsetY,s=e.parent.fixZoomedCoords([i,l]),c=Object(v.a)(s,2),d=Mc({flattenedPoints:o,cursorX:c[0],cursorY:c[1]});e.insertPoint(a,d[0],d[1])}},addPoint:function(t,n){e.closed||e._addPoint(t,n)},insertPoint:function(t,n,o){var a={id:pn(),x:n,y:o,size:e.pointSize,style:e.pointStyle,index:e.points.length};e.points.splice(t,0,a)},_addPoint:function(t,n){e.points.push({id:pn(),x:t,y:n,size:e.pointSize,style:e.pointStyle,index:e.points.length})},rotate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-90;e.points.forEach((function(n){var o=e.rotatePoint(n,t);n._movePoint(o.x,o.y)}))},closePoly:function(){e.closed=!0,e.selectRegion()},canClose:function(t,n){if(e.points.length<2)return!1;var o=e.points[0],a=t,r=n;return Math.pow(o.x-a,2)+Math.pow(o.y-r,2)<50},destroyRegion:function(){Object(Qt.c)(e.points),Object(Qt.b)(e.points)},afterUnselectRegion:function(){e.selectedPoint&&(e.selectedPoint.selected=!1)},updateAppearenceFromState:function(){var t=e.states[0].getSelectedColor();e.strokeColor=t,e.fillColor=t},selectRegion:function(){e.parent.selected&&(e.parent.selected.closed=!0),e.selected=!0,e.completion.setHighlightedNode(e),e.parent.setSelected(e.id),e.completion.loadRegionState(e)},setScale:function(t,n){e.scaleX=t,e.scaleY=n},addState:function(t){e.states.push(t)},setFill:function(t){e.fill=t},updateOffset:function(){e.points.map((function(e){return e.computeOffset()}))},updateImageSize:function(t,n,o,a){e.wp=t,e.hp=n,"px"===e.coordstype&&e.points.forEach((function(e){var t=o*e.relativeX/100,n=a*e.relativeY/100;e._movePoint(t,n)})),e.completion.sentUserGenerate||"perc"!==e.coordstype||e.points.forEach((function(t){var n=o*t.x/100,r=a*t.y/100;e.coordstype="px",t._movePoint(n,r)}))},serialize:function(t,n){var o=n.naturalWidth,a=n.naturalHeight,r=n.stageWidth,i=n.stageHeight,l=-e.parent.rotation,s=e.rotateDimensions({width:o,height:a},l),c=e.rotateDimensions({width:r,height:i},l),d=c.width,u=c.height,p={value:{points:e.points.map((function(t){var n=e.rotatePoint(t,l,!1);return[100*n.x/d,100*n.y/u]}))},original_width:s.width,original_height:s.height,image_rotation:e.parent.rotation};return p.value=Object.assign(p.value,t.serializableValue),p}}})),Rc=Qt.n.compose("PolygonRegionModel",Si,Yi,Xi,Tc);function Mc(e){var t=e.flattenedPoints,n=e.cursorX,o=e.cursorY,a=Object(v.a)(t,4),r=a[0],i=a[1],l=a[2],s=a[3];return[n-(s-i)*(l*i-r*s+n*(s-i)-o*(l-r))/((s-i)*(s-i)+(l-r)*(l-r)),((l-r)*(l*i-r*s)+(l-r)*(s-i)*n+(s-i)*(s-i)*o)/((s-i)*(s-i)+(l-r)*(l-r))]}function Ac(e){return e.map((function(e){return[e.x,e.y]})).reduce((function(e,t){return e.concat(t)}),[])}function zc(e){return e.layer.findOne(".hoverAnchor")}function Pc(e){var t=e.layer,n=zc({layer:t});n&&(n.destroy(),t.draw())}var Ic=Object(en.b)("store")(Object(en.c)((function(e){var t=e.store,n=e.item;function o(e){return e.reduce((function(e,t){return e[0]=void 0===e[0]||t<e[0]?t:e[0],e[1]=void 0===e[1]||t>e[1]?t:e[1],e}),[])}var a=0,r=0,i=0,l=0;return Object(Z.jsxs)(_s.Group,{onDragStart:function(e){n.completion.setDragMode(!0);var t=n.points.map((function(e){return e.x})),s=n.points.map((function(e){return e.y})),c=o(t),d=Object(v.a)(c,2);a=d[0],r=d[1];var u=o(s),p=Object(v.a)(u,2);i=p[0],l=p[1]},dragBoundFunc:n.parent.fixForZoom((function(e){var t=e.x,o=e.y,s=n.parent.stageWidth,c=n.parent.stageHeight;return i+o<0&&(o=-1*i),a+t<0&&(t=-1*a),l+o>c&&(o=c-l),r+t>s&&(t=s-r),{x:t,y:o}})),onDragEnd:function(e){var t=e.target;n.completion.setDragMode(!1),n.closed||n.closePoly(),n.points.forEach((function(e){return e.movePoint(t.getAttr("x"),t.getAttr("y"))})),t.setAttr("x",0),t.setAttr("y",0)},onMouseOver:function(e){var o=n.parent.stageRef;t.completionStore.selected.relationMode?(n.setHighlight(!0),o.container().style.cursor=Ei):o.container().style.cursor=Li},onMouseOut:function(e){n.parent.stageRef.container().style.cursor=Pi,t.completionStore.selected.relationMode&&n.setHighlight(!1)},onClick:function(e){if(e.cancelBubble=!0,n.closed){var o=n.parent.stageRef;t.completionStore.selected.relationMode&&(o.container().style.cursor=Pi),n.setHighlight(!1),n.onClickRegion()}},draggable:n.editable,children:[n.mouseOverStartPoint,n.points&&n.closed?function(e){var t="poly";return Object(Z.jsx)(_s.Group,{name:t,children:Object(Z.jsx)(_s.Line,{lineJoin:"bevel",points:Ac(e),fill:n.strokeColor,closed:!0,opacity:.2})},t)}(n.points):null,n.points?function(e){var t="borders";return Object(Z.jsx)(_s.Group,{name:t,children:e.map((function(t,o){var a=o,r=o===e.length-1?0:o+1;return function(e){var t=e.points,o=e.idx1,a=e.idx2,r="border_".concat(o,"_").concat(a),i=n.strokeColor,l=n.strokeWidth;if(n.highlighted&&(i=Mi,l=Ai),!n.closed&&0===a)return null;var s=o+1,c=Ac([t[o],t[a]]);return Object(Z.jsx)(_s.Group,{name:r,onClick:function(e){return n.handleLineClick({e:e,flattenedPoints:c,insertIdx:s})},onMouseMove:function(e){n.closed&&n.selected&&n.editable&&n.handleMouseMove({e:e,flattenedPoints:c})},onMouseLeave:function(e){return n.handleMouseLeave({e:e})},children:Object(Z.jsx)(_s.Line,{points:c,stroke:i,opacity:n.opacity,lineJoin:"bevel",strokeWidth:l,strokeScaleEnabled:!1})},r)}({points:e,idx1:a,idx2:r})}))},t)}(n.points):null,n.points?function(e){var t="anchors";return Object(Z.jsx)(_s.Group,{name:t,children:e.map((function(t,o){return function(e){var t=e.points,o=e.idx,a="anchor_".concat(t.length,"_").concat(o),r=t[o];if(!n.closed||n.closed&&n.selected)return Object(Z.jsx)(Cc,{item:r,name:a},a)}({points:e,idx:o})}))},t)}(n.points):null,Object(Z.jsx)(Es,{item:n})]},n.id?n.id:pn(5))})));cn.addTag("polygonregion",Rc,Ic);var Lc=Qt.n.model({default:Qt.n.optional(Qt.n.boolean,!0),mode:Qt.n.optional(Qt.n.enumeration(["drawing","viewing","brush","eraser"]),"viewing")}).views((function(e){return{get getActivePolygon(){var t=e.getActiveShape;return t&&t.closed||void 0===t||"polygonregion"!==t.type?null:t},get tagTypes(){return{stateTypes:"polygonlabels",controlTagTypes:["polygonlabels","polygon"]}},moreRegionParams:function(e){return{x:e.value.points[0][0],y:e.value.points[0][1]}}}})).actions((function(e){return{fromStateJSON:function(t,n){var o=e.createFromJSON(t,n);if(o){for(var a=1;a<t.value.points.length;a++)o.addPoint(t.value.points[a][0],t.value.points[a][1]);o.closePoly()}},createRegion:function(t){var n=e.getActivePolygon,o=e.obj,a=e.control;return delete t.points,n||(n=Rc.create(Object(f.a)({opacity:Number(a.opacity),strokeWidth:Number(a.strokewidth),fillOpacity:Number(a.fillopacity),pointSize:a.pointsize,pointStyle:a.pointstyle},t)),o.addShape(n)),n.addPoint(t.x,t.y),n},clickEv:function(t,n){var o=Object(v.a)(n,2),a=o[0],r=o[1];if(("polygonlabels"!==e.control.type||e.control.isSelected||null!==e.getActivePolygon)&&(e.getActivePolygon||e.obj.checkLabels())){var i=e.statesAndParams;e.createRegion(Object(f.a)({x:a,y:r,width:10,coordstype:"px"},i))}}}})),Hc=Qt.n.compose(ws,ys,Lc),Ec=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string),opacity:Qt.n.optional(Qt.n.string,"0.6"),fillcolor:Qt.n.optional(Qt.n.string,"#f48a42"),strokewidth:Qt.n.optional(Qt.n.string,"1"),strokecolor:Qt.n.optional(Qt.n.string,"#f48a42"),fillopacity:Qt.n.optional(Qt.n.string,"0.6"),canrotate:Qt.n.optional(Qt.n.boolean,!0)}),Dc=Qt.n.model({id:Qt.n.identifier,type:"rectangle"}).views((function(e){return{get completion(){return Object(Qt.g)(e).completionStore.selected}}})).actions((function(e){return{fromStateJSON:function(){},afterCreate:function(){var t=$c.create({activeShape:null});t._control=e,e.tools={rect:t}}}})),Wc=Qt.n.compose("RectangleModel",ll,Ec,Dc);cn.addTag("rectangle",Wc,(function(){return null}));var Uc=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string)}),Bc=Qt.n.model("RectangleLabelsModel",{id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"rectanglelabels",children:$i.unionArray(["label","header","view","hypertext"])}),Xc=Nl.props({_type:"rectanglelabels"}),Fc=Qt.n.compose(El,Bc,Wc,Uc,Xc,hl.props({_child:"LabelModel"}),ll),Yc=Qt.n.compose("RectangleLabelsModel",Fc),Vc=Object(en.c)((function(e){var t=e.item;return Object(Z.jsx)(Dl,{item:t})}));cn.addTag("rectanglelabels",Yc,Vc);var Jc=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"rectangleregion",x:Qt.n.number,y:Qt.n.number,relativeX:Qt.n.optional(Qt.n.number,0),relativeY:Qt.n.optional(Qt.n.number,0),relativeWidth:Qt.n.optional(Qt.n.number,0),relativeHeight:Qt.n.optional(Qt.n.number,0),startX:Qt.n.optional(Qt.n.number,0),startY:Qt.n.optional(Qt.n.number,0),width:Qt.n.number,height:Qt.n.number,scaleX:Qt.n.optional(Qt.n.number,1),scaleY:Qt.n.optional(Qt.n.number,1),rotation:Qt.n.optional(Qt.n.number,0),opacity:Qt.n.number,fill:Qt.n.optional(Qt.n.boolean,!0),fillColor:Qt.n.optional(Qt.n.string,wi),fillOpacity:Qt.n.optional(Qt.n.number,.6),strokeColor:Qt.n.optional(Qt.n.string,_i),strokeWidth:Qt.n.optional(Qt.n.number,ki),states:Qt.n.maybeNull(Qt.n.array(Qt.n.union(Yc,ul,kl,Fl))),wp:Qt.n.maybeNull(Qt.n.number),hp:Qt.n.maybeNull(Qt.n.number),sw:Qt.n.maybeNull(Qt.n.number),sh:Qt.n.maybeNull(Qt.n.number),coordstype:Qt.n.optional(Qt.n.enumeration(["px","perc"]),"px"),supportsTransform:!0}).views((function(e){return{get store(){return Object(Qt.g)(e)},get parent(){return Object(Qt.f)(e,Gd)}}})).actions((function(e){return{afterCreate:function(){e.startX=e.x,e.startY=e.y,"perc"===e.coordstype&&(e.relativeX=e.x,e.relativeY=e.y,e.relativeWidth=e.width,e.relativeHeight=e.height),e.updateAppearenceFromState()},updateAppearenceFromState:function(){if(e.states&&e.states.length){var t=e.states[0].getSelectedColor();e.strokeColor=t,e.fillColor=t}},rotate:function(t){var n=e.rotatePoint(e,t);-90===t&&(n.y-=e.width),90===t&&(n.x-=e.height),e.setPosition(n.x,n.y,e.height,e.width,e.rotation)},coordsInside:function(t,n){var o=e.x,a=e.y,r=e.width*(e.scaleX||1),i=e.height*(e.scaleY||1);return t>o&&t<o+r&&n>a&&n<a+i},selectRegion:function(){e.selected=!0,e.completion.setHighlightedNode(e),e.parent.setSelected(e.id),e.completion.loadRegionState(e)},setPosition:function(t,n,o,a,r){e.x=t,e.y=n,e.width=o,e.height=a,e.relativeX=t/e.parent.stageWidth*100,e.relativeY=n/e.parent.stageHeight*100,e.relativeWidth=o/e.parent.stageWidth*100,e.relativeHeight=a/e.parent.stageHeight*100,e.rotation=(r+360)%360},setScale:function(t,n){e.scaleX=t,e.scaleY=n},addState:function(t){e.states.push(t)},setFill:function(t){e.fill=t},updateImageSize:function(t,n,o,a){e.wp=t,e.hp=n,e.sw=o,e.sh=a,"px"===e.coordstype?(e.x=o*e.relativeX/100,e.y=a*e.relativeY/100,e.width=o*e.relativeWidth/100,e.height=a*e.relativeHeight/100):"perc"===e.coordstype&&(e.x=o*e.x/100,e.y=a*e.y/100,e.width=o*e.width/100,e.height=a*e.height/100,e.coordstype="px")},serialize:function(t,n){var o=t.serializableValue;if(!o)return null;var a=(360-e.parent.rotation)%360,r=e.rotatePoint(e,a,!1),i=r.x,l=r.y;270===a&&(l-=e.width),90===a&&(i-=e.height),180===a&&(i-=e.width,l-=e.height);var s=e.rotateDimensions({width:n.naturalWidth,height:n.naturalHeight},a),c=e.rotateDimensions({width:n.stageWidth,height:n.stageHeight},a),d=e.rotateDimensions({width:e.width*(e.scaleX||1)*100/n.stageWidth,height:e.height*(e.scaleY||1)*100/n.stageHeight},a),u=d.width,p=d.height;return{original_width:s.width,original_height:s.height,image_rotation:e.parent.rotation,value:Object(f.a)({x:100*i/c.width,y:100*l/c.height,width:u,height:p,rotation:e.rotation},o)}}}})),Gc=Qt.n.compose("RectRegionModel",Si,Yi,Xi,Xi,Jc),Kc=Object(en.b)("store")(Object(en.c)((function(e){var t=e.store,n=e.item,o=n.strokeColor,a=n.strokeWidth;return n.highlighted&&(o=Mi,a=Ai),n.hidden?null:Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)(_s.Rect,{x:n.x,y:n.y,width:n.width,height:n.height,fill:n.fill?ho.Colors.convertToRGBA(n.fillColor,n.fillOpacity):null,stroke:o,strokeWidth:a,strokeScaleEnabled:!1,shadowBlur:0,scaleX:n.scaleX,scaleY:n.scaleY,opacity:n.opacity,rotation:n.rotation,name:n.id,onTransformEnd:function(e){var t=e.target;n.setPosition(t.getAttr("x"),t.getAttr("y"),t.getAttr("width")*t.getAttr("scaleX"),t.getAttr("height")*t.getAttr("scaleY"),t.getAttr("rotation")),t.setAttr("scaleX",1),t.setAttr("scaleY",1)},onDragEnd:function(e){var t=e.target;n.setPosition(t.getAttr("x"),t.getAttr("y"),t.getAttr("width"),t.getAttr("height"),t.getAttr("rotation")),n.setScale(t.getAttr("scaleX"),t.getAttr("scaleY"))},dragBoundFunc:n.parent.fixForZoom((function(e){var t=e.x,o=e.y,a=Object(Qt.e)(n,2),r=a.stageHeight,i=a.stageWidth;return t<=0?t=0:t+n.width>=i&&(t=i-n.width),o<0?o=0:o+n.height>=r&&(o=r-n.height),{x:t,y:o}})),onMouseOver:function(e){var o=n.parent.stageRef;t.completionStore.selected.relationMode?(n.setHighlight(!0),o.container().style.cursor=Ei):o.container().style.cursor=Li},onMouseOut:function(e){n.parent.stageRef.container().style.cursor=Pi,t.completionStore.selected.relationMode&&n.setHighlight(!1)},onClick:function(e){var o=n.parent.stageRef;n.completion.editable&&(t.completionStore.selected.relationMode&&(o.container().style.cursor=Pi),n.setHighlight(!1),n.onClickRegion())},draggable:n.editable}),Object(Z.jsx)(Hs,{item:n})]})})));cn.addTag("rectangleregion",Gc,Kc);var qc=Qt.n.model("DrawingTool").actions((function(e){return{updateDraw:Fr()((function(t,n){var o=e.getActiveShape,a=e.obj,r=a.stageWidth,i=a.stageHeight,l=ho.Image.reverseCoordinates({x:o.startX,y:o.startY},{x:t,y:n}),s=l.x1,c=l.y1,d=l.x2,u=l.y2;s=Math.max(0,s),c=Math.max(0,c),d=Math.min(r,d),u=Math.min(i,u),o.setPosition(s,c,d-s,u-c,o.rotation)}),48)}})),Zc=Qt.n.model({default:!0,mode:Qt.n.optional(Qt.n.enumeration(["drawing","viewing","brush","eraser"]),"viewing")}).views((function(e){return{get tagTypes(){return{stateTypes:"rectanglelabels",controlTagTypes:["rectanglelabels","rectangle"]}}}})).actions((function(e){return{createRegion:function(t){var n=e.control,o=Gc.create(Object(f.a)({opacity:parseFloat(n.opacity),strokeWidth:Number(n.strokewidth),fillOpacity:Number(n.fillopacity)},t));return e.obj.addShape(o),o},mousedownEv:function(t,n){var o=Object(v.a)(n,2),a=o[0],r=o[1];if(("rectanglelabels"!==e.control.type||e.control.isSelected)&&e.obj.checkLabels()){e.mode="drawing";var i=e.statesAndParams;return e.createRegion(Object(f.a)({x:a,y:r,height:1,width:1,coordstype:"px"},i))}},mousemoveEv:function(t,n){var o=Object(v.a)(n,2),a=o[0],r=o[1];"drawing"===e.mode&&e.updateDraw(a,r)},mouseupEv:function(t,n){var o=Object(v.a)(n,2);o[0],o[1];if("drawing"===e.mode){var a=e.getActiveShape;a.width<js||a.height<vs?(Object(Qt.b)(a),"rectanglelabels"===e.control.type&&e.control.unselectAll()):e.obj.completion.highlightedNode.unselectRegion(!0),e.mode="viewing"}}}})),$c=Qt.n.compose(ws,ys,qc,Zc),Qc=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string),opacity:Qt.n.optional(Qt.n.string,"0.6"),fillcolor:Qt.n.optional(Qt.n.string,"#f48a42"),strokewidth:Qt.n.optional(Qt.n.string,"1"),strokecolor:Qt.n.optional(Qt.n.string,"#f48a42"),fillopacity:Qt.n.optional(Qt.n.string,"0.6"),canrotate:Qt.n.optional(Qt.n.boolean,!0)}),ed=Qt.n.model({id:Qt.n.identifier,type:"ellipse"}).views((function(e){return{get hasStates(){var t=e.states();return t&&t.length>0},get completion(){return Object(Qt.g)(e).completionStore.selected}}})).actions((function(e){return{afterCreate:function(){var t=pd.create({activeShape:null});t._control=e,e.tools={ellipse:t}}}})),td=Qt.n.compose("EllipseModel",Qc,ed,ll);cn.addTag("ellipse",td,(function(){return null}));var nd=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string)}),od=Qt.n.model("EllipseLabelsModel",{id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"ellipselabels",children:$i.unionArray(["label","header","view","hypertext"])}),ad=Nl.props({_type:"ellipselabels"}),rd=Qt.n.compose(El,od,td,nd,ad,hl.props({_child:"LabelModel"}),ll),id=Qt.n.compose("EllipseLabelsModel",rd),ld=Object(en.c)((function(e){var t=e.item;return Object(Z.jsx)(Dl,{item:t})}));cn.addTag("ellipselabels",id,ld);var sd=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"ellipseregion",x:Qt.n.number,y:Qt.n.number,relativeX:Qt.n.optional(Qt.n.number,0),relativeY:Qt.n.optional(Qt.n.number,0),relativeWidth:Qt.n.optional(Qt.n.number,0),relativeHeight:Qt.n.optional(Qt.n.number,0),startX:Qt.n.optional(Qt.n.number,0),startY:Qt.n.optional(Qt.n.number,0),relativeRadiusX:Qt.n.optional(Qt.n.number,0),relativeRadiusY:Qt.n.optional(Qt.n.number,0),radiusX:Qt.n.number,radiusY:Qt.n.number,scaleX:Qt.n.optional(Qt.n.number,1),scaleY:Qt.n.optional(Qt.n.number,1),rotation:Qt.n.optional(Qt.n.number,0),opacity:Qt.n.number,fill:Qt.n.optional(Qt.n.boolean,!0),fillColor:Qt.n.optional(Qt.n.string,wi),fillOpacity:Qt.n.optional(Qt.n.number,.6),strokeColor:Qt.n.optional(Qt.n.string,_i),strokeWidth:Qt.n.optional(Qt.n.number,ki),states:Qt.n.maybeNull(Qt.n.array(Qt.n.union(id,ul,kl,Fl))),wp:Qt.n.maybeNull(Qt.n.number),hp:Qt.n.maybeNull(Qt.n.number),sw:Qt.n.maybeNull(Qt.n.number),sh:Qt.n.maybeNull(Qt.n.number),coordstype:Qt.n.optional(Qt.n.enumeration(["px","perc"]),"px"),supportsTransform:!0}).views((function(e){return{get parent(){return Object(Qt.f)(e,Gd)}}})).actions((function(e){return{afterCreate:function(){e.startX=e.x,e.startY=e.y,"perc"===e.coordstype&&(e.relativeX=e.x,e.relativeY=e.y,e.relativeRadiusX=e.radiusX,e.relativeRadiusY=e.radiusY,e.relativeWidth=e.width,e.relativeHeight=e.height),e.updateAppearenceFromState()},updateAppearenceFromState:function(){if(e.states.length){var t=e.states[0].getSelectedColor();e.strokeColor=t,e.fillColor=t}},coordsInside:function(t,n){var o=e.radiusX,a=e.radiusY,r=t-e.x,i=n-e.y,l=e.rotation;return i=(r=r*Math.cos(Math.unit(l,"deg"))-i*Math.sin(Math.unit(l,"deg")))*Math.sin(Math.unit(l,"deg"))+i*Math.cos(Math.unit(l,"deg")),Math.abs(r)<o&&(Math.pow(i,2)<Math.pow(a,2)*(1-Math.pow(r,2)/Math.pow(o,2))||void 0)},selectRegion:function(){e.selected=!0,e.completion.setHighlightedNode(e),e.parent.setSelected(e.id),e.completion.loadRegionState(e)},rotate:function(t){var n=e.rotatePoint(e,t);e.setPosition(n.x,n.y,e.radiusY,e.radiusX,e.rotation)},setPosition:function(t,n,o,a,r){e.x=t,e.y=n,e.radiusX=o,e.radiusY=a,e.relativeX=t/e.parent.stageWidth*100,e.relativeY=n/e.parent.stageHeight*100,e.relativeRadiusX=o/e.parent.stageWidth*100,e.relativeRadiusY=a/e.parent.stageHeight*100,e.rotation=(r+360)%360},setScale:function(t,n){e.scaleX=t,e.scaleY=n},addState:function(t){e.states.push(t)},setFill:function(t){e.fill=t},updateImageSize:function(t,n,o,a){e.wp=t,e.hp=n,e.sw=o,e.sh=a,"px"===e.coordstype?(e.x=o*e.relativeX/100,e.y=a*e.relativeY/100,e.radiusX=o*e.relativeRadiusX/100,e.radiusY=a*e.relativeRadiusY/100):"perc"===e.coordstype&&(e.x=o*e.x/100,e.y=a*e.y/100,e.radiusX=o*e.radiusX/100,e.radiusY=a*e.radiusY/100,e.coordstype="px")},serialize:function(t,n){var o=n.naturalWidth,a=n.naturalHeight,r=n.stageWidth,i=n.stageHeight,l=-e.parent.rotation,s=e.rotateDimensions({width:o,height:a},l),c=e.rotateDimensions({width:r,height:i},l),d=c.width,u=c.height,p=e.rotateDimensions({width:e.radiusX*(e.scaleX||1)*100/n.stageWidth,height:e.radiusY*(e.scaleY||1)*100/n.stageHeight},l),g=p.width,f=p.height,h=e.rotatePoint(e,l,!1),b=h.x,m=h.y,j={original_width:s.width,original_height:s.height,image_rotation:e.parent.rotation,value:{x:100*b/d,y:100*m/u,radiusX:g,radiusY:f,rotation:e.rotation}};return j.value=Object.assign(j.value,t.serializableValue),j}}})),cd=Qt.n.compose("EllipseRegionModel",Si,Yi,Xi,Xi,sd),dd=Object(en.b)("store")(Object(en.c)((function(e){var t=e.store,n=e.item,o=n.strokeColor,a=n.strokeWidth;return n.highlighted&&(o=Mi,a=Ai),Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)(_s.Ellipse,{x:n.x,y:n.y,radiusX:n.radiusX,radiusY:n.radiusY,fill:n.fill?ho.Colors.convertToRGBA(n.fillColor,n.fillOpacity):null,stroke:o,strokeWidth:a,strokeScaleEnabled:!1,shadowBlur:0,scaleX:n.scaleX,scaleY:n.scaleY,opacity:n.opacity,rotation:n.rotation,name:n.id,onTransformEnd:function(e){var t=e.target;n.setPosition(t.getAttr("x"),t.getAttr("y"),t.getAttr("radiusX")*t.getAttr("scaleX"),t.getAttr("radiusY")*t.getAttr("scaleY"),t.getAttr("rotation")),t.setAttr("scaleX",1),t.setAttr("scaleY",1)},onDragEnd:function(e){var t=e.target;n.setPosition(t.getAttr("x"),t.getAttr("y"),t.getAttr("radiusX"),t.getAttr("radiusY"),t.getAttr("rotation")),n.setScale(t.getAttr("scaleX"),t.getAttr("scaleY"))},dragBoundFunc:n.parent.fixForZoom((function(e){var t=e.x,o=e.y,a=Object(Qt.e)(n,2),r=a.stageHeight,i=a.stageWidth;return t<0?t=0:t>i&&(t=i),o<0?o=0:o>r&&(o=r),{x:t,y:o}})),onMouseOver:function(e){var o=n.parent.stageRef;t.completionStore.selected.relationMode?(n.setHighlight(!0),o.container().style.cursor=Ei):o.container().style.cursor=Li},onMouseOut:function(e){n.parent.stageRef.container().style.cursor=Pi,t.completionStore.selected.relationMode&&n.setHighlight(!1)},onClick:function(e){var o=n.parent.stageRef;n.completion.editable&&(t.completionStore.selected.relationMode&&(o.container().style.cursor=Pi),n.setHighlight(!1),n.onClickRegion())},draggable:n.editable}),Object(Z.jsx)(Ls,{item:n})]})})));cn.addTag("ellipseregion",cd,dd);var ud=Qt.n.model({default:!0,mode:Qt.n.optional(Qt.n.enumeration(["drawing","viewing","brush","eraser"]),"viewing")}).views((function(e){return{get tagTypes(){return{stateTypes:"ellipselabels",controlTagTypes:["ellipselabels","ellipse"]}}}})).actions((function(e){return{createRegion:function(t){var n=e.control,o=cd.create(Object(f.a)({opacity:parseFloat(n.opacity),strokeWidth:Number(n.strokewidth),fillOpacity:Number(n.fillopacity)},t));return e.obj.addShape(o),o},mousedownEv:function(t,n){var o=Object(v.a)(n,2),a=o[0],r=o[1];if(("ellipselabels"!==e.control.type||e.control.isSelected)&&e.obj.checkLabels()){e.mode="drawing";var i=e.statesAndParams;return e.createRegion(Object(f.a)({x:a,y:r,radiusX:1,radiusY:1,coordstype:"px"},i))}},mousemoveEv:function(t,n){var o=Object(v.a)(n,2),a=o[0],r=o[1];"drawing"===e.mode&&e.updateDraw(a,r)},mouseupEv:function(t,n){var o=Object(v.a)(n,2);o[0],o[1];if("drawing"===e.mode){var a=e.getActiveShape;a.radiusX<js||a.radiusY<vs?(Object(Qt.b)(a),"ellipselabels"===e.control.type&&e.control.unselectAll()):e.obj.completion.highlightedNode.unselectRegion(!0),e.mode="viewing"}}}})),pd=Qt.n.compose(ws,ys,qc,ud),gd=n(888),fd=Object(en.c)((function(e){var t=e.item;return Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)($s,{selected:t.selected,icon:Object(Z.jsx)(gd.a,{}),tooltip:"Move position",onClick:function(e){var n=t.selected;(t.manager.unselectAll(),t.setSelected(!n),t.selected)&&(t.obj.stageRef.container().style.cursor="all-scroll")}}),Object(Z.jsx)($s,{icon:Object(Z.jsx)(Vr.a,{}),tooltip:"Zoom into the image",onClick:function(e){t.handleZoom(1.2)}}),Object(Z.jsx)($s,{icon:Object(Z.jsx)(Yr.a,{}),tooltip:"Zoom out of the image",onClick:function(e){t.handleZoom(.8)}})]})})),hd=Qt.n.model({}).views((function(e){return{get viewClass(){return Object(Z.jsx)(fd,{item:e})}}})).actions((function(e){return{mouseupEv:function(){e.mode="viewing"},handleDrag:function(t){var n=e._manager.obj,o=n.stageRef,a=o.scaleX(),r=o.x()+t.movementX,i=o.y()+t.movementY;r>0&&(r=0),i>0&&(i=0),n.setZoom(a,r,i),o.position({x:r,y:i}),o.batchDraw()},mousemoveEv:function(t,n){var o=Object(v.a)(n,2);o[0],o[1];e._manager.obj.stageRef.scaleX()<=1||"moving"===e.mode&&e.handleDrag(t)},mousedownEv:function(t,n){var o=Object(v.a)(n,2);o[0],o[1];e.mode="moving"},handleZoom:function(t,n){if(!t.evt||t.evt.ctrlKey){t.evt&&t.evt.ctrlKey&&t.evt.preventDefault();var o=e._manager.obj;o.freezeHistory();var a,r,i,l,s=o.stageRef,c=parseFloat(o.zoomby),d=s.scaleX();if(t.evt?(a={x:s.getPointerPosition().x/d-s.x()/d,y:s.getPointerPosition().y/d-s.y()/d},r=t.evt.deltaY>0?d*c:d/c,l={x:-(a.x-s.getPointerPosition().x/r)*r,y:-(a.y-s.getPointerPosition().y/r)*r}):(a={x:(i={x:s.width()/2,y:s.height()/2}).x/d-s.x()/d,y:i.y/d-s.y()/d},r=Math.max(.05,d*t),l={x:-(a.x-i.x/r)*r,y:-(a.y-i.y/r)*r}),!0!==o.negativezoom&&r<=1)return o.setZoom(1,0,0),s.scale({x:1,y:1}),s.position({x:0,y:0}),void s.batchDraw();s.scale({x:r,y:r}),o.setZoom(r,l.x,l.y),s.position(l),s.batchDraw()}}}})),bd=Qt.n.compose(ws,ys,hd),md=n(889),jd=n(890),vd=Object(en.c)((function(e){var t=e.item;return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)($s,{selected:t.selected,icon:Object(Z.jsx)(md.a,{}),tooltip:"Rotate Left",onClick:function(e){t.rotate(-90)}}),Object(Z.jsx)($s,{selected:t.selected,icon:Object(Z.jsx)(jd.a,{}),tooltip:"Rotate Right",onClick:function(e){t.rotate(90)}})]})})),yd=Qt.n.model({}).views((function(e){return{get viewClass(){return Object(Z.jsx)(vd,{item:e})}}})).actions((function(e){return{rotate:function(t){e.obj.rotate(t)}}})),Od=Qt.n.compose(ws,ys,yd),xd=n(892),Sd=n(891),wd=Object(en.c)(function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=Object(Z.jsx)(ja.a,{children:Object(Z.jsxs)(ja.a.Item,{children:[Object(Z.jsx)(oi.a,{defaultValue:this.props.default||15,max:this.props.max||50,value:this.props.value,min:0,vertical:!0,tipFormatter:null,style:{height:this.props.height||100},onChange:this.props.onChange}),Object(Z.jsx)(Ho.a,{shape:"circle",type:this.props.selected?"primary":"default",className:xs.a.button,onClick:this.props.onResetClick,children:Object(Z.jsx)(Sd.a,{})})]},"1")});return Object(Z.jsx)(d.Fragment,{children:Object(Z.jsx)(ya.a,{overlay:e,children:Object(Z.jsx)(Ho.a,{shape:"circle",className:xs.a.button,children:this.props.icon})})})}}]),n}(d.Component)),_d=n(284),kd=n.n(_d),Cd=Object(en.c)((function(e){var t=e.item;return Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)(wd,{default:Di,value:t.brightness,max:Wi,selected:t.selected,icon:Object(Z.jsx)(xd.a,{}),onResetClick:function(e){t.setStroke(Di)},onChange:function(e){t.setStroke(e)}}),Object(Z.jsx)("span",{className:kd.a.tooltitle,children:"Brightness"})]})})),Nd=Qt.n.model({brightness:Qt.n.optional(Qt.n.number,Di)}).views((function(e){return{get viewClass(){return Object(Z.jsx)(Cd,{item:e})}}})).actions((function(e){return{setStroke:function(t){e.brightness=t,e.obj.setBrightnessGrade(t)}}})),Td=Qt.n.compose(ws,ys,Nd),Rd=Object(en.c)((function(e){var t=e.item;return Object(Z.jsxs)(d.Fragment,{children:[Object(Z.jsx)(wd,{default:Ui,value:t.contrast,max:Bi,selected:t.selected,icon:Object(Z.jsx)(xd.a,{}),onResetClick:function(e){t.setStroke(Ui)},onChange:function(e){t.setStroke(e)}}),Object(Z.jsx)("span",{className:kd.a.tooltitle,children:"Contrast"})]})})),Md=Qt.n.model({contrast:Qt.n.optional(Qt.n.number,Ui)}).views((function(e){return{get viewClass(){return Object(Z.jsx)(Rd,{item:e})}}})).actions((function(e){return{setStroke:function(t){e.contrast=t,e.obj.setContrastGrade(t)}}})),Ad=Qt.n.compose(ws,ys,Md),zd=Object(en.c)((function(e){var t=e.item;return Object(Z.jsx)(Ss,{max:50,default:10,selected:t.selected,icon:"tool",onClick:function(e){var n=t.selected;t.manager.unselectAll(),t.setSelected(!n)},onChange:function(e){t.setThreshold(e)}})})),Pd=Qt.n.model({threshold:Qt.n.optional(Qt.n.number,10)}).views((function(e){return{get viewClass(){return Object(Z.jsx)(zd,{item:e})}}})).actions((function(e){return{setThreshold:function(t){e.threshold=t},mouseupEv:function(){e.mode="viewing"},mousemoveEv:function(t,n){var o=Object(v.a)(n,2);o[0],o[1];e.mode},createPolygonRegion:function(t){var n=e.statesAndParams,o=n.states,a=n.strokecolor,r=e.control,i=Rc.create({id:pn(),opacity:parseFloat(r.opacity),fillcolor:r.fillcolor,strokewidth:parseInt(r.strokewidth),strokecolor:a,pointsize:r.pointsize,pointstyle:r.pointstyle,states:o,coordstype:"px"});return t.forEach((function(e){return i.addPoint(e.x,e.y)})),e.obj.addShape(i),i.closePoly(),i},clickEv:function(t,n){var o=Object(v.a)(n,2),a=o[0],r=o[1],i=e.obj,l=Dn(En(i.imageRef).data,i.naturalWidth,i.naturalHeight,a,r,e.threshold,!0);l&&e.createPolygonRegion(l),e.control.unselectAll()},mousedownEv:function(t,n){var o=Object(v.a)(n,2);o[0],o[1];e.mode="drawing"}}})),Id=Qt.n.compose(ws,Pd,ys),Ld=Object(en.c)(function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e,t,n,o=this.props.item,a=(e=Math.ceil(o.stageWidth/o.gridSize),t=Math.ceil(o.stageHeight/o.gridSize),n=o.gridSize,Object(bs.a)(Array(e)).map((function(e,o){return Object(bs.a)(Array(t)).map((function(e,t){return{col:o,row:t,x:o*n,y:t*n,fill:"#fff"}}))})).reduce((function(e,t){return[].concat(Object(bs.a)(e),Object(bs.a)(t))})));return Object(Z.jsx)(_s.Layer,{opacity:.15,name:"ruler",children:Object.values(a).map((function(e,t){return Object(Z.jsx)(_s.Rect,{x:e.x,y:e.y,width:o.gridSize,height:o.gridSize,stroke:o.gridColor,strokeWidth:1},t)}))})}}]),n}(d.Component)),Hd=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.checkNode()}},{key:"componentDidUpdate",value:function(){this.checkNode()}},{key:"checkNode",value:function(){if(this.transformer){var e=this.transformer.getStage(),t=this.props.selectedShape;if(!t)return this.transformer.detach(),void this.transformer.getLayer().batchDraw();if(t.supportsTransform){var n=e.findOne("."+t.id);n!==this.transformer.node()&&(n?this.transformer.attachTo(n):this.transformer.detach(),this.transformer.getLayer().batchDraw())}}}},{key:"render",value:function(){var e=this;return this.props.selectedShape.supportsTransform?Object(Z.jsx)(_s.Transformer,{resizeEnabled:!0,ignoreStroke:!0,keepRatio:!1,rotateEnabled:this.props.rotateEnabled,borderDash:[3,1],boundBoxFunc:function(e,t){return t.width=Math.max(3,t.width),t.height=Math.max(3,t.height),t},anchorSize:8,ref:function(t){e.transformer=t}}):null}}]),n}(d.Component),Ed=n(238),Dd=n.n(Ed),Wd=Object(en.c)(function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(h.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).handleOnClick=function(t){return e.props.item.event("click",t,t.evt.offsetX,t.evt.offsetY)},e.handleMouseDown=function(t){var n=e.props.item,o=t.target.getParent();if(!o||"Transformer"!==o.className){if(t.target===t.target.getStage()||t.target.parent&&("ruler"===t.target.parent.attrs.name||"segmentation"===t.target.parent.attrs.name)){window.addEventListener("mousemove",e.handleGlobalMouseMove),window.addEventListener("mouseup",e.handleGlobalMouseUp);var a=t.evt,r=a.offsetX,i=a.offsetY,l=e.container.getBoundingClientRect(),s=l.left,c=l.top;return e.canvasX=s,e.canvasY=c,n.event("mousedown",t,r,i)}return!0}},e.handleGlobalMouseUp=function(t){if(window.removeEventListener("mousemove",e.handleGlobalMouseMove),window.removeEventListener("mouseup",e.handleGlobalMouseUp),!t.target||"CANVAS"!==t.target.tagName){var n=e.props.item,o=t.clientX,a=t.clientY;return n.freezeHistory(),n.event("mouseup",t,o-e.canvasX,a-e.canvasY)}},e.handleGlobalMouseMove=function(t){if(!t.target||"CANVAS"!==t.target.tagName){var n=e.props.item,o=t.clientX,a=t.clientY;return n.event("mousemove",t,o-e.canvasX,a-e.canvasY)}},e.handleMouseUp=function(t){var n=e.props.item;return n.freezeHistory(),n.event("mouseup",t,t.evt.offsetX,t.evt.offsetY)},e.handleMouseMove=function(t){var n=e.props.item;n.freezeHistory();var o=n.stageRef,a=o.scaleX();if(!(t.evt&&(4===t.evt.buttons||1===t.evt.buttons&&t.evt.shiftKey)&&a>1))return n.event("mousemove",t,t.evt.offsetX,t.evt.offsetY);t.evt.preventDefault();var r={x:o.x()+t.evt.movementX,y:o.y()+t.evt.movementY};n.setZoom(a,r.x,r.y),o.position(r),o.batchDraw()},e.updateGridSize=function(t){var n=e.props.item;n.freezeHistory(),n.setGridSize(t)},e.handleZoom=function(t){if(!t.evt||t.evt.ctrlKey){t.evt&&t.evt.ctrlKey&&t.evt.preventDefault();var n=e.props.item;n.freezeHistory();var o,a,r,i,l=n.stageRef,s=parseFloat(n.zoomby),c=l.scaleX();if(t.evt?(o={x:l.getPointerPosition().x/c-l.x()/c,y:l.getPointerPosition().y/c-l.y()/c},a=t.evt.deltaY>0?c*s:c/s,i={x:-(o.x-l.getPointerPosition().x/a)*a,y:-(o.y-l.getPointerPosition().y/a)*a}):(o={x:(r={x:l.width()/2,y:l.height()/2}).x/c-l.x()/c,y:r.y/c-l.y()/c},a=Math.max(.05,c*t),i={x:-(o.x-r.x/a)*a,y:-(o.y-r.y/a)*a}),!0!==n.negativezoom&&a<=1)return n.setZoom(1,0,0),l.scale({x:1,y:1}),l.position({x:0,y:0}),void l.batchDraw();l.scale({x:a,y:a}),n.setZoom(a,i.x,i.y),l.position(i),l.batchDraw()}},e.onResize=function(){e.props.item.onResize(e.container.offsetWidth,e.container.offsetHeight,!0)},e}return Object(b.a)(n,[{key:"renderRulers",value:function(){var e=this.props.item,t="white";return Object(Z.jsxs)(_s.Group,{name:"ruler",onClick:function(e){e.cancelBubble=!1},children:[Object(Z.jsx)(_s.Line,{x:0,y:e.cursorPositionY,points:[0,0,e.stageWidth,0],strokeWidth:1,stroke:t,tension:0,dash:[4,4],closed:!0}),Object(Z.jsx)(_s.Line,{x:e.cursorPositionX,y:0,points:[0,0,0,e.stageHeight],strokeWidth:1,stroke:t,tension:0,dash:[1.5],closed:!0})]})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"renderTools",value:function(){var e=this.props,t=e.item,n=e.store.completionStore;return n.viewingAllCompletions||n.viewingAllPredictions?null:Object(Z.jsx)("div",{className:Dd.a.block,children:t.getToolsManager().allTools().map((function(e){return e.viewClass}))})}},{key:"render",value:function(){var e=this,t=this.props,n=t.item;if(!t.store.task||!n._value)return null;var o=n.controlButton(),a=null,r=Dd.a.container,i={},l={width:n.width,transformOrigin:"left top",filter:"brightness(".concat(n.brightnessGrade,"%) contrast(").concat(n.contrastGrade,"%)")},s=[];if(!1===Object(Qt.g)(n).settings.imageFullSize&&(i.maxWidth=n.maxwidth),1!==n.zoomScale){var c=n.zoomingPositionX,d=n.zoomingPositionY;s.push("translate("+c+"px,"+d+"px)"),s.push("scale("+n.resize+", "+n.resize+")")}if(n.rotation){if(s.push("rotate(".concat(n.rotation,"deg)")),s.push("translate(".concat({90:"0, -100%",180:"-100%, -100%",270:"-100%, 0"}[n.rotation]||"0, 0",")")),[90,270].includes(n.rotation)){var u=n.naturalHeight/n.naturalWidth;a=Object(Z.jsx)("div",{className:Dd.a.filler,style:{marginTop:"".concat(100*u,"%")}}),r+=" "+Dd.a.rotated,l.width="".concat(100*u,"%")}}return s.length&&(l.transform=s.join(" ")),Object(Z.jsxs)(Wr,{item:n,style:{position:"relative",display:"flex",alignItems:"flex-start",justifyContent:"space-between",direction:"ltr"},children:[Object(Z.jsxs)("div",{ref:function(t){e.container=t},className:r,style:i,children:[a,Object(Z.jsx)("img",{ref:function(e){n.setImageRef(e)},style:l,src:n._value,onLoad:n.updateImageSize,onClick:this.handleOnClick,alt:"LS"})]}),Object(Z.jsxs)(_s.Stage,{ref:function(e){n.setStageRef(e)},style:{position:"absolute",top:0,left:0,brightness:"150%"},className:"image-element",width:n.stageWidth,height:n.stageHeight,scaleX:n.scale,scaleY:n.scale,x:n.zoomingPositionX,y:n.zoomingPositionY,onClick:this.handleOnClick,onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp,onWheel:n.zoom?this.handleZoom:function(){},children:[n.grid&&n.sizeUpdated&&Object(Z.jsx)(Ld,{item:n}),n.regions.filter((function(e){return"brushregion"===e.type})).map((function(e){return Object(Z.jsx)(_s.Layer,{name:"brushLayer-"+e.id,id:e.id,children:vn.renderItem(e)})})),Object(Z.jsxs)(_s.Layer,{name:"shapes",children:[n.regions.filter((function(e){return"brushregion"!==e.type})).map((function(e){return vn.renderItem(e)})),n.activeShape&&vn.renderItem(n.activeShape),n.selectedShape&&n.selectedShape.editable&&Object(Z.jsx)(Hd,{rotateEnabled:o&&o.canrotate,selectedShape:n.selectedShape})]})]}),this.renderTools()]})}}]),n}(d.Component)),Ud=function(){function e(t){var n=t.obj;Object(h.a)(this,e),this.obj=n,this.tools={},this._default_tool=null}return Object(b.a)(e,[{key:"addTool",value:function(e,t){this.tools[e]=t,t._manager=this,t.default&&(this._default_tool=t)}},{key:"unselectAll",value:function(){Object.values(this.tools).forEach((function(e){"undefined"!==typeof e.selected&&e.setSelected(!1)})),this.obj.stageRef.container().style.cursor="default"}},{key:"allTools",value:function(){return Object.values(this.tools)}},{key:"addToolsFromControl",value:function(e){var t=this;if(e.tools){var n=e.tools;Object.keys(n).forEach((function(e){t.addTool(e,n[e])}))}}},{key:"findSelectedTool",value:function(){return Object.values(this.tools).find((function(e){return e.selected}))}},{key:"event",value:function(e,t){for(var n=this.findSelectedTool(),o=arguments.length,a=new Array(o>2?o-2:0),r=2;r<o;r++)a[r-2]=arguments[r];n?n.event(e,t,a):this._default_tool&&this._default_tool.event(e,t,a)}}]),e}(),Bd=Ud,Xd=Qt.n.model({name:Qt.n.maybeNull(Qt.n.string),value:Qt.n.maybeNull(Qt.n.string),resize:Qt.n.maybeNull(Qt.n.number),width:Qt.n.optional(Qt.n.string,"100%"),maxwidth:Qt.n.optional(Qt.n.string,"750px"),grid:Qt.n.optional(Qt.n.boolean,!1),gridSize:Qt.n.optional(Qt.n.number,30),gridColor:Qt.n.optional(Qt.n.string,"#EEEEF4"),zoom:Qt.n.optional(Qt.n.boolean,!1),negativezoom:Qt.n.optional(Qt.n.boolean,!1),zoomby:Qt.n.optional(Qt.n.string,"1.1"),showlabels:Qt.n.optional(Qt.n.boolean,!1),zoomcontrol:Qt.n.optional(Qt.n.boolean,!1),brightnesscontrol:Qt.n.optional(Qt.n.boolean,!1),contrastcontrol:Qt.n.optional(Qt.n.boolean,!1),rotatecontrol:Qt.n.optional(Qt.n.boolean,!1)}),Fd="rectanglelabels",Yd="brushlabels",Vd="ellipselabels",Jd=Qt.n.model({id:Qt.n.identifier,type:"image",_value:Qt.n.optional(Qt.n.string,""),rotation:Qt.n.optional(Qt.n.number,0),sizeUpdated:Qt.n.optional(Qt.n.boolean,!1),naturalWidth:Qt.n.optional(Qt.n.integer,1),naturalHeight:Qt.n.optional(Qt.n.integer,1),initialWidth:Qt.n.optional(Qt.n.integer,1),initialHeight:Qt.n.optional(Qt.n.integer,1),stageWidth:Qt.n.optional(Qt.n.integer,1),stageHeight:Qt.n.optional(Qt.n.integer,1),zoomScale:Qt.n.optional(Qt.n.number,1),zoomingPositionX:Qt.n.maybeNull(Qt.n.number),zoomingPositionY:Qt.n.maybeNull(Qt.n.number),brightnessGrade:Qt.n.optional(Qt.n.number,100),contrastGrade:Qt.n.optional(Qt.n.number,100),cursorPositionX:Qt.n.optional(Qt.n.number,0),cursorPositionY:Qt.n.optional(Qt.n.number,0),brushControl:Qt.n.optional(Qt.n.string,"brush"),brushStrokeWidth:Qt.n.optional(Qt.n.number,15),mode:Qt.n.optional(Qt.n.enumeration(["drawing","viewing","brush","eraser"]),"viewing"),selectedShape:Qt.n.safeReference(Qt.n.union(Xs,Gc,cd,Rc,pc)),regions:Qt.n.array(Qt.n.union(Xs,Gc,cd,Rc,pc),[])}).views((function(e){return{get hasStates(){var t=e.states();return t&&t.length>0},get completion(){return Object(Qt.g)(e).completionStore.selected},states:function(){return e.completion.toNames.get(e.name)},activeStates:function(){var t=e.states();return t&&t.filter((function(e){return e.isSelected&&e._type.includes("labels")}))},controlButton:function(){var t=e.states();if(t&&0!==t.length){var n=t[0];return t.forEach((function(e){e.type!==Fd&&e.type!==Yd&&e.type!==Vd||(n=e)})),n}},get controlButtonType(){var t=e.controlButton();return Object(Qt.i)(t).name}}})).actions((function(e){var t=new Bd({obj:e});return{afterCreate:function(){e.zoomcontrol&&t.addTool("zoom",bd.create({},{manager:t})),e.brightnesscontrol&&t.addTool("brightness",Td.create({},{manager:t})),e.contrastcontrol&&t.addTool("contrast",Ad.create({},{manager:t})),e.rotatecontrol&&t.addTool("rotate",Od.create({},{manager:t}))},getToolsManager:function(){return t}}})).actions((function(e){return{freezeHistory:function(){},updateBrushControl:function(t){e.brushControl=t},updateBrushStrokeWidth:function(t){e.brushStrokeWidth=t},setBrightnessGrade:function(t){e.brightnessGrade=t},setContrastGrade:function(t){e.contrastGrade=t},setGridSize:function(t){e.gridSize=t},setPointerPosition:function(t){var n=t.x,o=t.y;e.freezeHistory(),e.cursorPositionX=n,e.cursorPositionY=o},setZoom:function(t,n,o){e.resize=t,e.zoomScale=t,e.zoomingPositionX=n,e.zoomingPositionY=o},setZoomPosition:function(t,n){e.zoomingPositionX=t,e.zoomingPositionY=n},setMode:function(t){e.mode=t},setImageRef:function(t){e.imageRef=t},setStageRef:function(t){e.stageRef=t,e.initialWidth=t&&t.attrs&&t.attrs.width?t.attrs.width:1,e.initialHeight=t&&t.attrs&&t.attrs.height?t.attrs.height:1},setSelected:function(t){e.selectedShape=t},rotate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-90;e.rotation=(e.rotation+t+360)%360;var n=e.stageWidth;e.stageWidth=e.stageHeight,e.stageHeight=n;var o=e.naturalWidth;e.naturalWidth=e.naturalHeight,e.naturalHeight=o;var a=e.stageHeight/e.stageWidth;e.regions.forEach((function(e){return e.rotate(t)})),e._updateImageSize({width:n,height:Math.round(a*n),naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight})},_updateImageSize:function(t){var n=t.width,o=t.height,a=t.naturalWidth,r=t.naturalHeight,i=t.userResize;void 0!==a&&(e.naturalWidth=a,e.naturalHeight=r),e.stageWidth=n,e.stageHeight=o,e.sizeUpdated=!0,e.regions.forEach((function(e){e.updateImageSize(n/a,o/r,n,o,i)}))},updateImageSize:function(t){var n=t.target,o=n.width,a=n.height,r=n.naturalWidth,i=n.naturalHeight;(e.rotation+360)%180===90?e._updateImageSize({width:a,height:o,naturalWidth:i,naturalHeight:r}):e._updateImageSize({width:o,height:a,naturalWidth:r,naturalHeight:i})},checkLabels:function(){var t=(e.states()||[]).filter((function(e){return e.type.includes("labels")}));return 0!==e.getAvailableStates().length||0===t.length},addShape:function(t){e.regions.push(t),e.completion.addRegion(t),e.setSelected(t.id),t.selectRegion()},fixZoomedCoords:function(t){var n=Object(v.a)(t,2),o=n[0],a=n[1];return[(o-e.zoomingPositionX)/e.zoomScale,(a-e.zoomingPositionY)/e.zoomScale]},zoomOriginalCoords:function(t){var n=Object(v.a)(t,2),o=n[0],a=n[1];return[o*e.zoomScale+e.zoomingPositionX,a*e.zoomScale+e.zoomingPositionY]},fixForZoom:function(t){return function(n){var o=void 0===n.x,a=e.fixZoomedCoords(o?n:[n.x,n.y]),r=Object(v.a)(a,2),i=r[0],l=r[1],s=t(o?[i,l]:{x:i,y:l}),c=e.zoomOriginalCoords(o?s:[s.x,s.y]);return o?c:{x:c[0],y:c[1]}}},onResize:function(t,n,o){e._updateImageSize({width:t,height:n,userResize:o})},event:function(t,n){for(var o,a=arguments.length,r=new Array(a>2?a-2:0),i=2;i<a;i++)r[i-2]=arguments[i];(o=e.getToolsManager()).event.apply(o,[t,n.evt||n].concat(Object(bs.a)(e.fixZoomedCoords(r))))},fromStateJSON:function(t,n){var o=e.getToolsManager().allTools();0===o.length&&t.value.choices?e.completion.names.get(t.from_name).fromStateJSON(t):o.forEach((function(e){return e.fromStateJSON&&e.fromStateJSON(t,n)}))}}})),Gd=Qt.n.compose("ImageModel",Xd,Jd,fi,Er),Kd=Object(en.b)("store")(Object(en.c)(Wd));cn.addTag("image",Gd,Kd);var qd=Qt.n.model("TextRegionModel",{type:"textrange",startOffset:Qt.n.integer,start:Qt.n.string,endOffset:Qt.n.integer,end:Qt.n.string,text:Qt.n.string,states:Qt.n.maybeNull(Qt.n.array(Qt.n.union(El,ul,kl,Fl)))}).views((function(e){return{get parent(){return Object(Qt.f)(e,nu)}}})).actions((function(e){return{beforeDestroy:function(){ho.HTML.removeSpans(e._spans)},setText:function(t){e.text=t},serialize:function(t,n){var o={value:{start:e.startOffset,end:e.endOffset}};return"yes"===n.savetextresult&&(o.value.text=e.text),o.value=Object.assign(o.value,t.serializableValue),o}}})),Zd=Qt.n.compose("TextRegionModel",Si,Yi,Xi,qd,es),$d=n(454),Qd=n.n($d),eu=Qt.n.model("TextModel",{name:Qt.n.maybeNull(Qt.n.string),value:Qt.n.maybeNull(Qt.n.string),valuetype:Qt.n.optional(Qt.n.enumeration(["text","url"]),"text"),savetextresult:Qt.n.optional(Qt.n.enumeration(["none","no","yes"]),"none"),selectionenabled:Qt.n.optional(Qt.n.boolean,!0),highlightcolor:Qt.n.maybeNull(Qt.n.string),showlabels:Qt.n.optional(Qt.n.boolean,!0),granularity:Qt.n.optional(Qt.n.enumeration(["symbol","word","sentence","paragraph"]),"symbol"),encoding:Qt.n.optional(Qt.n.enumeration(["none","base64","base64unicode"]),"none")}),tu=Qt.n.model("TextModel",{id:Qt.n.optional(Qt.n.identifier,pn),type:"text",loaded:Qt.n.optional(Qt.n.boolean,!1),regions:Qt.n.array(Zd),_value:Qt.n.optional(Qt.n.string,""),_update:Qt.n.optional(Qt.n.number,1)}).views((function(e){return{get hasStates(){var t=e.states();return t&&t.length>0},get completion(){return Object(Qt.g)(e).completionStore.selected},states:function(){return e.completion.toNames.get(e.name)},activeStates:function(){var t=e.states();return t&&t.filter((function(e){return e.isSelected&&"labels"===e._type}))}}})).actions((function(e){return{setRef:function(t){e._ref=t},needsUpdate:function(){e._update=e._update+1},updateValue:function(t){if(e._value=gi(e.value,t.task.dataObj),"url"===e.valuetype){var n=e._value;if(!/^https?:\/\//.test(n))return Lr.error("URL (".concat(n,") is not valid")),void e.loadedValue("");fetch(n).then((function(e){if(!e.ok)throw new Error("".concat(e.status," ").concat(e.statusText));return e.text()})).then(e.loadedValue).catch((function(t){Lr.error("Loading URL (".concat(n,") unsuccessful: ").concat(t)),e.loadedValue("")}))}else e.loadedValue(e._value)},loadedValue:function(t){e.loaded=!0,"base64"===e.encoding&&(t=atob(t)),"base64unicode"===e.encoding&&(t=ho.Checkers.atobUnicode(t)),e._value=t,e._regionsCache.forEach((function(t){var n=t.region,o=t.completion;n.setText(e._value.substring(n.startOffset,n.endOffset)),e.regions.push(n),o.addRegion(n)})),e._regionsCache=[]},afterCreate:function(){e._regionsCache=[],"none"===e.savetextresult&&("url"===e.valuetype?e.savetextresult="no":"text"===e.valuetype&&(e.savetextresult="yes"))},createRegion:function(t){var n=Zd.create(t);if(n._range=t._range,"url"!==e.valuetype||!1!==e.loaded)return e.regions.push(n),e.completion.addRegion(n),n;e._regionsCache.push({region:n,completion:e.completion})},addRegion:function(t){var n=e.getAvailableStates();if(0!==n.length){var o=n.map((function(e){return gn(e)}));return e.createRegion(Object(f.a)(Object(f.a)({},t),{},{states:o}))}},fromStateJSON:function(t,n){var o,a,r=e.completion.names.get(t.from_name);if(r.fromStateJSON(t),r.perregion||"labels"===n.type){var i=t.value,l=i.start,s=i.end;if(o=e.findRegion({startOffset:t.value.start,endOffset:t.value.end}),n)if(a=fn(n),o&&n.perregion)o.states.push(a);else{var c={pid:t.id,parentID:null===t.parent_id?"":t.parent_id,startOffset:l,endOffset:s,start:"",end:"",score:t.score,readonly:t.readonly,text:e._value.substring(l,s),normalization:t.normalization,states:[a]};o=e.createRegion(c)}return o}}}})),nu=Qt.n.compose("TextModel",Yi,eu,tu,Er),ou=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.store;return t._value?Object(Z.jsx)(iu,{store:n,item:t}):null}}]),n}(d.Component),au=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).myRef=u.a.createRef(),o}return Object(b.a)(n,[{key:"getValue",value:function(){var e=this.props,t=e.item,n=e.store,o=gi(t.value,n.task.dataObj);return"base64"===t.encoding&&(o=atob(o)),"base64unicode"===t.encoding&&(o=ho.Checkers.atobUnicode(o)),o}},{key:"alignWord",value:function(e,t,n){var o=this.getValue(),a=o.substring(0,t),r=e.cloneRange();if(a.length>0){var i=a.lastIndexOf(" "),l=a.lastIndexOf("\n"),s=i>l?i:l;if(-1===s&&r.setStart(e.startContainer,0),s>0){var c=ho.HTML.findIdxContainer(this.myRef,s+1),d=c.node,u=c.len;r.setStart(d,u)}}var p=o.substring(n,o.length);if(p.length>0){var g,f=p.indexOf(" "),h=p.indexOf("\n");if(-1===h&&(g=f),-1===f&&(g=h),h>0&&f>0&&(g=f>h?h:f),-1===(g+=n)&&r.setEnd(e.endContainer,e.endContainer.length),g>0){var b=ho.HTML.findIdxContainer(this.myRef,g+1),m=b.node,j=b.len;r.setEnd(m,j>0?j-1:0)}}return r}},{key:"alignRange",value:function(e){var t=this.props.item;if("symbol"===t.granularity)return e;var n=ho.HTML.mainOffsets(this.myRef),o=n.start,a=n.end;if("word"===t.granularity)return this.alignWord(e,o,a);t.granularity,t.granularity}},{key:"captureDocumentSelection",value:function(){var e,t=this,n=[],o=[],a=window.getSelection();if(a.isCollapsed)return[];for(e=0;e<a.rangeCount;e++){var r=a.getRangeAt(e);if("DIV"===r.endContainer.nodeName&&r.setEnd(r.startContainer,r.startContainer.length),!(r=this.alignRange(r)).collapsed&&!/^\s*$/.test(r.toString()))try{var i=Ql.fromRange(r,t.myRef);co(r),i._range=r;var l=Array.from(r.cloneContents().childNodes).reduce((function(e,t){return e+("BR"===t.tagName?"\n":t.textContent)}),"");i.text=l;var s=ho.HTML.toGlobalOffset(t.myRef,r.startContainer,r.startOffset),c=ho.HTML.toGlobalOffset(t.myRef,r.endContainer,r.endOffset);i.startOffset=s,i.endOffset=c,null===i?o.push(r):n.push(i)}catch(d){}}return a.removeAllRanges(),n}},{key:"onClick",value:function(e){}},{key:"onMouseUp",value:function(e){var t=this.props.item;if(t.selectionenabled){var n=t.activeStates();if(n&&0!==n.length){var o=this.captureDocumentSelection();if(0!==o.length){t._currentSpan=null;var a=t.addRegion(o[0]);if(a){var r=a.createSpans();a.addEventsToSpans(r)}}}}}},{key:"_handleUpdate",value:function(){var e=this.myRef;this.props.item.regions.forEach((function(t){var n=function(e,t){var n=t;return function e(t){if("#text"===t.nodeName){if(n-t.length<=0)return{node:t,left:n};n-=t.length}if("BR"===t.nodeName){if(n-1<0)return{node:t,left:n};n-=1}for(var o=0;o<=t.childNodes.length;o++){var a=t.childNodes[o];if(a){var r=e(a);if(r)return r}}}(e)},o=n(e,t.startOffset),a=n(e,t.endOffset),r=document.createRange();r.setStart(o.node,o.left),r.setEnd(a.node,a.left),co(r),t._range=r;var i=t.createSpans();t.addEventsToSpans(i)}))}},{key:"componentDidUpdate",value:function(){this._handleUpdate()}},{key:"componentDidMount",value:function(){this._handleUpdate()}},{key:"render",value:function(){var e=this,t=this.props.item;if(!t.loaded)return null;var n=t._value.split("\n").reduce((function(e,t,n){return n&&e.push(Object(Z.jsx)("br",{},n)),e.push(t),e}),[]);return Object(Z.jsx)(Wr,{item:t,children:Object(Z.jsx)("div",{ref:function(n){e.myRef=n,t.setRef(n)},className:Qd.a.block+" htx-text","data-update":t._update,onMouseUp:this.onMouseUp.bind(this),children:n})})}}]),n}(d.Component),ru=Object(en.b)("store")(Object(en.c)(ou)),iu=Object(en.b)("store")(Object(en.c)(au));cn.addTag("text",nu,ru);var lu=n(202),su=n.n(lu),cu=n(157),du=Qt.n.model({backgroundColor:Qt.n.optional(Qt.n.string,"transparent"),value:Qt.n.maybeNull(Qt.n.string),_value:Qt.n.maybeNull(Qt.n.string),selected:Qt.n.optional(Qt.n.boolean,!1),idx:Qt.n.number}).views((function(e){return{}})).actions((function(e){return{setBG:function(t){e.backgroundColor=t},setIdx:function(t){e.idx=t},setSelected:function(t){e.selected=t}}})),uu=Qt.n.model({axis:Qt.n.optional(Qt.n.string,"y"),lockaxis:Qt.n.maybeNull(Qt.n.string),elementvalue:Qt.n.maybeNull(Qt.n.string),elementtag:Qt.n.optional(Qt.n.string,"Text"),sortedhighlightcolor:Qt.n.maybeNull(Qt.n.string),name:Qt.n.maybeNull(Qt.n.string),value:Qt.n.maybeNull(Qt.n.string)}),pu=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),type:"list",update:Qt.n.optional(Qt.n.number,1),regions:Qt.n.array(du)}).views((function(e){return{}})).actions((function(e){return{setUpdate:function(){e.update=e.update+1},addRegion:function(t,n){var o=du.create({value:e.elementvalue,idx:n,_value:pi(e.elementvalue,t[n])});e.regions.push(o)},updateValue:function(t){var n=pi(e.value,t.task.dataObj);e.regions=[],n.forEach((function(t,o){return e.addRegion(n,o)})),n.forEach((function(e,t){e._orig_idx=t})),e._value=n,e.setUpdate()},moveItems:function(t){var n=t.oldIndex,o=t.newIndex;n!==o&&(e.sortedhighlightcolor&&e.regions[n].setBG(e.sortedhighlightcolor),e.regions[n].setSelected(!0),e._value&&(e._value=su()(e._value,n,o)),e.regions=su()(e.regions,n,o),e.setUpdate())},toStateJSON:function(){var t={};e._value.forEach((function(n,o){t[e.regions[o].idx]=1/(1+o)}));for(var n=Object.keys(t).sort((function(e,t){return e-t})).map((function(e){return t[e]})),o=[],a=0;a<Object.keys(t).length;a++)o[e.regions[a].idx]=e.regions[a].selected?1:0;return{from_name:e.name,to_name:e.name,value:{weights:n,selected:o}}},fromStateJSON:function(t,n){var o=[],a=[],r={};t.value.weights.forEach((function(e,t){r[e]?r[e].push(t):r[e]=[t]})),Object.keys(r).sort((function(e,t){return t-e})).forEach((function(t){r[t].forEach((function(t){a.push(e.regions[t]),o.push(e._value[t])}))})),a.forEach((function(e,t){return e.setIdx(t)})),e._value=o,e.regions=a,e.setUpdate()}}})),gu=Qt.n.compose("ListModel",uu,pu),fu=Object(cu.c)((function(){return Object(Z.jsx)("div",{className:"drag-handle"})}));function hu(){try{return"undefined"!==typeof window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")}catch(e){return!1}}var bu=Object(cu.b)((function(e){var t,n=e.item,o=e.value;hu&&(t="noselect");var a={text:function(e){return Object(Z.jsx)("span",{className:t,children:e._value})},image:function(e){return Object(Z.jsx)("img",{src:e._value,alt:""})},audio:function(e){return Object(Z.jsx)("audio",{src:e._value})}};return Object(Z.jsxs)("div",{style:{padding:"1em",userSelect:"none",display:"flex",alignItems:"center",background:o.selected?n.sortedhighlightcolor:"transparent"},className:t,onClick:function(e){return o.selected?(o.setSelected(!1),n.setUpdate()):(o.setSelected(!0),n.setUpdate()),e.preventDefault(),!1},children:[Object(Z.jsx)(fu,{}),a[n.elementtag.toLowerCase()](o)]})})),mu=Object(cu.a)((function(e){var t=e.item,n=e.items;return Object(Z.jsx)(Ko.b,{celled:!0,children:n.map((function(e,n){return Object(Z.jsx)(bu,{index:n,value:e,color:e.backgroundColor,item:t,onClick:function(e){}},"item-".concat(n))}))})})),ju=Object(en.c)((function(e){e.store;var t=e.item,n={};return hu()?n.pressDelay=100:n.distance=7,Object(Z.jsx)("div",{children:Object(Z.jsx)(mu,Object(f.a)({update:t.update,item:t,items:t.regions,onSortEnd:t.moveItems},n))})})),vu=Object(en.b)("store")(Object(en.c)(ju));cn.addTag("list",gu,vu);var yu=Qt.n.model({name:Qt.n.string,toname:Qt.n.maybeNull(Qt.n.string),selectionstyle:Qt.n.maybeNull(Qt.n.string),leftclass:Qt.n.maybeNull(Qt.n.string),rightclass:Qt.n.maybeNull(Qt.n.string)}),Ou=Qt.n.model({id:Qt.n.identifier,type:"pairwise",selected:Qt.n.maybeNull(Qt.n.enumeration(["left","right","none"]))}).views((function(e){return{get completion(){return $i.getParentOfTypeString(e,"Completion")}}})).actions((function(e){return{selectLeft:function(){"left"===e.selected?e.selected="none":e.selected="left"},selectRight:function(){"right"===e.selected?e.selected="none":e.selected="right"},afterCreate:function(){var t={};if(e.selectionstyle){var n=vn.cssConverter(e.selectionstyle);for(var o in n)t[o]=n[o]}else t={backgroundColor:"#f6ffed",border:"1px solid #b7eb8f"};e._selection=t},getLeftRight:function(){e.toname;var t=e.toname.split(",");return 2!==t.length&&Lr.error("Incorrect toName parameter on Pairwise, should be two names separated by the comma: name1,name2"),{left:e.completion.names.get(t[0]),right:e.completion.names.get(t[1])}},completionAttached:function(){var t=e.getLeftRight(),n=t.left,o=t.right;n.addProp("onClick",(function(){e.selectLeft(),n.addProp("style",e._selection),o.addProp("style",{})})),o.addProp("onClick",(function(){e.selectRight(),o.addProp("style",e._selection),n.addProp("style",{})}))},toStateJSON:function(){var t=Object(Qt.g)(e),n="left"===e.selected?e.leftclass:"right"===e.selected?e.rightclass:null;console.log(e.rightclass),console.log(e.selected),console.log(n),console.log(e.rightclass),null!==n&&(n=[gi(n,t.task.dataObj)]);var o={id:e.pid,from_name:e.name,to_name:e.name,type:"pairwise",value:{selected:e.selected}};return null!==n&&(o.value.pairwise=n),o},fromStateJSON:function(t,n){t.id&&(e.pid=t.id),e.selected=t.value.selected;var o=e.getLeftRight(),a=o.left,r=o.right;"left"===e.selected&&a.addProp("style",e._selection),"right"===e.selected&&r.addProp("style",e._selection)}}})),xu=Qt.n.compose("PairwiseModel",yu,Ou,ll);cn.addTag("pairwise",xu,(function(){return null}));var Su=Qt.n.model({backgroundColor:Qt.n.optional(Qt.n.string,"transparent"),value:Qt.n.maybeNull(Qt.n.string),_value:Qt.n.maybeNull(Qt.n.string),selected:Qt.n.optional(Qt.n.boolean,!1),idx:Qt.n.number}).views((function(e){return{}})).actions((function(e){return{setBG:function(t){e.backgroundColor=t},setIdx:function(t){e.idx=t},setSelected:function(t){e.selected=t}}})),wu=Qt.n.model({axis:Qt.n.optional(Qt.n.string,"y"),lockaxis:Qt.n.maybeNull(Qt.n.string),elementtag:Qt.n.optional(Qt.n.string,"Text"),ranked:Qt.n.optional(Qt.n.boolean,!0),sortable:Qt.n.optional(Qt.n.boolean,!0),sortedhighlightcolor:Qt.n.maybeNull(Qt.n.string),name:Qt.n.maybeNull(Qt.n.string),value:Qt.n.maybeNull(Qt.n.string)}),_u=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),type:"ranker",update:Qt.n.optional(Qt.n.number,1),regions:Qt.n.array(Su)}).views((function(e){return{}})).actions((function(e){return{setUpdate:function(){e.update=e.update+1},_addRegion:function(t,n){var o=Su.create({value:t,idx:n,_value:t});e.regions.push(o)},moveItems:function(t){var n=t.oldIndex,o=t.newIndex;n!==o&&(e.sortedhighlightcolor&&e.regions[n].setBG(e.sortedhighlightcolor),e.regions[n].setSelected(!0),e._value&&(e._value=su()(e._value,n,o)),e.regions=su()(e.regions,n,o),e.setUpdate())},toStateJSON:function(){return{from_name:e.name,to_name:e.name,value:{items:e.regions.map((function(e){return e.value})),selected:e.regions.map((function(e){return e.selected}))}}},fromStateJSON:function(t,n){t.value.items.forEach((function(t,n){e._addRegion(t,n)})),e.setUpdate()}}})),ku=Qt.n.compose("RankerModel",wu,_u),Cu=Object(cu.c)((function(){return Object(Z.jsx)("div",{className:"drag-handle"})}));function Nu(){try{return"undefined"!==typeof window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")}catch(e){return!1}}var Tu=Object(cu.b)((function(e){var t,n=e.item,o=e.value;Nu&&(t="noselect");var a={text:function(e){return Object(Z.jsx)("span",{className:t,children:e._value})},image:function(e){return Object(Z.jsx)("img",{src:e._value,alt:""})},audio:function(e){return Object(Z.jsx)("audio",{src:e._value})}};return Object(Z.jsxs)("div",{style:{padding:"1em",userSelect:"none",display:"flex",alignItems:"center",background:o.selected?n.sortedhighlightcolor:"transparent"},className:t,onClick:function(e){return o.selected?(o.setSelected(!1),n.setUpdate()):(o.setSelected(!0),n.setUpdate()),e.preventDefault(),!1},children:[Object(Z.jsx)(Cu,{}),a[n.elementtag.toLowerCase()](o)]})})),Ru=Object(cu.a)((function(e){var t=e.item,n=e.items;return Object(Z.jsx)(Ko.b,{celled:!0,children:n.map((function(e,n){return Object(Z.jsx)(Tu,{index:n,value:e,color:e.backgroundColor,item:t,onClick:function(e){}},"item-".concat(n))}))})})),Mu=Object(en.c)((function(e){e.store;var t=e.item,n={};return Nu()?n.pressDelay=100:n.distance=7,Object(Z.jsx)("div",{children:Object(Z.jsx)(Ru,Object(f.a)({update:t.update,item:t,items:t.regions,onSortEnd:t.moveItems},n))})})),Au=Object(en.b)("store")(Object(en.c)(Mu));cn.addTag("ranker",ku,Au);var zu=Qt.n.model({value:Qt.n.maybeNull(Qt.n.string),alias:Qt.n.maybeNull(Qt.n.string),hotkey:Qt.n.maybeNull(Qt.n.string)}),Pu=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),type:"shortcut",_value:Qt.n.optional(Qt.n.string,"")}).views((function(e){return{get hotkeyScope(){return Object(Qt.e)(Object(Qt.e)(e)).name}}})).actions((function(e){return{onClick:function(){var t=Object(Qt.e)(Object(Qt.e)(e));t.onShortcut&&t.onShortcut(e.value)},onHotKey:function(){return e.onClick()}}})),Iu=Qt.n.compose("ShortcutModel",zu,Pu,fi),Lu=Object(en.b)("store")(Object(en.c)((function(e){var t=e.item,n=e.store,o={backgroundColor:t.selected?t.background:"#e8e8e8",color:t.selected?t.selectedcolor:"#333333",cursor:"pointer",margin:"5px"};return Object(Z.jsxs)(ma.a,{onClick:function(e){return t.onClick(),!1},style:o,children:[t.alias?t.alias:t._value,n.settings.enableTooltips&&n.settings.enableHotkeys&&t.hotkey&&Object(Z.jsxs)(Mo,{children:["[",t.hotkey,"]"]})]})})));cn.addTag("shortcut",Iu,Lu);var Hu=Qt.n.model({choice:Qt.n.optional(Qt.n.enumeration(["single","multiple"]),"multiple")}),Eu=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),pid:Qt.n.optional(Qt.n.string,pn),type:"relations",children:$i.unionArray(["relations","relation"])}).views((function(e){return{getSelected:function(){return e.children.filter((function(e){return!0===e.selected}))},selectedValues:function(){return e.getSelected().map((function(e){return e.value}))},findRelation:function(t){return e.children.find((function(e){return e.value===t}))}}})).actions((function(e){return{unselectAll:function(){e.children.map((function(e){return e.setSelected(!1)}))}}})),Du=Qt.n.compose("RelationsModel",Eu,Hu,ll);cn.addTag("relations",Du,(function(){return null}));var Wu=Qt.n.model({value:Qt.n.maybeNull(Qt.n.string),background:Qt.n.optional(Qt.n.string,Ni)}),Uu=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),selected:Qt.n.optional(Qt.n.boolean,!1),type:"relation"}).actions((function(e){return{setSelected:function(t){e.selected=t}}})),Bu=Qt.n.compose("RelationModel",Wu,Uu);cn.addTag("relation",Bu,(function(){return null}));var Xu=n(139),Fu=n(813),Yu=n(178),Vu=n.n(Yu),Ju=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){var e,t,n,o="".concat(Vu.a.block);return this.props.hint&&(e=Object(Z.jsx)(ma.a,{color:"blue",children:this.props.hint})),this.props.bg&&(t=this.props.bg),this.props.selected&&(o="".concat(o," ").concat(Vu.a.block_selected),e=Object(Z.jsx)("div",{children:Object(Z.jsx)(ma.a,{color:"magenta",children:"Selected Message"})}),this.props.hint&&(e=Object(Z.jsx)("div",{className:Vu.a.tag,children:Object(Z.jsx)(ma.a,{color:"magenta",children:this.props.hint})}))),this.props.date&&(n=Object(Z.jsx)("span",{className:Vu.a.date,children:this.props.date})),Object(Z.jsxs)("div",{className:o,style:{background:t,width:"max-content",maxWidth:"100%"},children:[Object(Z.jsxs)("span",{className:Vu.a.name,children:[this.props.name,":\xa0"]}),Object(Z.jsx)("p",{className:Vu.a.text,children:this.props.text}),n,e]})}}]),n}(u.a.Component),Gu=Qt.n.model({name:Qt.n.string,text:Qt.n.string,selected:Qt.n.optional(Qt.n.boolean,!1),date:Qt.n.optional(Qt.n.string,""),hint:Qt.n.optional(Qt.n.string,"")}),Ku=Qt.n.model({value:Qt.n.maybeNull(Qt.n.string),name:Qt.n.maybeNull(Qt.n.string)});var qu=Qt.n.model({id:Qt.n.optional(Qt.n.identifier,pn),type:"Dialog",data:Qt.n.map(Gu)}).views((function(e){return{get completion(){return Object(Qt.g)(e).completionStore.selected}}})).actions((function(e){return function(e){return{fromStateJSON:function(t){t.value.choices&&e.completion.names.get(t.from_name).fromStateJSON(t),t.value.text&&e.completion.names.get(t.from_name).fromStateJSON(t)}}}(e)})),Zu=Qt.n.compose("DialogModel",Ku,qu),$u=Object(en.b)("store")(Object(en.c)((function(e){var t=e.store,n=e.item;if(!t.task||!t.task.dataObj)return Object(Z.jsx)(Xu.a,{});var o=[],a=n.value;return"$"===a.charAt(0)&&(a=a.substr(1)),t.task.dataObj[a].forEach((function(e,t){var n;e.name&&(n=zn(Pn(e.name),.1)),o.push(Object(Z.jsx)(Ju,{name:e.name,hint:e.hint,text:e.text,selected:e.selected,date:e.date,id:e.id,bg:n},t))})),Object(Z.jsxs)("div",{children:[Object(Z.jsx)("div",{style:{display:"flex",flexFlow:"column",maxHeight:"500px",overflowY:"scroll",paddingRight:"10px",marginTop:"10px"},children:o}),Object(Z.jsx)(Fu.a,{dashed:!0})]})})));cn.addTag("dialog",Zu,$u);var Qu=Qt.n.model({type:"header",size:Qt.n.optional(Qt.n.string,"4"),style:Qt.n.maybeNull(Qt.n.string),_value:Qt.n.optional(Qt.n.string,""),value:Qt.n.optional(Qt.n.string,""),underline:Qt.n.optional(Qt.n.boolean,!1)}),ep=Qt.n.compose("HeaderModel",Qu,fi),tp=Object(en.c)((function(e){var t=e.item,n=parseInt(t.size),o=t.style?vn.cssConverter(t.style):{margin:"10px 0"};return!o.fontSize&&n>4&&(o.fontSize=5===n?"1.2em":"1.1em"),Object(Z.jsx)(or.a.Title,{underline:t.underline,level:n,style:o,children:t._value})}));cn.addTag("header",ep,tp);var np=Qt.n.model({type:"table",value:Qt.n.maybeNull(Qt.n.string)}).views((function(e){return{get _value(){if(e.value){var t=Object(Qt.g)(e),n=e.value.substr(1);return t.task.dataObj[n]}}}})),op=Qt.n.compose("TableModel",np),ap=Object(en.b)("store")(Object(en.c)((function(e){var t=e.store,n=e.item,o=n._value;o||t.task&&(o=t.task.dataObj);console.log(n._value),console.log(Object.keys(o));var a=Object.keys(o).map((function(e){var t=o[e];return"object"===typeof t&&(t=JSON.stringify(t)),{type:e,value:t}}));return Object(Z.jsx)(ra.a,{bordered:!0,dataSource:a,columns:[{title:"Name",dataIndex:"type"},{title:"Value",dataIndex:"value"}],pagination:{hideOnSinglePage:!0}})})));cn.addTag("table",op,ap);var rp=Qt.n.model({classname:Qt.n.optional(Qt.n.string,""),display:Qt.n.optional(Qt.n.string,"block"),style:Qt.n.maybeNull(Qt.n.string)}),ip=Qt.n.model({id:Qt.n.identifier,type:"view",children:$i.unionArray(["view","header","labels","label","table","choices","choice","rating","ranker","rectangle","ellipse","polygon","keypoint","brush","rectanglelabels","ellipselabels","polygonlabels","keypointlabels","brushlabels","hypertextlabels","text","audio","image","hypertext","audioplus","list","dialog","textarea","pairwise","style","label","relations","filter"])}).views((function(e){return{get completion(){return Object(Qt.g)(e).completionStore.selected}}})),lp=Qt.n.compose("ViewModel",rp,ip,bl),sp=Object(en.c)((function(e){var t=e.item,n=(e.store,{});return"inline"===t.display&&(n={display:"inline-block",marginRight:"15px"}),t.style&&(n=vn.cssConverter(t.style)),!1===t.isVisible&&(n.display="none"),Object(Z.jsx)("div",{className:t.classname,style:n,children:vn.renderChildren(t)})}));cn.addTag("view",lp,sp);var cp=Qt.n.model({type:"style",value:Qt.n.optional(Qt.n.string,"")}),dp=Qt.n.compose("StyleModel",cp),up=Object(en.c)((function(e){var t=e.item;return Object(Z.jsx)("style",{dangerouslySetInnerHTML:{__html:t.value}})}));cn.addTag("style",dp,up);var pp=Qt.n.model({casesensetive:Qt.n.optional(Qt.n.boolean,!1),cleanup:Qt.n.optional(Qt.n.boolean,!0),placeholder:Qt.n.optional(Qt.n.string,"Quick Filter"),minlength:Qt.n.optional(Qt.n.string,"3"),hotkey:Qt.n.maybeNull(Qt.n.string)}),gp=Qt.n.model({type:"filter",_value:Qt.n.maybeNull(Qt.n.string),name:Qt.n.maybeNull(Qt.n.string),toname:Qt.n.maybeNull(Qt.n.string)}).views((function(e){return{get completion(){return Object(Qt.g)(e).completionStore.selected},get toTag(){return e.completion.names.get(e.toname)}}})).actions((function(e){return{applyFilter:function(){var t=e._value,n=e.toTag.tiedChildren;Number(e.minlength)>t.length?n.filter((function(e){return!e.visible})).forEach((function(e){return e.setVisible(!0)})):(e.casesensetive||(t=t.toLowerCase()),n.forEach((function(n){var o=n._value;e.casesensetive||(o=o.toLowerCase()),-1!==o.indexOf(t)?n.setVisible(!0):n.setVisible(!1)})))},applyFilterEv:function(t){var n=t.target.value;e._value=n,e.applyFilter()},onHotKey:function(){return e._ref&&e._ref.focus(),!1},setInputRef:function(t){e._ref=t},selectFirstElement:function(){e.toTag.selectFirstVisible()&&e.cleanup&&(e._value="",e.applyFilter())}}})),fp=Qt.n.compose("FilterModel",gp,pp,fi),hp=Object(en.c)((function(e){var t=e.item,n=t.toTag;return-1===n.type.indexOf("labels")&&-1===n.type.indexOf("choices")?null:Object(Z.jsx)(Vi.a,{ref:function(e){t.setInputRef(e)},value:t._value,size:"small",onChange:t.applyFilterEv,onPressEnter:t.selectFirstElement,placeholder:t.placeholder})}));cn.addTag("filter",fp,hp);var bp=n(161),mp=n.n(bp),jp=(n(730),Object(en.b)("store")(Object(en.c)(function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).createSuitableRoot=function(e){var t=e.children.map((function(e){return e.type}));t=t.sort();var n=["rectanglelabels","choices","textarea","image"].sort();return t.every((function(e,t){return e===n[t]}))?vn.renderItem(e,!0):vn.renderItem(e)},o.state={tree:null,setTree:!1},o}return Object(b.a)(n,[{key:"renderSuccess",value:function(){return Object(Z.jsx)(Zt.a,{status:"success",title:Object(Qt.d)(this.props.store).messages.DONE})}},{key:"renderNoCompletion",value:function(){return Object(Z.jsx)(Zt.a,{status:"success",title:Object(Qt.d)(this.props.store).messages.NO_COMP_LEFT})}},{key:"renderNothingToLabel",value:function(){return Object(Z.jsx)(Zt.a,{status:"success",title:Object(Qt.d)(this.props.store).messages.NO_NEXT_TASK})}},{key:"renderNoAccess",value:function(){return Object(Z.jsx)(Zt.a,{status:"warning",title:Object(Qt.d)(this.props.store).messages.NO_ACCESS})}},{key:"renderLoader",value:function(){return Object(Z.jsx)(Zt.a,{icon:Object(Z.jsx)($t.a,{size:"large"})})}},{key:"_renderAll",value:function(e){return 1===e.length?Object(Z.jsx)(aa,{children:[vn.renderItem(e[0].root)]}):Object(Z.jsx)("div",{className:"ls-renderall",children:e.map((function(e){return Object(Z.jsx)("div",{className:"ls-fade",children:Object(Z.jsx)(aa,{children:[vn.renderItem(e.root)]})})}))})}},{key:"renderAllCompletions",value:function(){return this._renderAll(this.props.store.completionStore.completions)}},{key:"renderAllPredictions",value:function(){return this._renderAll(this.props.store.completionStore.predictions)}},{key:"componentDidMount",value:function(){var e=document.getElementById("RectangleLabelsModel");if(e){var t=document.getElementById("ViewModel").childNodes[0];t.classList.add("view-model");var n=document.createElement("div");n.setAttribute("id","sideModel"),n.classList.add("side-model"),t.appendChild(n);var o=document.getElementById("ChoicesModel");n.appendChild(o);var a=document.getElementById("TextAreaModel");n.appendChild(a),n.appendChild(e)}}},{key:"render",value:function(){var e=this,t=e.props.store,n=t.completionStore,o=n.selected&&n.selected.root,a=t.settings,r=this.createSuitableRoot(o);if(t.isLoading)return e.renderLoader();if(t.noTask)return e.renderNothingToLabel();if(t.noAccess)return e.renderNoAccess();if(t.labeledSuccess)return e.renderSuccess();if(!o)return e.renderNoCompletion();var i=a.fullscreen?mp.a.editorfs:mp.a.editor,l=a.bottomSidePanel?mp.a.commonbsp:mp.a.common,s=a.bottomSidePanel?mp.a.menubsp:mp.a.menu;return Object(Z.jsx)(oe,{children:Object(Z.jsxs)("div",{className:i+" ls-editor app-container",children:[Object(Z.jsx)(ha,{store:t}),Object(Z.jsx)(en.a,{store:t,children:Object(Z.jsxs)("div",{children:[t.hasInterface("panel")&&Object(Z.jsx)(Go,{store:t}),t.showingDescription&&Object(Z.jsx)(on,{isOpen:t.showingDescription,closeDialog:function(){t.showingDescription&&(t.toggleDescription(),console.log("Close"))},messageText:t.description}),Object(Z.jsxs)("div",{className:l+" ls-common segment-container-left-menu",children:[!n.viewingAllCompletions&&!n.viewingAllPredictions&&Object(Z.jsxs)(aa,{className:a.bottomSidePanel?"":mp.a.segment+" ls-segment segment-block-container-left-menu",children:[r,t.hasInterface("controls")&&Object(Z.jsx)(Lo,{item:n.selected})]}),n.viewingAllCompletions&&this.renderAllCompletions(),n.viewingAllPredictions&&this.renderAllPredictions(),Object(Z.jsxs)("div",{className:s+" ls-menu",children:[t.hasInterface("completions:menu")&&Object(Z.jsx)(No,{store:t}),t.hasInterface("side-column")&&!n.viewingAllCompletions&&!n.viewingAllPredictions&&Object(Z.jsx)(Nr,{store:t})]})]})]})}),t.hasInterface("debug")&&Object(Z.jsx)(Wo,{store:t})]})})}}]),n}(d.Component)))),vp=Qt.n.union(Jl,Xs,cd,ss,pc,Rc,Gc,rl,Zd),yp=Qt.n.model("Normalization",{node1:Qt.n.reference(vp),node2:Qt.n.reference(vp)}).actions((function(e){return{toggleHighlight:function(){e.node1===e.node2?e.node1.toggleHighlight():(e.node1.toggleHighlight(),e.node2.toggleHighlight())}}})),Op=Qt.n.model("NormalizationStore",{normalizations:Qt.n.array(yp)}).actions((function(e){return{findNormalization:function(t,n){return n?e.normalizations.find((function(e){return e.node1.id===t.id&&e.node2.id===n.id})):e.normalizations.find((function(e){return e.node1.id===t.id||e.node2.id===t.id}))},addNormalization:function(t,n){if(!e.findNormalization(t,n)){var o=yp.create({node1:t,node2:n});return e.normalizations.unshift(o),o}},deleteNormalization:function(e){Object(Qt.b)(e)},deleteNodeNormalization:function(t){var n=e.findNormalization(t);n&&e.deleteNormalization(n)}}})),xp=Qt.n.model("RegionStore",{regions:Qt.n.array(Qt.n.safeReference(vp)),sort:Qt.n.optional(Qt.n.enumeration(["date","score"]),"date"),sortOrder:Qt.n.optional(Qt.n.enumeration(["asc","desc"]),"desc"),group:Qt.n.optional(Qt.n.enumeration(["type","label"]),"type"),view:Qt.n.optional(Qt.n.enumeration(["regions","labels"]),"regions")}).views((function(e){return{get sortedRegions(){return{date:function(){return e.regions},score:function(){return e.regions.sort((function(e,t){return e.score-t.score}))}}[e.sort]()},asTree:function(t){var n=e.regions,o=[],a={};return n.forEach((function(e,n){a[e.pid]=t(e,n),a[e.pid].item=e,a[e.pid].children=[]})),Object.keys(a).forEach((function(e){var t=a[e];""!==t.item.parentID?a[t.item.parentID].children.push(t):o.push(t)})),o},asLabelsTree:function(t){var n={},o={};e.regions.forEach((function(e){var t=e.labelsState;if(t){var a=t.selectedLabels;a&&a.forEach((function(t){n[t._value]=t,t._value in o?o[t._value].push(e):o[t._value]=[e]}))}}));var a=0;return Object.keys(n).map((function(e){var r=t(n[e],a,!0);return r.children=o[e].map((function(e){return t(e,a++)})),r}))}}})).actions((function(e){return{addRegion:function(t){e.regions.push(t),Object(Qt.d)(e).onEntityCreate(t)},toggleSortOrder:function(){"asc"===e.sortOrder?e.sortOrder="desc":e.sortOrder="asc"},setView:function(t){e.view=t},setSort:function(t){e.sortOrder="desc",e.sort=t,e.initHotkeys()},setGroup:function(t){e.group=t},deleteRegion:function(t){var n=e.regions,o=e.filterByParentID(t.pid);o&&o.forEach((function(e){return e.setParentID(t.parentID)}));for(var a=0;a<n.length;a++)n[a]===t&&n.splice(a,1);Object(Qt.d)(e).onEntityDelete(t),e.initHotkeys()},findRegionID:function(t){return e.regions.find((function(e){return e.id===t}))},findRegion:function(t){return e.regions.find((function(e){return e.pid===t}))},filterByParentID:function(t){return e.regions.filter((function(e){return e.parentID===t}))},afterCreate:function(){Object(Qt.k)(e,(function(t){"add"!==t.op&&"delete"!==t.op||-1===t.path.indexOf("/regions/")||e.initHotkeys()}))},initHotkeys:function(){var t="alt+shift+";ga.getKeys().filter((function(e){return-1!==e.indexOf(t)})).forEach((function(e){return ga.removeKey(e)})),e.sortedRegions.forEach((function(n,o){ga.addKey(t+(o+1),(function(){e.unselectAll(),n.selectRegion()}))})),ga.addKey("alt+shift+$n",(function(){}),"Select a region")},unselectAll:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.regions.forEach((function(e){return e.unselectRegion(t)})),Object(Qt.e)(e).setHighlightedNode(null)},unhighlightAll:function(){e.regions.forEach((function(e){return e.setHighlight(!1)}))},selectNext:function(){var t=e.regions,n=e.regions.findIndex((function(e){return e.selected}));-1!==n&&t[n].unselectRegion();var o="undefined"!==t[n+1]?t[n+1]:t[0];o&&o.selectRegion()}}})),Sp=Qt.n.model("Relation",{node1:Qt.n.reference(vp),node2:Qt.n.reference(vp),direction:Qt.n.optional(Qt.n.enumeration(["left","right","bi"]),"right"),relations:Qt.n.maybeNull(Du),showMeta:Qt.n.optional(Qt.n.boolean,!1)}).views((function(e){return{get parent(){return Object(Qt.f)(e,wp)},get hasRelations(){var t=e.relations;return t&&t.children&&t.children.length>0}}})).actions((function(e){return{afterAttach:function(){var t=Object(Qt.g)(e).completionStore.selected,n=null;t.traverseTree((function(e){if("relations"===e.type)return n=e,hn})),null!==n&&(e.relations=gn(n))},rotateDirection:function(){var t=["left","right","bi"],n=t.findIndex((function(t){return t===e.direction}));(n+=1)>=t.length&&(n=0),e.direction=t[n]},toggleHighlight:function(){e.node1===e.node2?e.node1.toggleHighlight():(e.node1.toggleHighlight(),e.node2.toggleHighlight())},toggleMeta:function(){e.showMeta=!e.showMeta}}})),wp=Qt.n.model("RelationStore",{relations:Qt.n.array(Sp)}).actions((function(e){return{findRelations:function(t,n){return n?e.relations.filter((function(e){return e.node1.id===t.id&&e.node2.id===n.id})):e.relations.filter((function(e){return e.node1.id===t.id||e.node2.id===t.id}))},nodesRelated:function(t,n){return e.findRelations(t,n).length>0},addRelation:function(t,n){if(!e.nodesRelated(t,n)){var o=Sp.create({node1:t,node2:n});return e.relations.push(o),o}},deleteRelation:function(e){Object(Qt.b)(e)},deleteNodeRelation:function(t){var n=e.findRelations(t);n.length&&n.forEach(e.deleteRelation)},serializeCompletion:function(){return e.relations.map((function(e){var t={from_id:e.node1.pid,to_id:e.node2.pid,type:"relation",direction:e.direction};return e.relations&&(t.labels=e.relations.selectedValues()),t}))},deserializeRelation:function(t,n,o,a){var r=e.addRelation(t,n);r.direction=o,r.relations&&a&&a.forEach((function(e){var t=r.relations.findRelation(e);t&&t.setSelected(!0)}))}}})),_p=wp,kp=Qt.n.model("TimeTraveller",{history:Qt.n.array(Qt.n.frozen()),undoIdx:-1,targetPath:"",skipNextUndoState:Qt.n.optional(Qt.n.boolean,!1),createdIdx:1,isFrozen:Qt.n.optional(Qt.n.boolean,!1),frozenIdx:-1}).views((function(e){return{get canUndo(){return e.undoIdx>1},get canRedo(){return e.undoIdx<e.history.length-1}}})).actions((function(e){var t,n;return{freeze:function(){e.isFrozen=!0,e.skipNextUndoState=!0,e.frozenIdx=e.undoIdx},addUndoState:function(t){e.skipNextUndoState?e.skipNextUndoState=!1:(e.history.splice(e.undoIdx),e.history.push(t),e.undoIdx=e.history.length)},afterCreate:function(){var o=this;if(!(t=e.targetPath?Object(Qt.m)(e,e.targetPath):Object(Qt.d)(e).targetStore))throw new Error("Failed to find target store for TimeTraveller. Please provide `targetPath`  property, or a `targetStore` in the environment");n=Object(Qt.l)(t,(function(e){return o.addUndoState(e)})),0===e.history.length&&e.addUndoState(Object(Qt.h)(t)),e.createdIdx=e.undoIdx},beforeDestroy:function(){n()},undo:function(){if(!(e.isFrozen&&e.frozenIdx<e.undoIdx)){var t=e.undoIdx-1;e.set(t)}},redo:function(){var t=e.undoIdx+1;e.set(t)},set:function(n){e.undoIdx=n,e.skipNextUndoState=!0,Object(Qt.a)(t,e.history[n])},reset:function(){e.set(e.createdIdx)}}})),Cp=Qt.n.model("Completion",{id:Qt.n.identifier,pk:Qt.n.optional(Qt.n.string,pn(5)),selected:Qt.n.optional(Qt.n.boolean,!1),type:Qt.n.enumeration(["completion","prediction"]),createdDate:Qt.n.optional(Qt.n.string,ho.UDate.currentISODate()),createdAgo:Qt.n.maybeNull(Qt.n.string),createdBy:Qt.n.optional(Qt.n.string,"Admin"),loadedDate:Qt.n.optional(Qt.n.Date,new Date),leadTime:Qt.n.maybeNull(Qt.n.number),userGenerate:Qt.n.optional(Qt.n.boolean,!0),update:Qt.n.optional(Qt.n.boolean,!1),sentUserGenerate:Qt.n.optional(Qt.n.boolean,!1),localUpdate:Qt.n.optional(Qt.n.boolean,!1),honeypot:Qt.n.optional(Qt.n.boolean,!1),skipped:!1,root:$i.allModelsTypes(),names:Qt.n.map(Qt.n.reference($i.allModelsTypes())),toNames:Qt.n.map(Qt.n.array(Qt.n.reference($i.allModelsTypes()))),history:Qt.n.optional(kp,{targetPath:"../root"}),dragMode:Qt.n.optional(Qt.n.boolean,!1),editable:Qt.n.optional(Qt.n.boolean,!0),relationMode:Qt.n.optional(Qt.n.boolean,!1),relationStore:Qt.n.optional(_p,{relations:[]}),normalizationMode:Qt.n.optional(Qt.n.boolean,!1),normalizationStore:Qt.n.optional(Op,{normalizations:[]}),regionStore:Qt.n.optional(xp,{regions:[]}),highlightedNode:Qt.n.maybeNull(Qt.n.safeReference(vp))}).views((function(e){return{get store(){return Object(Qt.g)(e)},get list(){return Object(Qt.e)(e,2)}}})).actions((function(e){return{reinitHistory:function(){e.history={targetPath:"../root"}},setEdit:function(t){e.editable=t},setGroundTruth:function(t){e.honeypot=t,Object(Qt.d)(e).onGroundTruth(e.store,e,t)},sendUserGenerate:function(){e.sentUserGenerate=!0},setLocalUpdate:function(t){e.localUpdate=t},setDragMode:function(t){e.dragMode=t},updatePersonalKey:function(t){e.pk=t},setNormalizationMode:function(t){e.normalizationMode=t},setHighlightedNode:function(t){e.highlightedNode=t},startRelationMode:function(t){e._relationObj=t,e.relationMode=!0,document.body.style.cursor=Ii},stopRelationMode:function(){document.body.style.cursor=Pi,e._relationObj=null,e.relationMode=!1,e.regionStore.unhighlightAll()},deleteAllRegions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.deleteReadOnly,o=void 0!==n&&n,a=e.regionStore.regions;!1===o&&(a=a.filter((function(e){return!1===e.readonly}))),a.forEach((function(e){return e.deleteRegion()}))},addRegion:function(t){e.regionStore.addRegion(t),e.regionStore.unselectAll(!0),e.relationMode&&(e.addRelation(t),e.stopRelationMode())},loadRegionState:function(t){t.states&&t.states.forEach((function(t){var n=e.names.get(t.name);n.unselectAll&&n.unselectAll(),n.copyState(t)}))},unloadRegionState:function(t){t.states&&t.states.forEach((function(t){var n=e.names.get(t.name);n.unselectAll&&n.unselectAll(),n.perRegionCleanup&&n.perRegionCleanup()}))},addRelation:function(t){e.relationStore.addRelation(e._relationObj,t)},addNormalization:function(t){e.normalizationStore.addNormalization()},validate:function(){var t=!0;return e.traverseTree((function(e){if(!0===e.required&&!1===(t=e.validate()))return t=!1,bn})),t},traverseTree:function(t){return vn.traverseTree(e.root,t)},beforeSend:function(){e.traverseTree((function(e){e&&e.beforeSend&&e.beforeSend()})),e.stopRelationMode(),e.regionStore.unselectAll()},deleteRegion:function(e){"polygonregion"!==e.type?Object(Qt.b)(e):Object(Qt.c)(e)},afterAttach:function(){e.traverseTree((function(t){if(t.updateValue&&t.updateValue(e.store),t.completionAttached&&t.completionAttached(),t&&t.getToolsManager){var n=t.getToolsManager(),o=e.toNames.get(t.name);o&&o.forEach((function(e){return n.addToolsFromControl(e)}))}}))},afterCreate:function(){e.userGenerate&&!e.sentUserGenerate&&(e.loadedDate=new Date),e.traverseTree((function(t){if(t&&t.name&&t.id&&e.names.set(t.name,t.id),t&&t.toname&&t.id){var n=e.toNames.get(t.toname);n?n.push(t.id):e.toNames.set(t.toname,[t.id])}}))},setupHotKeys:function(){ga.unbindAll();var t=0,n=null,o="shift+space",a=o;e.traverseTree((function(e){e&&e.onHotKey&&e.hotkey&&ga.addKey(e.hotkey,e.onHotKey,void 0,e.hotkeyScope)})),e.traverseTree((function(e){!e||e.hotkey||"audio"!==e.type&&"audioplus"!==e.type||(t>0?a=o+"+"+(t+1):n=e,e.hotkey=a,ga.addKey(a,e.onHotKey,"Play an audio"),t++)})),e.traverseTree((function(e){if(e&&e.onHotKey&&!e.hotkey){var t=ga.makeComb();if(!t)return;e.hotkey=t,ga.addKey(e.hotkey,e.onHotKey)}})),n&&t>1&&(n.hotkey=o+"+1",ga.addKey(n.hotkey,n.onHotKey),ga.removeKey(o)),ga.setScope("__main__")},serializeCompletion:function(){var t=[];e.traverseTree((function(e){if(e.toStateJSON&&!e.perregion){var n=e.toStateJSON();n&&t.push(n)}}));var n=e.relationStore.serializeCompletion();n&&t.push(n);return function e(t){return t.reduce((function(t,n){return t.concat(Array.isArray(n)?e(n):n)}),[])}(t)},deserializeCompletion:function(t){var n=t;"object"!==typeof n&&(n=JSON.parse(n)),e._initialCompletionObj=n,n.forEach((function(t){"relation"!==t.type&&t.to_name.split(",").forEach((function(n){var o=e.names.get(n);if(!o)throw new Error("No model found for "+t.to_name);var a=e.names.get(t.from_name);if(!a)throw new Error("No model found for "+t.from_name);o.fromStateJSON(t,a)}))})),n.forEach((function(t){"relation"===t.type&&e.relationStore.deserializeRelation(e.regionStore.findRegion(t.from_id),e.regionStore.findRegion(t.to_id),t.direction,t.labels)})),e.regionStore.unselectAll()}}})),Np=Qt.n.model("CompletionStore",{selected:Qt.n.maybeNull(Qt.n.reference(Cp)),completions:Qt.n.array(Cp),predictions:Qt.n.array(Cp),viewingAllCompletions:Qt.n.optional(Qt.n.boolean,!1),viewingAllPredictions:Qt.n.optional(Qt.n.boolean,!1)}).views((function(e){return{get store(){return Object(Qt.g)(e)}}})).actions((function(e){function t(){e.viewingAllCompletions||e.viewingAllPredictions?(e.completions.forEach((function(e){e.selected=!1,e.editable=!1,e.regionStore.unselectAll()})),e.predictions.forEach((function(e){e.selected=!1,e.regionStore.unselectAll()}))):o(e.completions[0].id)}function n(t,n){e.viewingAllCompletions=!1,e.viewingAllPredictions=!1,e.selected&&(e.selected.selected=!1);var o=n.find((function(e){return e.id===t}));return o.selected=!0,e.selected=o,o}function o(t){var o=e.selected,a=n(t,e.completions);return a.editable=!0,a.setupHotKeys(),Object(Qt.d)(e).onSelectCompletion(a,o),a}function a(t){var n=e.store,o=n.user,a=n.config,r=vn.treeToModel(a),i=cn.getModelByTag(r.type).create(r),l=t.id;delete t.id;var s=Object(f.a)({id:l||pn(5),root:i,userGenerate:!1},t);return o&&!("createdBy"in s)&&(s.createdBy=o.displayName),Cp.create(s)}return{toggleViewingAllCompletions:function(){e.viewingAllCompletions=!e.viewingAllCompletions,e.viewingAllCompletions&&(e.viewingAllPredictions=!1),t()},toggleViewingAllPredictions:function(){e.viewingAllPredictions=!e.viewingAllPredictions,e.viewingAllPredictions&&(e.viewingAllCompletions=!1),t()},addPrediction:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.editable=!1,t.type="prediction";var n=a(t);return e.predictions.unshift(n),n},addCompletion:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.type="completion";var n=a(t);return e.completions.unshift(n),n},addCompletionFromPrediction:function(t){var n=e.addCompletion({userGenerate:!0}),a=t._initialCompletionObj;return a.forEach((function(e){"id"in e&&(e.id=pn())})),o(n.id),n.deserializeCompletion(a),n},selectCompletion:o,selectPrediction:function(t){var o=n(t,e.predictions);return o.regionStore.unselectAll(),o},deleteCompletion:function(t){Object(Qt.d)(e).onDeleteCompletion(e.store,t),Object(Qt.b)(t),e.selected=null,e.completions.length>0&&e.selectCompletion(e.completions[0].id)}}})),Tp=Qt.n.model("Project",{id:Qt.n.identifierNumber}).views((function(e){return{get app(){return Object(Qt.e)(e)}}})),Rp=Qt.n.model("SettingsModel",{enableHotkeys:Qt.n.optional(Qt.n.boolean,!0),enablePanelHotkeys:Qt.n.optional(Qt.n.boolean,!0),enableTooltips:Qt.n.optional(Qt.n.boolean,!1),enableLabelTooltips:Qt.n.optional(Qt.n.boolean,!0),continuousLabeling:!1,fullscreen:Qt.n.optional(Qt.n.boolean,!1),bottomSidePanel:Qt.n.optional(Qt.n.boolean,!1),imageFullSize:Qt.n.optional(Qt.n.boolean,!1),enableAutoSave:Qt.n.optional(Qt.n.boolean,!1),showLabels:Qt.n.optional(Qt.n.boolean,!1)}).views((function(e){return{get completion(){return Object(Qt.g)(e).completionStore.selected}}})).actions((function(e){return{afterCreate:function(){try{if(!window.localStorage)return}catch(a){return}var t="labelStudio:settings",n=localStorage.getItem(t);if(n){var o=JSON.parse(n);"object"===typeof o&&null!==o&&Object.keys(o).forEach((function(t){t in e&&(e[t]=o[t])}))}Object(Qt.l)(e,(function(e){localStorage.setItem(t,JSON.stringify(e))}))},toggleShowLabels:function(){e.showLabels=!e.showLabels,ho.HTML.toggleLabelsAndScores(e.showLabels)},toggleContinuousLabeling:function(){e.continuousLabeling=!e.continuousLabeling},toggleAutoSave:function(){e.enableAutoSave=!e.enableAutoSave},toggleHotkeys:function(){e.enableHotkeys=!e.enableHotkeys,e.enableHotkeys?ga.setScope("__main__"):ga.setScope("__none__")},togglePanelHotkeys:function(){e.enablePanelHotkeys=!e.enablePanelHotkeys},toggleTooltips:function(){e.enableTooltips=!e.enableTooltips},toggleFullscreen:function(){e.fullscreen=!e.fullscreen},toggleBottomSP:function(){e.bottomSidePanel=!e.bottomSidePanel},toggleImageFS:function(){e.imageFullSize=!e.imageFullSize},toggleLabelTooltips:function(){e.enableLabelTooltips=!e.enableLabelTooltips}}})),Mp=Qt.n.model({enable:Qt.n.optional(Qt.n.boolean,!1),username:Qt.n.string,password:Qt.n.string,to:Qt.n.string}),Ap=Qt.n.model("Task",{id:Qt.n.maybeNull(Qt.n.number),load:Qt.n.optional(Qt.n.boolean,!1),auth:Qt.n.maybeNull(Mp),data:Qt.n.maybeNull(Qt.n.string)}).views((function(e){return{get app(){return Object(Qt.e)(e)},get dataObj(){return ho.Checkers.isStringJSON(e.data)?JSON.parse(e.data):"object"===typeof e.data?e.data:null}}})),zp=Qt.n.model("UserStore",{pk:Qt.n.maybeNull(Qt.n.integer),firstName:Qt.n.maybeNull(Qt.n.string),lastName:Qt.n.maybeNull(Qt.n.string)}).views((function(e){return{get displayName(){return e.firstName||e.lastName?"".concat(e.firstName," ").concat(e.lastName):""}}})),Pp=Qt.n.model("AppStore",{config:Qt.n.string,task:Qt.n.maybeNull(Ap),project:Qt.n.maybeNull(Tp),interfaces:Qt.n.array(Qt.n.string),explore:Qt.n.optional(Qt.n.boolean,!1),completionStore:Qt.n.optional(Np,{completions:[],predictions:[]}),user:Qt.n.maybeNull(zp),debug:Qt.n.optional(Qt.n.boolean,!0),settings:Qt.n.optional(Rp,{}),description:Qt.n.maybeNull(Qt.n.string),showingSettings:Qt.n.optional(Qt.n.boolean,!1),showingDescription:Qt.n.optional(Qt.n.boolean,!1),isLoading:Qt.n.optional(Qt.n.boolean,!1),noTask:Qt.n.optional(Qt.n.boolean,!1),noAccess:Qt.n.optional(Qt.n.boolean,!1),labeledSuccess:Qt.n.optional(Qt.n.boolean,!1)}).views((function(e){return{get alert(){return Object(Qt.d)(e).alert}}})).actions((function(e){return{setFlags:function(t){for(var n=0,o=["showingSettings","showingDescription","isLoading","noTask","noAccess","labeledSuccess"];n<o.length;n++){var a=o[n];a in t&&(e[a]=t[a])}},addInterface:function(t){return e.interfaces.push(t)},hasInterface:function(t){return void 0!==e.interfaces.find((function(e){return t===e}))},afterCreate:function(){ga.addKey("ctrl+enter",e.submitCompletion,"Submit a task"),e.hasInterface("skip")&&ga.addKey("ctrl+space",e.skipTask,"Skip a task"),e.hasInterface("update")&&ga.addKey("alt+enter",e.updateCompletion,"Update a task"),ga.addKey("ctrl+backspace",(function(){e.completionStore.selected.deleteAllRegions()}),"Delete all regions"),ga.addKey("r",(function(){var t=e.completionStore.selected;t&&t.highlightedNode&&!t.relationMode&&t.startRelationMode(t.highlightedNode)}),"Create relation when region is selected"),ga.addKey("u",(function(){var t=e.completionStore.selected;t&&t.highlightedNode&&!t.relationMode&&t.regionStore.unselectAll()})),ga.addKey("h",(function(){var t=e.completionStore.selected;t&&t.highlightedNode&&!t.relationMode&&t.highlightedNode.toggleHidden()})),ga.addKey("ctrl+z",(function(){var t=e.completionStore.selected.history;t&&t.canUndo&&t.undo()})),ga.addKey("escape",(function(){var t=e.completionStore.selected;t&&t.relationMode&&t.stopRelationMode()}),"Exit relation mode"),ga.addKey("backspace",(function(){var t=e.completionStore.selected;t&&t.highlightedNode&&t.highlightedNode.deleteRegion()}),"Delete selected region"),ga.addKey("alt+tab",(function(){var t=e.completionStore.selected;t&&t.regionStore.selectNext()}),"Circle through entities"),Object(Qt.d)(e).onLabelStudioLoad(e)},assignTask:function(t){t&&!ho.Checkers.isString(t.data)&&(t=Object(f.a)(Object(f.a)({},t),{},Object(at.a)({},t.data,JSON.stringify(t.data)))),e.task=Ap.create(t)},resetState:function(){e.completionStore=Np.create({completions:[]})},initializeStore:function(t){var n=t.completions,o=t.predictions,a=function(t,n){return function(o){var a=e.completionStore[t](o);return e.completionStore[n](a.id),a.deserializeCompletion(o.result),a.reinitHistory(),a}},r=a("addPrediction","selectPrediction"),i=a("addCompletion","selectCompletion");o&&o.forEach((function(e){return r(e)})),n&&n.forEach((function(e){return i(e)}))},skipTask:function(){Object(Qt.d)(e).onSkipTask(e)},submitCompletion:function(){var t=e.completionStore.selected;t.beforeSend(),t.validate()&&(t.sendUserGenerate(),Object(Qt.d)(e).onSubmitCompletion(e,t))},updateCompletion:function(){var t=e.completionStore.selected;t.beforeSend(),Object(Qt.d)(e).onUpdateCompletion(e,t)},toggleSettings:function(){e.showingSettings=!e.showingSettings},toggleDescription:function(){e.showingDescription=!e.showingDescription}}}));var Ip={onDeleteCompletion:function(){},onEntityCreate:function(){},onEntityDelete:function(){},onGroundTruth:function(){},onLabelStudioLoad:function(){},onSkipTask:function(){},onSubmitCompletion:function(){},onTaskLoad:function(){},onUpdateCompletion:function(){},onSelectCompletion:function(e,t){}},Lp={DONE:"Done!",NO_COMP_LEFT:"No more completions",NO_NEXT_TASK:"No more data available for labeling",NO_ACCESS:"You don't have access to this task"};var Hp={getData:function(e){return e&&e.data?Object(f.a)(Object(f.a)({},e),{},{data:JSON.stringify(e.data)}):e},getState:function(e){return{completions:e&&e.completions?e.completions:null,predictions:e&&e.predictions?e.predictions:null}},rootElement:function(e){var t=document.createElement("div"),n=document.getElementById(e);return n.innerHTML="",n.appendChild(t),t},configureApplication:function(e){var t=e.submitCompletion||e.onSubmitCompletion,n=e.updateCompletion||e.onUpdateCompletion,o=e.deleteCompletion||e.onDeleteCompletion;return{alert:function(e){return console.log(e)},messages:Object(f.a)(Object(f.a)({},Lp),e.messages),onSubmitCompletion:e.onSubmitCompletion?t:Ip.onSubmitCompletion,onUpdateCompletion:e.onUpdateCompletion?n:Ip.onUpdateCompletion,onDeleteCompletion:e.onDeleteCompletion?o:Ip.onDeleteCompletion,onSkipTask:e.onSkipTask?e.onSkipTask:Ip.onSkipTask,onTaskLoad:e.onTaskLoad||Ip.onTaskLoad,onLabelStudioLoad:e.onLabelStudioLoad||Ip.onLabelStudioLoad,onEntityCreate:e.onEntityCreate||Ip.onEntityCreate,onEntityDelete:e.onEntityDelete||Ip.onEntityDelete,onGroundTruth:e.onGroundTruth||Ip.onGroundTruth,onSelectCompletion:e.onSelectCompletion||Ip.onSelectCompletion}}},Ep=function(e,t){var n=e.serializeCompletion();return JSON.stringify({lead_time:(new Date-e.loadedDate)/1e3,result:n,createdBy:t,createdDate:e.createdDate})},Dp=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).closeSnackbarHandler=function(){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{snackbarIsOpen:!1}))},o.getAnnotateData=function(e){var t;o.context.openLoadingHandler();var n=e,a="".concat(e,"data/");console.log(a),x.defaults.headers.common.Authorization=ue.a.get("token"),x.get(n).then((function(e){x.get(a).then((function(n){(t={config:"".concat(e.data.type.config.replaceAll("\r\n","")),description:"\u062a\u0648\u0636\u06cc\u062d\u0627\u062a",interfaces:e.data.type.interface.replaceAll(" ","").split(",").concat(["submit","controls","skip","update","panel","side-column","completions:menu","completions:add-new","completions:delete","predictions:menu"]),user:{id:ue.a.get("pk"),first_name:ue.a.get("firstName"),last_name:ue.a.get("lastName"),username:ue.a.get("username"),email:ue.a.get("email")},task:{completions:n.data.completions,predictions:n.data.predictions,id:1,data:n.data.data},onUpdateCompletion:function(e,t){o.onUpdateCompletion(e,t)},onSubmitCompletion:function(e,t){o.onSubmitCompletion(e,t)},onSkipTask:function(e){o.onSkipTask(e)}}).task=Hp.getData(t.task);var a=Pp.create(t,Hp.configureApplication(t));a.initializeStore(Hp.getState(t.task)),o.setState(Object(f.a)(Object(f.a)({},o.state),{},{store:a,main_dataset_id:n.data.main_dataset_id,snackbarIsOpen:!0}))}))})).catch((function(e){var t;o.context.openMessageDialogHandler({messageType:"error",messageText:null===(t=e.response)||void 0===t?void 0:t.data.detail})})).finally((function(){o.context.closeLoadingHandler()}))},o.onUpdateCompletion=function(e,t){o.context.openLoadingHandler();var n=Ep(t,ue.a.get("username"));void 0==JSON.parse(n).result[0]?(o.context.closeLoadingHandler(),o.context.openMessageDialogHandler({messageType:"error",messageText:""})):(x.defaults.headers.common.Authorization=ue.a.get("token"),x.patch("".concat(o.state.baseUrl,"data/").concat(o.state.main_dataset_id.toString(),"/"),{completions:n}).then((function(e){o.getAnnotateData(o.state.baseUrl)})).catch((function(e){var t;o.context.openMessageDialogHandler({messageType:"error",messageText:null===(t=e.response)||void 0===t?void 0:t.data.detail})})).finally((function(){o.context.closeLoadingHandler()})))},o.onSubmitCompletion=function(e,t){o.context.openLoadingHandler();var n=Ep(t,ue.a.get("username"));void 0==JSON.parse(n).result[0]?(o.context.closeLoadingHandler(),o.context.openMessageDialogHandler({messageType:"error",messageText:""})):(x.defaults.headers.common.Authorization=ue.a.get("token"),x.patch("".concat(o.state.baseUrl,"data/").concat(o.state.main_dataset_id.toString(),"/"),{completions:n}).then((function(e){o.getAnnotateData(o.state.baseUrl)})).catch((function(e){var t;o.context.openMessageDialogHandler({messageType:"error",messageText:null===(t=e.response)||void 0===t?void 0:t.data.detail})})).finally((function(){o.context.closeLoadingHandler()})))},o.onSkipTask=function(e){o.context.openLoadingHandler(),x.defaults.headers.common.Authorization=ue.a.get("token"),x.post("".concat(o.state.baseUrl,"back/")).then((function(e){o.getAnnotateData(o.state.baseUrl)})).catch((function(e){var t;o.context.openMessageDialogHandler({messageType:"error",messageText:null===(t=e.response)||void 0===t?void 0:t.data.detail})})).finally((function(){o.context.closeLoadingHandler()}))},o.state={snackbarIsOpen:!1,store:null,baseUrl:"",main_dataset_id:-1},o}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e="/api/project/".concat(this.props.match.params.username,"/").concat(this.props.match.params.projectSlug,"/task/").concat(this.props.match.params.taskSlug,"/");this.getAnnotateData(e),this.setState(Object(f.a)(Object(f.a)({},this.state),{},{baseUrl:e}))}},{key:"render",value:function(){return this.state.store?Object(Z.jsxs)(T,{children:[Object(Z.jsx)(Ne,{isOpen:this.state.snackbarIsOpen,messageType:"success",messageText:"\u0645\u0648\u0641\u0642\u06cc\u062a\u200c\u0622\u0645\u06cc\u0632 \u0628\u0648\u062f",closeHnadler:this.closeSnackbarHandler}),Object(Z.jsx)(en.a,{store:this.state.store,children:Object(Z.jsx)(jp,{})})]}):Object(Z.jsx)("div",{})}}]),n}(u.a.Component);Dp.contextType=N;var Wp=Dp,Up=function(e){Object(m.a)(n,e);var t=Object(j.a)(n);function n(e){var o;return Object(h.a)(this,n),(o=t.call(this,e)).closeLoadingHandler=function(){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{isLoading:!1}))},o.openLoadingHandler=function(){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{isLoading:!0}))},o.openMessageDialogHandler=function(e){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{messageDialogIsOpen:!0,messageDialogText:e.messageText,messageDialogType:e.messageType}))},o.closeMessageDialogHandler=function(){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{messageDialogIsOpen:!1}))},o.openMessageSnackbarHandler=function(e){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{messageSnackbarIsOpen:!0,messageSnackbarText:e.messageText,messageSnackbarType:e.messageType}))},o.closeMessageSnackbarHandler=function(){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{messageSnackbarIsOpen:!1}))},o.setUserInformation=function(e){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{user:{isAuth:e.isAuth,token:e.token,pk:e.pk,firstName:e.firstName,lastName:e.lastName,username:e.username,email:e.email,password:e.password}}))},o.openDrawerHandler=function(){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{drawerIsOpen:!0}))},o.closeDrawerHandler=function(){o.setState(Object(f.a)(Object(f.a)({},o.state),{},{drawerIsOpen:!1}))},o.state={drawerIsOpen:!1,isLoading:!1,messageDialogIsOpen:!1,messageDialogType:"",messageDialogText:"",messageSnackbarIsOpen:!1,messageSnackbarType:"",messageSnackbarText:"",user:{isAuth:!1,token:"",pk:0,firstName:"",lastName:"",username:"",email:"",password:""}},o}return Object(b.a)(n,[{key:"render",value:function(){var e=this;return Object(Z.jsx)(C,{value:{isLoading:this.state.isLoading,openLoadingHandler:this.openLoadingHandler,closeLoadingHandler:this.closeLoadingHandler,messageDialogIsOpen:this.state.messageDialogIsOpen,messageDialogType:this.state.messageDialogType,messageDialogText:this.state.messageDialogText,openMessageDialogHandler:function(t){e.openMessageDialogHandler(t)},closeMessageDialogHandler:this.closeMessageDialogHandler,messageSnackbarIsOpen:this.state.messageSnackbarIsOpen,messageSnackbarType:this.state.messageSnackbarType,messageSnackbarText:this.state.messageSnackbarText,openMessageSnackbarHandler:function(t){e.openMessageSnackbarHandler(t)},closeMessageSnackbarHandler:this.closeMessageSnackbarHandler},children:Object(Z.jsx)(w,{value:{isAuth:this.state.user.isAuth,token:this.state.user.token,pk:this.state.user.pk,firstName:this.state.user.firstName,lastName:this.state.user.lastName,username:this.state.user.username,email:this.state.user.email,password:this.state.user.password,setUserInformation:function(t){e.setUserInformation(t)}},children:Object(Z.jsxs)(T,{children:[Object(Z.jsx)(Se,{isOpen:this.state.messageDialogIsOpen,messageType:this.state.messageDialogType,messageText:this.state.messageDialogText,closeDialog:this.closeMessageDialogHandler}),Object(Z.jsx)(Ne,{isOpen:this.state.messageSnackbarIsOpen,messageType:this.state.messageSnackbarType,messageText:this.state.messageSnackbarText}),Object(Z.jsx)(Re,{isLoading:this.state.isLoading}),Object(Z.jsx)(ge.a,{children:Object(Z.jsxs)(y.c,{children:[Object(Z.jsx)(y.a,{path:"/login",exact:!0,component:pe}),Object(Z.jsx)(y.a,{exact:!0,path:"/project/:username/:projectSlug/task/:taskSlug",component:Wp}),Object(Z.jsx)(y.a,{exact:!0,path:"/profile",children:null}),Object(Z.jsx)(y.a,{exact:!0,path:"/info",children:null}),Object(Z.jsx)(y.a,{path:"/",children:Object(Z.jsx)(qt,{drawerIsOpen:this.state.drawerIsOpen,openDrawerHandler:this.openDrawerHandler,closeDrawerHandler:this.closeDrawerHandler})})]})})]})})})}}]),n}(u.a.Component);n(731),n(732);g.a.render(Object(Z.jsx)(Up,{}),document.getElementById("root"))}},[[733,1,2]]]);
//# sourceMappingURL=main.a1235bc2.chunk.js.map